function ActionStack(a,b){function c(a){svw.ui&&svw.ui.actionStack&&(f=svw.ui.actionStack.redo,g=svw.ui.actionStack.undo,f.css("opacity",.5),g.css("opacity",.5),f.bind("click",d),g.bind("click",e))}function d(){i.disableRedo||("tracker"in svw&&svw.tracker.push("Click_Redo"),h.redo())}function e(){i.disableUndo||("tracker"in svw&&svw.tracker.push("Click_Undo"),h.undo())}var f,g,h={className:"ActionStack"},i={actionStackCursor:0,disableRedo:!1,disableUndo:!1},j={disableRedo:!1,disableUndo:!1},k=[];return h.disableRedo=function(){return j.disableRedo?!1:(i.disableRedo=!0,svw.ui&&svw.ui.actionStack&&f.css("opacity",.5),this)},h.disableUndo=function(){return j.disableUndo?!1:(i.disableUndo=!0,svw.ui&&svw.ui.actionStack&&g.css("opacity",.5),this)},h.enableRedo=function(){return j.disableRedo?!1:(i.disableRedo=!1,svw.ui&&svw.ui.actionStack&&f.css("opacity",1),this)},h.enableUndo=function(){return j.disableUndo?!1:(i.disableUndo=!1,svw.ui&&svw.ui.actionStack&&g.css("opacity",1),this)},h.getStatus=function(a){return a in i||console.warn("You have passed an invalid key for status."),i[a]},h.lockDisableRedo=function(){return j.disableRedo=!0,this},h.lockDisableUndo=function(){return j.disableUndo=!0,this},h.pop=function(){return k.length>0&&(i.actionStackCursor-=1,k.splice(i.actionStackCursor)),this},h.push=function(a,b){var c=["addLabel","deleteLabel"];if(-1===c.indexOf(a))throw h.className+": Illegal action.";var d={action:a,label:b,index:i.actionStackCursor};return 0!==k.length&&k.length>i.actionStackCursor&&k.splice(i.actionStackCursor),k.push(d),i.actionStackCursor+=1,this},h.redo=function(){if(!i.disableRedo){if(k.length>i.actionStackCursor){var a=k[i.actionStackCursor];"addLabel"===a.action?("tracker"in svw&&svw.tracker.push("Redo_AddLabel",{labelId:a.label.getProperty("labelId")}),a.label.setStatus("deleted",!1)):"deleteLabel"===a.action&&("tracker"in svw&&svw.tracker.push("Redo_RemoveLabel",{labelId:a.label.getProperty("labelId")}),a.label.setStatus("deleted",!0),a.label.setVisibility("hidden")),i.actionStackCursor+=1}"canvas"in svw&&svw.canvas.clear().render2()}},h.size=function(){return k.length},h.undo=function(){if(!i.disableUndo){if(i.actionStackCursor-=1,i.actionStackCursor>=0){var a=k[i.actionStackCursor];"addLabel"===a.action?("tracker"in svw&&svw.tracker.push("Undo_AddLabel",{labelId:a.label.getProperty("labelId")}),a.label.setStatus("deleted",!0)):"deleteLabel"===a.action&&("tracker"in svw&&svw.tracker.push("Undo_RemoveLabel",{labelId:a.label.getProperty("labelId")}),a.label.setStatus("deleted",!1),a.label.setVisibility("visible"))}else i.actionStackCursor=0;"canvas"in svw&&svw.canvas.clear().render2()}},h.unlockDisableRedo=function(){return j.disableRedo=!1,this},h.unlockDisableUndo=function(){return j.disableUndo=!1,this},h.getLock=function(a){return a in j||console.warn("You have passed an invalid key for status."),j[a]},h.updateOpacity=function(){svw.ui&&svw.ui.actionStack&&(i.actionStackCursor<k.length?f.css("opacity",1):f.css("opacity",.5),i.actionStackCursor>0?g.css("opacity",1):g.css("opacity",.5),i.disableUndo&&g.css("opacity",.5),i.disableRedo&&f.css("opacity",.5))},c(b),h}function getBusStopPositionLabel(){return{NextToCurb:{id:"NextToCurb",label:"Next to curb"},AwayFromCurb:{id:"AwayFromCurb",label:"Away from curb"},None:{id:"None",label:"Not provided"}}}function getHeadingEstimate(a,b,c,d){"number"!=typeof a&&(a=parseFloat(a)),"number"!=typeof b&&(b=parseFloat(b)),"number"!=typeof d&&(d=parseFloat(d)),"number"!=typeof c&&(c=parseFloat(c));var e=d-b,f=c-a;if(0===f||0===e)return 0;var g=toDegrees(Math.atan(e/f));return 90-g}function getLabelCursorImagePath(){return{Walk:{id:"Walk",cursorImagePath:void 0},StopSign:{id:"StopSign",cursorImagePath:"public/img/cursors/Cursor_BusStop2.png"},StopSign_OneLeg:{id:"StopSign_OneLeg",cursorImagePath:"public/img/cursors/Cursor_BusStop2.png"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",cursorImagePath:"public/img/cursors/Cursor_BusStop2.png"},StopSign_Column:{id:"StopSign_Column",cursorImagePath:"public/img/cursors/Cursor_BusStop2.png"},StopSign_None:{id:"StopSign_None",cursorImagePath:"public/img/cursors/Cursor_BusStop2.png"},Landmark_Shelter:{id:"Landmark_Shelter",cursorImagePath:"public/img/cursors/Cursor_BusStopShelter2.png"},Landmark_Bench:{id:"Landmark_Bench",cursorImagePath:"public/img/cursors/Cursor_Bench2.png"},Landmark_TrashCan:{id:"Landmark_TrashCan",cursorImagePath:"public/img/cursors/Cursor_TrashCan3.png"},Landmark_MailboxAndNewsPaperBox:{id:"Landmark_MailboxAndNewsPaperBox",cursorImagePath:"public/img/cursors/Cursor_Mailbox2.png"},Landmark_OtherPole:{id:"Landmark_OtherPole",cursorImagePath:"public/img/cursors/Cursor_OtherPole.png"}}}function getLabelIconImagePath(a){return{Walk:{id:"Walk",iconImagePath:void 0},StopSign:{id:"StopSign",iconImagePath:"public/img/icons/Icon_BusStop.png"},StopSign_OneLeg:{id:"StopSign_OneLeg",iconImagePath:"public/img/icons/Icon_BusStopSign_SingleLeg.png"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",iconImagePath:"public/img/icons/Icon_BusStopSign_TwoLegged.png"},StopSign_Column:{id:"StopSign_Column",iconImagePath:"public/img/icons/Icon_BusStopSign_Column.png"},StopSign_None:{id:"StopSign_None",iconImagePath:"public/img/icons/Icon_BusStop.png"},Landmark_Shelter:{id:"Landmark_Shelter",iconImagePath:"public/img/icons/Icon_BusStopShelter.png"},Landmark_Bench:{id:"Landmark_Bench",iconImagePath:"public/img/icons/Icon_Bench.png"},Landmark_TrashCan:{id:"Landmark_TrashCan",iconImagePath:"public/img/icons/Icon_TrashCan2.png"},Landmark_MailboxAndNewsPaperBox:{id:"Landmark_MailboxAndNewsPaperBox",iconImagePath:"public/img/icons/Icon_Mailbox2.png"},Landmark_OtherPole:{id:"Landmark_OtherPole",iconImagePath:"public/img/icons/Icon_OtherPoles.png"}}}function getLabelInstructions(){return{Walk:{id:"Walk",instructionalText:"Explore mode: Find the closest bus stop and label surrounding landmarks",textColor:"rgba(255,255,255,1)"},StopSign:{id:"StopSign",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">stop sign</span>',textColor:"rgba(255,255,255,1)"},StopSign_OneLeg:{id:"StopSign_OneLeg",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">bus stop sign</span>',textColor:"rgba(255,255,255,1)"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">bus stop sign</span>',textColor:"rgba(255,255,255,1)"},StopSign_Column:{id:"StopSign_Column",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">bus stop sign</span>',textColor:"rgba(255,255,255,1)"},Landmark_Shelter:{id:"Landmark_Shelter",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">bus shelter</span>',textColor:"rgba(255,255,255,1)"},Landmark_Bench:{id:"Landmark_Bench",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">bench</span> nearby a bus stop',textColor:"rgba(255,255,255,1)"},Landmark_TrashCan:{id:"Landmark_TrashCan",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">trash can</span> nearby a bus stop',textColor:"rgba(255,255,255,1)"},Landmark_MailboxAndNewsPaperBox:{id:"Landmark_MailboxAndNewsPaperBox",instructionalText:'Label mode: Locate and click at the bottom of the <span class="underline">mailbox or news paper box</span> nearby a bus stop',textColor:"rgba(255,255,255,1)"},Landmark_OtherPole:{id:"Landmark_OtherPole",instructionalText:'Label mode: Locate and click at the bottom of poles such as <span class="underline bold">traffic sign, traffic light, and light pole</span> nearby a bus stop',textColor:"rgba(255,255,255,1)"}}}function getRibbonConnectionPositions(){return{Walk:{id:"Walk",text:"Walk",labelRibbonConnection:"25px"},StopSign:{id:"StopSign",text:"Stop Sign",labelRibbonConnection:"112px"},StopSign_OneLeg:{id:"StopSign_OneLeg",text:"One-leg Stop Sign",labelRibbonConnection:"112px"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",text:"Two-leg Stop Sign",labelRibbonConnection:"112px"},StopSign_Column:{id:"StopSign_Column",text:"Column Stop Sign",labelRibbonConnection:"112px"},Landmark_Shelter:{id:"Landmark_Shelter",text:"Bus Shelter",labelRibbonConnection:"188px"},Landmark_Bench:{id:"Landmark_Bench",text:"Bench",labelRibbonConnection:"265px"},Landmark_TrashCan:{id:"Landmark_TrashCan",text:"Trash Can",labelRibbonConnection:"338px"},Landmark_MailboxAndNewsPaperBox:{id:"Landmark_MailboxAndNewsPaperBox",labelRibbonConnection:"411px"},Landmark_OtherPole:{id:"Landmark_OtherPole",labelRibbonConnection:"484px"}}}function getLabelDescriptions(){return{Walk:{id:"Walk",text:"Walk"},StopSign:{id:"StopSign",text:"Bus Stop Sign"},StopSign_OneLeg:{id:"StopSign_OneLeg",text:"One-leg Stop Sign"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",text:"Two-leg Stop Sign"},StopSign_Column:{id:"StopSign_Column",text:"Column Stop Sign"},StopSign_None:{id:"StopSign_None",text:"Not provided"},Landmark_Shelter:{id:"Landmark_Shelter",text:"Bus Stop Shelter"},Landmark_Bench:{id:"Landmark_Bench",text:"Bench"},Landmark_TrashCan:{id:"Landmark_TrashCan",text:"Trash Can / Recycle Can"},Landmark_MailboxAndNewsPaperBox:{id:"Landmark_MailboxAndNewsPaperBox",text:"Mailbox / News Paper Box"},Landmark_OtherPole:{id:"Landmark_OtherPole",text:"Traffic Sign / Pole"}}}function getLabelColors(){return colorScheme2()}function colorScheme1(){return{Walk:{id:"Walk",fillStyle:"rgba(0, 0, 0, 0.9)"},StopSign:{id:"StopSign",fillStyle:"rgba(102, 194, 165, 0.9)"},StopSign_OneLeg:{id:"StopSign_OneLeg",fillStyle:"rgba(102, 194, 165, 0.9)"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",fillStyle:"rgba(102, 194, 165, 0.9)"},StopSign_Column:{id:"StopSign_Column",fillStyle:"rgba(102, 194, 165, 0.9)"},StopSign_None:{id:"StopSign_None",fillStyle:"rgba(102, 194, 165, 0.9"},Landmark_Shelter:{id:"Landmark_Shelter",fillStyle:"rgba(252, 141, 98, 0.9)"},Landmark_Bench:{id:"Landmark_Bench",fillStyle:"rgba(141, 160, 203, 0.9)"},Landmark_TrashCan:{id:"Landmark_TrashCan",fillStyle:"rgba(231, 138, 195, 0.9)"}}}function colorScheme2(){return{Walk:{id:"Walk",fillStyle:"rgba(0, 0, 0, 0.9)"},StopSign:{id:"StopSign",fillStyle:"rgba(0, 161, 203, 0.9)"},StopSign_OneLeg:{id:"StopSign_OneLeg",fillStyle:"rgba(0, 161, 203, 0.9)"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",fillStyle:"rgba(0, 161, 203, 0.9)"},StopSign_Column:{id:"StopSign_Column",fillStyle:"rgba(0, 161, 203, 0.9)"},Landmark_Shelter:{id:"Landmark_Shelter",fillStyle:"rgba(215, 0, 96, 0.9)"},Landmark_Bench:{id:"Landmark_Bench",fillStyle:"rgba(252, 217, 32, 0.9)"},Landmark_TrashCan:{id:"Landmark_TrashCan",fillStyle:"rgba(97, 174, 36, 0.9)"},Landmark_MailboxAndNewsPaperBox:{id:"Landmark_MailboxAndNewsPaperBox",fillStyle:"rgba(67, 113, 190, 0.9)"},Landmark_OtherPole:{id:"Landmark_OtherPole",fillStyle:"rgba(249, 79, 101, 0.9)"}}}function colorScheme3(){return{Walk:{id:"Walk",fillStyle:"rgba(0, 0, 0, 0.9)"},StopSign:{id:"StopSign",fillStyle:"rgba(97, 210, 214, 0.9)"},StopSign_OneLeg:{id:"StopSign_OneLeg",fillStyle:"rgba(97, 210, 214, 0.9)"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",fillStyle:"rgba(97, 210, 214, 0.9)"},StopSign_Column:{id:"StopSign_Column",fillStyle:"rgba(97, 210, 214, 0.9)"},Landmark_Shelter:{id:"Landmark_Shelter",fillStyle:"rgba(237, 20, 111, 0.9)"},Landmark_Bench:{id:"Landmark_Bench",fillStyle:"rgba(237, 222, 69, 0.9)"},Landmark_TrashCan:{id:"Landmark_TrashCan",fillStyle:"rgba(155, 240, 233, 0.9)"}}}function colorScheme4(){return{Walk:{id:"Walk",fillStyle:"rgba(0, 0, 0, 0.9)"},StopSign:{id:"StopSign",fillStyle:"rgba(252, 217, 32, 0.9)"},StopSign_OneLeg:{id:"StopSign_OneLeg",fillStyle:"rgba(252, 217, 32, 0.9)"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",fillStyle:"rgba(252, 217, 32, 0.9)"},StopSign_Column:{id:"StopSign_Column",fillStyle:"rgba(252, 217, 32, 0.9)"},Landmark_Shelter:{id:"Landmark_Shelter",fillStyle:"rgba(229, 59, 81, 0.9)"},Landmark_Bench:{id:"Landmark_Bench",fillStyle:"rgba(60, 181, 181, 0.9)"},Landmark_TrashCan:{id:"Landmark_TrashCan",fillStyle:"rgba(236, 108, 32, 0.9)"}}}function colorScheme5(){return{Walk:{id:"Walk",fillStyle:"rgba(0, 0, 0, 0.9)"},StopSign:{id:"StopSign",fillStyle:"rgba(208, 221, 43, 0.9)"},StopSign_OneLeg:{id:"StopSign_OneLeg",fillStyle:"rgba(208, 221, 43, 0.9)"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",fillStyle:"rgba(208, 221, 43, 0.9)"},StopSign_Column:{id:"StopSign_Column",fillStyle:"rgba(208, 221, 43, 0.9)"},Landmark_Shelter:{id:"Landmark_Shelter",fillStyle:"rgba(152, 199, 61, 0.9)"},Landmark_Bench:{id:"Landmark_Bench",fillStyle:"rgba(0, 169, 224, 0.9)"},Landmark_TrashCan:{id:"Landmark_TrashCan",fillStyle:"rgba(103, 205, 220, 0.9)"}}}function colorScheme6(){return{Walk:{id:"Walk",fillStyle:"rgba(0, 0, 0, 0.9)"},StopSign:{id:"StopSign",fillStyle:"rgba(210, 54, 125, 0.9)"},StopSign_OneLeg:{id:"StopSign_OneLeg",fillStyle:"rgba(210, 54, 125, 0.9)"},StopSign_TwoLegs:{id:"StopSign_TwoLegs",fillStyle:"rgba(210, 54, 125, 0.9)"},StopSign_Column:{id:"StopSign_Column",fillStyle:"rgba(210, 54, 125, 0.9)"},Landmark_Shelter:{id:"Landmark_Shelter",fillStyle:"rgba(188, 160, 0, 0.9)"},Landmark_Bench:{id:"Landmark_Bench",fillStyle:"rgba(207, 49, 4, 0.9)"},Landmark_TrashCan:{id:"Landmark_TrashCan",fillStyle:"rgba(1, 142, 74, 0.9)"}}}function Canvas(a,b){function c(a){var b=document.getElementById("label-canvas");k=b.getContext("2d"),r.width=b.width,r.height=b.height,a&&"evaluationMode"in a&&(n.evaluationMode=a.evaluationMode),w&&(w.bind("mousedown",e),w.bind("mouseup",f),w.bind("mousemove",g)),y&&y.bind("click",i)}function d(){svw.tracker.push("LabelingCanvas_FinishLabeling");var a=svw.ribbon.getStatus("selectedLabelType"),b=getLabelColors()[a],c=getLabelDescriptions()[svw.ribbon.getStatus("selectedLabelType")],d=getLabelIconImagePath()[c.id].iconImagePath;o.fillStyleInnerCircle=b.fillStyle,o.iconImagePath=d;var e,f=s.length,g=[],h=svw.getPOV();for(e=0;f>e;e++)g.push(new Point(s[e].x,s[e].y,h,o));var i=new Path(g,{}),j=getPosition(),k={canvasWidth:svw.canvasWidth,canvasHeight:svw.canvasHeight,canvasDistortionAlphaX:svw.alpha_x,canvasDistortionAlphaY:svw.alpha_y,labelId:svw.getLabelCounter(),labelType:c.id,labelDescription:c.text,labelFillStyle:b.fillStyle,panoId:getPanoId(),panoramaLat:j.lat,panoramaLng:j.lng,panoramaHeading:h.heading,panoramaPitch:h.pitch,panoramaZoom:h.zoom,svImageWidth:svw.svImageWidth,svImageHeight:svw.svImageHeight,svMode:"html4"};if("panorama"in svw&&"getPhotographerPov"in svw.panorama){var l=svw.panorama.getPhotographerPov();k.photographerHeading=l.heading,k.photographerPitch=l.pitch}var m=Label(i,k);if(!m)throw"Failed to add a new label.";p.currentLabel=new Label(i,k),v.push(p.currentLabel),svw.actionStack.push("addLabel",p.currentLabel),s=[],svw.ribbon.backToWalk(),"goldenInsertion"in svw&&svw.goldenInsertion&&svw.goldenInsertion.isRevisingLabels()&&svw.goldenInsertion.reviewLabels()}function e(a){m.isLeftDown=!0,m.leftDownX=mouseposition(a,this).x,m.leftDownY=mouseposition(a,this).y,n.evaluationMode||svw.tracker.push("LabelingCanvas_MouseDown",{x:m.leftDownX,y:m.leftDownY}),m.prevMouseDownTime=(new Date).getTime()}function f(a){var b;if(m.isLeftDown=!1,m.leftUpX=mouseposition(a,this).x,m.leftUpY=mouseposition(a,this).y,b=(new Date).getTime(),!n.evaluationMode)if(!p.disableLabeling&&b-m.prevMouseUpTime>300){var c;if(!svw.ribbon)throw l.className+" drawingLayerMouseUp(): ribbon not defined.";var e=svw.ribbon.getStatus("selectedLabelType"),f=getLabelDescriptions();if(c=f[e],p.drawing){var g=!1,h=s.length;if(h>2){var i=Math.sqrt(Math.pow(s[0].x-m.leftUpX,2)+Math.pow(s[0].y-m.leftUpY,2));i<n.radiusThresh&&(g=!0,p.drawing=!1,d())}if(!g){var j={x:m.leftUpX,y:m.leftUpY};s.push(j)}}else{p.drawing=!0,"tracker"in svw&&svw.tracker&&svw.tracker.push("LabelingCanvas_StartLabeling");var j={x:m.leftUpX,y:m.leftUpY};s.push(j)}l.clear(),l.setVisibilityBasedOnLocation("visible",getPanoId()),l.render2()}else if(b-m.prevMouseUpTime<400){var h=s.length;p.drawing&&h>2&&(p.drawing=!1,d(),l.clear(),l.setVisibilityBasedOnLocation("visible",getPanoId()),l.render2())}svw.tracker.push("LabelingCanvas_MouseUp",{x:m.leftUpX,y:m.leftUpY}),m.prevMouseUpTime=(new Date).getTime(),m.prevMouseDownTime=0}function g(b){var c=mouseposition(b,this);if(m.currX=c.x,m.currY=c.y,!("ribbon"in svw))throw l.className+": Import the RibbonMenu.js and instantiate it!";var d=svw.misc.getLabelCursorImagePath(),e=svw.ribbon.getStatus("mode");if(e){var f=d[e].cursorImagePath,g="url("+f+") 6 25, auto";t&&t.isAnyOpen()&&(g="default"),a(this).css("cursor",g)}if(!p.drawing){var i=h(m.currX,m.currY);i&&"Path"===i.className?(l.showLabelTag(p.currentLabel),i.renderBoundingBox(k)):l.showLabelTag(void 0)}l.clear(),l.render2(),m.prevX=mouseposition(b,this).x,m.prevY=mouseposition(b,this).y}function h(a,b){var c,d,e;for(d=v.length,e=!1,c=0;d>c;c+=1)if(e=v[c].isOn(a,b))return p.currentLabel=v[c],e;return!1}function i(){if(!p.disableLabelDelete){svw.tracker.push("Click_LabelDelete");var a=l.getCurrentLabel();if(!a){var b=x.css("left"),c=x.css("top");b=b.replace("px",""),c=c.replace("px",""),b=parseInt(b,10)+5,c=parseInt(c,10)+5;var d=h(b,c);if(d&&"Point"===d.className){var e=d.belongsTo();a=e.belongsTo()}else d&&"Label"===d.className?a=d:d&&"Path"===d.className&&(a=d.belongsTo())}a&&(l.removeLabel(a),svw.actionStack.push("deleteLabel",l.getCurrentLabel()),x.css("visibility","hidden"),q.showLabelTag&&l.unlockShowLabelTag())}}function j(){if(!svw.ribbon)return!1;var a=0,b=s.length,c=getLabelColors()[svw.ribbon.getStatus("selectedLabelType")],d=c.fillStyle;if(d=svw.util.color.changeAlphaRGBA(d,.5),k.strokeStyle="rgba(255,255,255,1)",k.lineWidth=2,b>1){var e=s[1],f=s[0],g=Math.sqrt(Math.pow(s[0].x-m.currX,2)+Math.pow(s[0].y-m.currY,2));g<n.radiusThresh&&b>2?svw.util.shape.lineWithRoundHead(k,f.x,f.y,2*n.tempPointRadius,e.x,e.y,n.tempPointRadius,"both","rgba(255,255,255,1)",d,"none","rgba(255,255,255,1)",d):svw.util.shape.lineWithRoundHead(k,f.x,f.y,n.tempPointRadius,e.x,e.y,n.tempPointRadius,"both","rgba(255,255,255,1)",d,"none","rgba(255,255,255,1)",d)}for(a=2;b>a;a++){var e=s[a],f=s[a-1];svw.util.shape.lineWithRoundHead(k,f.x,f.y,5,e.x,e.y,5,"both","rgba(255,255,255,1)",d,"none","rgba(255,255,255,1)",d)}g<n.radiusThresh&&b>2?svw.util.shape.lineWithRoundHead(k,s[b-1].x,s[b-1].y,n.tempPointRadius,s[0].x,s[0].y,2*n.tempPointRadius,"both","rgba(255,255,255,1)",d,"none","rgba(255,255,255,1)",d):svw.util.shape.lineWithRoundHead(k,s[b-1].x,s[b-1].y,n.tempPointRadius,m.currX,m.currY,n.tempPointRadius,"both","rgba(255,255,255,1)",d,"stroke","rgba(255,255,255,1)",d)}var k,l={className:"Canvas",testCases:{}},m={currX:0,currY:0,prevX:0,prevY:0,leftDownX:0,leftDownY:0,leftUpX:0,leftUpY:0,isLeftDown:!1,prevMouseDownTime:0,prevMouseUpTime:0},n={evaluationMode:!1,radiusThresh:7,showDeleteMenuTimeOutToken:void 0,tempPointRadius:5},o={fillStyleInnerCircle:"rgba(0,0,0,1)",lineWidthOuterCircle:2,iconImagePath:void 0,radiusInnerCircle:5,radiusOuterCircle:6,strokeStyleOuterCircle:"rgba(255,255,255,1)",storedInDatabase:!1},p={currentLabel:null,disableLabelDelete:!1,disableLabelEdit:!1,disableLabeling:!1,disableWalking:!1,drawing:!1,lockCurrentLabel:!1,lockDisableLabelDelete:!1,lockDisableLabelEdit:!1,lockDisableLabeling:!1,svImageCoordinatesAdjusted:!1,totalLabelCount:0,visibilityMenu:"hidden"},q={showLabelTag:!1},r={height:0,width:0},s=[],t=void 0,u=[],v=[],w=(0===a("#labelCanvas").length?null:a("#labelCanvas"),0===a("div#labelDrawingLayer").length?null:a("div#labelDrawingLayer")),x=0===a("#Holder_LabelDeleteIcon").length?null:a("#Holder_LabelDeleteIcon"),y=(0===a("#Holder_LabelEditIcon").length?null:a("#Holder_LabelEditIcon"),0===a("#LabelDeleteIcon").length?null:a("#LabelDeleteIcon"));return l.cancelDrawing=function(){return"tracker"in svw&&svw.tracker&&svw.tracker.push("LabelingCanvas_CancelLabeling"),s=[],p.drawing=!1,l.clear().render2(),this},l.clear=function(){return k?k.clearRect(0,0,r.width,r.height):console.warn("The ctx is not set."),this},l.disableLabelDelete=function(){return p.lockDisableLabelDelete?!1:(p.disableLabelDelete=!0,this)},l.disableLabelEdit=function(){return p.lockDisableLabelEdit?!1:(p.disableLabelEdit=!0,this)},l.disableLabeling=function(){return p.lockDisableLabeling?!1:(p.disableLabeling=!0,this)},l.enableLabelDelete=function(){return p.lockDisableLabelDelete?!1:(p.disableLabelDelete=!1,this)},l.enableLabelEdit=function(){return p.lockDisableLabelEdit?!1:(p.disableLabelEdit=!1,this)},l.enableLabeling=function(){return p.lockDisableLabeling?!1:(p.disableLabeling=!1,this)},l.getCurrentLabel=function(){return p.currentLabel},l.getLabels=function(a){return a||(a="user"),"system"===a?l.getSystemLabels(!1):l.getUserLabels(!1)},l.getLock=function(a){return q[a]},l.getNumLabels=function(){var a,b=v.length,c=0;for(a=0;b>a;a++)!v[a].isDeleted()&&v[a].isVisible()&&c++;return c},l.getStatus=function(a){return a in p||console.warn("You have passed an invalid key for status."),p[a]},l.getSystemLabels=function(b){return b||(b=!1),b?u:a.extend(!0,[],u)},l.getUserLabelCount=function(){var a=l.getUserLabels();return a=a.filter(function(a){return!a.isDeleted()&&a.isVisible()}),a.length},l.getUserLabels=function(b){return b||(b=!1),b?v:a.extend(!0,[],v)},l.hideDeleteLabel=function(a,b){return t.hideDeleteLabel(),this},l.insertLabel=function(a,b){b||(b="user");var c,d,e,f,g=svw.misc.getLabelColors(),h=svw.misc.getIconImagePaths(),i=a.length,j=[];for(c=0;i>c;c+=1)d=a[c],e={heading:d.originalHeading,pitch:d.originalPitch,zoom:d.originalZoom},f=new Point,"PhotographerHeading"in d&&d.PhotographerHeading&&"PhotographerPitch"in d&&d.PhotographerPitch&&f.setPhotographerPov(parseFloat(d.PhotographerHeading),parseFloat(d.PhotographerPitch)),f.resetSVImageCoordinate({x:parseInt(d.svImageX,10),y:parseInt(d.svImageY,10)}),f.resetProperties({fillStyleInnerCircle:g[d.LabelType].fillStyle,lineWidthOuterCircle:2,iconImagePath:h[d.LabelType].iconImagePath,originalCanvasCoordinate:d.originalCanvasCoordinate,originalHeading:d.originalHeading,originalPitch:d.originalPitch,originalZoom:d.originalZoom,pov:e,radiusInnerCircle:5,radiusOuterCircle:6,strokeStyleOuterCircle:"rgba(255,255,255,1)",storedInDatabase:!1}),j.push(f);var k,l={},m=svw.misc.getLabelDescriptions();k=new Path(j),l.canvasWidth=svw.canvasWidth,l.canvasHeight=svw.canvasHeight,l.canvasDistortionAlphaX=svw.alpha_x,l.canvasDistortionAlphaY=svw.alpha_y,l.labelId=a[0].LabelId,l.labelerId=a[0].AmazonTurkerId,l.labelType=a[0].LabelType,l.labelDescription=m[l.labelType].text,l.labelFillStyle=g[l.labelType].fillStyle,l.panoId=a[0].LabelGSVPanoramaId,l.panoramaLat=a[0].Lat,l.panoramaLng=a[0].Lng,l.panoramaHeading=a[0].heading,l.panoramaPitch=a[0].pitch,l.panoramaZoom=a[0].zoom,l.svImageWidth=svw.svImageWidth,l.svImageHeight=svw.svImageHeight,l.svMode="html4","PhotographerPitch"in a[0]&&"PhotographerHeading"in a[0]&&(l.photographerHeading=a[0].PhotographerHeading,l.photographerPitch=a[0].PhotographerPitch);var n=new Label(k,l);"system"===b?u.push(n):v.push(n)},l.isDrawing=function(){return p.drawing},l.isOn=function(a,b){return h(a,b)},l.lockCurrentLabel=function(){return p.lockCurrentLabel=!0,this},l.lockDisableLabelDelete=function(){return p.lockDisableLabelDelete=!0,this},l.lockDisableLabelEdit=function(){return p.lockDisableLabelEdit=!0,this},l.lockDisableLabeling=function(){return p.lockDisableLabeling=!0,this},l.lockShowLabelTag=function(){return q.showLabelTag=!0,this},l.pushLabel=function(a){return p.currentLabel=a,v.push(a),svw.actionStack&&svw.actionStack.push("addLabel",a),this},l.removeAllLabels=function(){return v=[],this},l.removeLabel=function(a){return a?(svw.tracker.push("RemoveLabel",{labelId:a.getProperty("labelId")}),a.setStatus("deleted",!0),a.setStatus("visibility","hidden"),"goldenInsertion"in svw&&svw.goldenInsertion&&svw.goldenInsertion.isRevisingLabels()&&svw.goldenInsertion.reviewLabels(),l.clear(),l.render2(),this):!1},l.render=function(){svw.getPOV();return this},l.render2=function(){if(!k)return console.warn("The ctx is not set."),this;var a,b,c,d={Landmark_Bench:0,Landmark_Shelter:0,Landmark_TrashCan:0,Landmark_MailboxAndNewsPaperBox:0,Landmark_OtherPole:0,StopSign:0,CurbRamp:0,NoCurbRamp:0};p.totalLabelCount=0;var e=svw.getPOV();if(!p.svImageCoordinatesAdjusted){var f=svw.panorama.getPhotographerPov();if(f&&"heading"in f&&"pitch"in f){var g;for(c=v.length,a=0;c>a;a+=1){b=v[a];var h=b.getPoints(!0),i=h.length;for(g=0;i>g;g++){var l=h[g].getProperties(),m=h[g].getGSVImageCoordinate();if("photographerHeading"in l&&l.photographerHeading){var o=f.heading-l.photographerHeading,q=f.pitch-l.photographerPitch,r=(m.x+o/360*svw.svImageWidth+svw.svImageWidth)%svw.svImageWidth,s=m.y+q/90*svw.svImageHeight;h[g].resetSVImageCoordinate({x:r,y:s})}}}for(c=u.length,a=0;c>a;a+=1){b=u[a];var h=b.getPoints(!0),i=h.length;for(g=0;i>g;g++){var l=h[g].getProperties(),m=h[g].getGSVImageCoordinate();if("photographerHeading"in l&&l.photographerHeading){var o=f.heading-l.photographerHeading,q=f.pitch-l.photographerPitch,r=(m.x+o/360*svw.svImageWidth+svw.svImageWidth)%svw.svImageWidth,s=m.y+q/180*svw.svImageHeight;h[g].resetSVImageCoordinate({x:r,y:s})}}}p.svImageCoordinatesAdjusted=!0}}for(c=v.length,a=0;c>a;a+=1)b=v[a],n.evaluationMode?b.render(k,e,!0):b.render(k,e),b.isVisible()&&!b.isDeleted()&&(d[b.getLabelType()]+=1,p.totalLabelCount+=1);for(c=u.length,a=0;c>a;a+=1)b=u[a],n.evaluationMode?b.render(k,e,!0):b.render(k,e);return p.drawing&&j(),"form"in svw&&svw.form.checkSubmittable(),"progressPov"in svw&&svw.progressPov.updateCompletionRate(),svw.labeledLandmarkFeedback&&svw.labeledLandmarkFeedback.setLabelCount(d),svw.actionStack&&svw.actionStack.updateOpacity(),svw.zoomControl&&svw.zoomControl.updateOpacity(),"goldenInsertion"in svw&&svw.goldenInsertion&&svw.goldenInsertion.renderMessage(),this},l.renderBoundingBox=function(a){return a.renderBoundingBox(k),this},l.setCurrentLabel=function(a){return p.lockCurrentLabel?!1:(p.currentLabel=a,this)},l.setStatus=function(a,b){if(!(a in p))throw l.className+": Illegal status name.";return"disableLabeling"===a?"boolean"==typeof b?(b?l.disableLabeling():l.enableLabeling(),this):!1:"disableMenuClose"===a?"boolean"==typeof b?(b?l.disableMenuClose():l.enableMenuClose(),this):!1:void("disableLabelDelete"===a?b===!0?l.disableLabelDelete():b===!1&&l.enableLabelDelete():p[a]=b)},l.showLabelTag=function(a){if(!q.showLabelTag){var b,c,d=!1;if(c=v.length,a)for(b=0;c>b;b+=1)v[b].getLabelId()===a.getLabelId()?(v[b].setTagVisibility("visible"),d=!0):(v[b].setTagVisibility("hidden"),v[b].resetTagCoordinate());else{for(b=0;c>b;b++)v[b].setTagVisibility("hidden"),v[b].resetTagCoordinate();x.css("visibility","hidden")}return d||x.css("visibility","hidden"),l.clear().render2(),this}},l.setTagVisibility=function(a){return l.showLabelTag(a)},l.setVisibility=function(a){var b=0,c=0;for(c=v.length,b=0;c>b;b+=1)v[b].unlockVisibility().setVisibility("visible");return this},l.setVisibilityBasedOnLocation=function(a){var b=0,c=0;for(c=v.length,b=0;c>b;b+=1)v[b].setVisibilityBasedOnLocation(a,getPanoId());return this},l.setVisibilityBasedOnLabelerId=function(a,b,c){var d=0,e=0;for(e=v.length,d=0;e>d;d+=1)v[d].setVisibilityBasedOnLabelerId(a,b,c);return this},l.setVisibilityBasedOnLabelerIdAndLabelTypes=function(a,b,c){var d=0,e=0;for(e=v.length,d=0;e>d;d+=1)v[d].setVisibilityBasedOnLabelerIdAndLabelTypes(a,b,c);return this},l.showDeleteLabel=function(a,b){t.showDeleteLabel(a,b)},l.unlockCurrentLabel=function(){return p.lockCurrentLabel=!1,this},l.unlockDisableLabelDelete=function(){return p.lockDisableLabelDelete=!1,this},l.unlockDisableLabelEdit=function(){return p.lockDisableLabelEdit=!1,this},l.unlockDisableLabeling=function(){return p.lockDisableLabeling=!1,this},l.unlockShowLabelTag=function(){return q.showLabelTag=!1,this},c(b),l}function ExampleWindow(a,b){function c(b){f=a(b.domIds.holder),g=a(b.domIds.closeButtonHolder),h=a(b.domIds.StopSign_OneLeg),i=a(b.domIds.StopSign_TwoLegs),j=a(b.domIds.StopSign_Column),k=a(b.domIds.NextToCurb),l=a(b.domIds.AwayFromCurb),p={StopSign_OneLeg:h,StopSign_TwoLegs:i,StopSign_Column:j,NextToCurb:k,AwayFromCurb:l},g.bind({click:m.close,mouseenter:d,mouseleave:e})}function d(){return a(this).css({cursor:"pointer"}),this}function e(){return a(this).css({cursor:"default"}),this}var f,g,h,i,j,k,l,m={className:"ExampleWindow"},n={exampleCategories:["StopSign_OneLeg","StopSign_TwoLegs","StopSign_Column","NextToCurb","AwayFromCurb"]},o={open:!1},p={};return m.close=function(){return o.open=!1,f.css({visibility:"hidden"}),a.each(p,function(a,b){b.css({visibility:"hidden"})}),this},m.isOpen=function(){return o.open},m.show=function(b){return-1===n.exampleCategories.indexOf(b)?!1:(o.open=!0,f.css({visibility:"visible"}),a.each(p,function(a,c){console.log(a),a===b?c.css({visibility:"visible"}):c.css({visibility:"hidden"})}),this)},c(b),m}function Form(a,b){function c(b){var c=(""!==getURLParameter("groupId"),""!==getURLParameter("hitId")),d=""!==getURLParameter("workerId"),f=getURLParameter("assignmentId");if(D.onboarding=b.onboarding,D.dataStoreUrl=b.dataStoreUrl,"assignmentId"in b&&b.assignmentId&&(D.assignmentId=b.assignmentId),"hitId"in b&&b.hitId&&(D.hitId=b.hitId),"turkerId"in b&&b.turkerId&&(D.turkerId=b.turkerId),"userExperiment"in b&&b.userExperiment&&(D.userExperiment=!0),p=a("#BusStopLabelerForm"),q=a("#CommentField"),r=a("#Button_Submit"),s=a("#Button_Skip"),t=a("#BusStopAbsence_Submit"),u=a("#BusStopAbsence_Cancel"),v=a(".Radio_BusStopAbsence"),w=a("#Text_BusStopAbsenceOtherReason"),x=a("#Holder_SkipOptions"),y=a("#Holder_PageOverlay"),D.userExperiment&&(A=a("#task-difficulty-button"),z=a("#task-difficulty-wrapper")),a('input[name="assignmentId"]').attr("value",D.assignmentId),a('input[name="workerId"]').attr("value",D.turkerId),a('input[name="hitId"]').attr("value",D.hitId),f&&"ASSIGNMENT_ID_NOT_AVAILABLE"===f?(D.isPreviewMode=!0,D.isAMTTask=!0,C.unlockDisableSubmit().disableSubmit().lockDisableSubmit(),C.unlockDisableSkip().disableSkip().lockDisableSkip()):d&&!f?(D.isPreviewMode=!1,D.isAMTTask=!1):f||c||d?(D.isPreviewMode=!1,D.isAMTTask=!0):(D.isPreviewMode=!1,D.isAMTTask=!1),D.isSandbox=!1,D.isAMTTask&&-1!==document.referrer.indexOf("workersandbox.mturk.com")&&(D.isSandbox=!0,p.prop("action","https://workersandbox.mturk.com/mturk/externalSubmit")),D.isAMTTask&&D.isPreviewMode){var h='<div class="amt-preview-warning-holder"><div class="amt-preview-warning">Warning: you are on a Preview Mode!</div></div>';a("body").append(h),C.disableSubmit(),C.lockDisableSubmit()}D.commentFieldMessage=q.attr("title"),q.val(D.commentFieldMessage),e(),q.bind("focus",focusCallback),q.bind("blur",blurCallback),p.bind("submit",g),s.bind("click",k),t.on("click",j),u.on("click",l),v.on("click",m),w.get().length>0&&(w[0].oninput=n),D.userExperiment&&A.bind("click",o)}function d(){var b,c,d,e={},f=svw.map.getInitialPanoId();b=D.hitId?D.hitId:getURLParameter("hitId"),c=D.assignmentId?D.assignmentId:getURLParameter("assignmentId"),d=D.turkerId?D.turkerId:getURLParameter("workerId"),d||(d="Test_Kotaro"),b||(b="Test_Hit"),c||(c="Test_Assignment"),e.assignment={amazon_turker_id:d,amazon_hit_id:b,amazon_assignment_id:c,interface_type:"StreetViewLabeler",interface_version:"3",completed:0,need_qualification:0,task_description:D.taskDescription},e.labelingTask={task_panorama_id:D.taskPanoramaId,task_gsv_panorama_id:f,no_label:0,description:"",previous_labeling_task_id:D.previousLabelingTaskId},e.labelingTaskEnvironment={browser:getBrowser(),browser_version:getBrowserVersion(),browser_width:a(window).width(),browser_height:a(window).height(),screen_width:screen.width,screen_height:screen.height,avail_width:screen.availWidth,avail_height:screen.availHeight,operating_system:getOperatingSystem()},e.userInteraction=svw.tracker.getActions(),e.labels=[];for(var g=svw.canvas.getLabels(),h=0;h<g.length;h+=1){var i=g[h],j=i.getProperties(),k=i.getPath().getPoints(),l=k.length,m={deleted:i.isDeleted()?1:0,label_id:i.getLabelId(),label_type:i.getLabelType(),label_gsv_panorama_id:j.panoId,label_points:[],label_additional_information:void 0
};"photographerHeading"in j&&"photographerPitch"in j&&(m.photographer_heading=j.photographerHeading,m.photographer_pitch=j.photographerPitch);for(var n=0;l>n;n+=1){var o=k[n],p=o.getGSVImageCoordinate(),r={svImageX:p.x,svImageY:p.y,originalCanvasX:o.originalCanvasCoordinate.x,originalCanvasY:o.originalCanvasCoordinate.y,originalHeading:o.originalPov.heading,originalPitch:o.originalPov.pitch,originalZoom:o.originalPov.zoom,canvasX:o.canvasCoordinate.x,canvasY:o.canvasCoordinate.y,heading:o.pov.heading,pitch:o.pov.pitch,zoom:o.pov.zoom,lat:j.panoramaLat,lng:j.panoramaLng,svImageHeight:j.svImageHeight,svImageWidth:j.svImageWidth,canvasHeight:j.canvasHeight,canvasWidth:j.canvasWidth,alphaX:j.canvasDistortionAlphaX,alphaY:j.canvasDistortionAlphaY};m.label_points.push(r)}e.labels.push(m)}0===e.labels.length&&(e.labelingTask.no_label=0);var s=q.val();return e.comment=void 0,s&&s!==q.attr("title")&&(e.comment=q.val()),e}function e(){t.attr("disabled",!0),t.css("color","rgba(96,96,96,0.5)")}function f(){t.attr("disabled",!1),t.css("color","rgba(96,96,96,1)")}function g(b){(!D.isAMTTask||D.taskRemaining>1)&&b.preventDefault();var c=D.dataStoreUrl,e={};if(E.disableSubmit)return i(),!1;if(window.location.reload(),"goldenInsertion"in svw&&svw.goldenInsertion){svw.goldenInsertion.reviewLabels();return C.disableSubmit().lockDisableSubmit(),C.disableSkip().lockDisableSkip(),!1}if(t.attr("disabled",!0),y.css("visibility","visible"),D.userExperiment&&!E.taskDifficulty)return E.submitType="submit",z.css("visibility","visible"),!1;if(!D.onboarding){svw.tracker.push("TaskSubmit"),e=d(),void 0!=E.taskDifficulty&&(e.taskDifficulty=E.taskDifficulty,e.labelingTask.description="TaskDifficulty:"+E.taskDifficulty,E.taskDifficultyComment&&(e.comment="TaskDifficultyCommentField:"+E.taskDifficultyComment+";InterfaceCommentField:"+e.comment));try{a.ajax({async:!1,url:c,type:"post",data:e,dataType:"json",success:function(a){a.error&&console.log(a.error)},error:function(a){throw a}})}catch(b){return console.error(b),!1}return D.taskRemaining>1?(window.location.reload(),!1):D.isAMTTask?!0:(window.location.reload(),!1)}return!1}function h(){if(!("goldenInsertion"in svw&&svw.goldenInsertion))throw C.className+": This method cannot be called without GoldenInsertion";svw.tracker.push("GoldenInsertion_Submit");var b,c=D.dataStoreUrl;svw.goldenInsertion.disableOkButton(),b=d(),b.labelingTask.description="GoldenInsertion";try{a.ajax({async:!1,url:c,type:"post",data:b,dataType:"json",success:function(a){"object"==typeof a&&"error"in a&&a.error&&console.log(a.error)},error:function(a){throw a}})}catch(e){return console.error(e),!1}return window.location.reload(),!1}function i(){var b=parseInt(100*svw.progressPov.getCompletionRate(),10);if(!("onboarding"in svw&&svw.onboarding)&&100>b){var c,d="You have inspected "+b+"% of the scene. Let's inspect all the corners before you submit the task!",e=a("#Holder_OnboardingMessageBox");if(B.clear(),B.renderMessage(300,250,d,350,140),B.renderArrow(650,282,710,282),"hidden"===E.disabledButtonMessageVisibility){E.disabledButtonMessageVisibility="visible";var f='<button id="TempOKButton" class="button bold" style="left:20px;position:relative; width:100px;">OK</button>';e.append(f),c=a("#TempOKButton"),c.bind("click",function(){c.remove(),B.clear(),E.disabledButtonMessageVisibility="hidden"})}}}function j(b){(!D.isAMTTask||D.taskRemaining>1)&&b.preventDefault();var c=D.dataStoreUrl,e={};if("goldenInsertion"in svw&&svw.goldenInsertion){C.disableSubmit().lockDisableSubmit(),s.attr("disabled",!0),t.attr("disabled",!0),x.css({visibility:"hidden"});svw.goldenInsertion.reviewLabels();return!1}if(r.attr("disabled",!0),s.attr("disabled",!0),t.attr("disabled",!0),y.css("visibility","visible"),D.userExperiment&&!E.taskDifficulty)return E.submitType="skip",z.css("visibility","visible"),!1;if("Other:"===E.radioValue&&(E.skipReasonDescription="Other: "+w.val()),!D.onboarding){svw.tracker.push("TaskSubmitSkip"),e=d(),e.noLabels=!0,e.labelingTask.no_label=1,e.labelingTask.description=E.skipReasonDescription,void 0!=E.taskDifficulty&&(e.taskDifficulty=E.taskDifficulty,e.labelingTask.description="TaskDifficulty:"+E.taskDifficulty,E.taskDifficultyComment&&(e.comment="TaskDifficultyCommentField:"+E.taskDifficultyComment+";InterfaceCommentField:"+e.comment));try{a.ajax({async:!1,url:c,type:"post",data:e,success:function(a){a.error&&console.log(a.error)},error:function(a){throw a}})}catch(b){return console.error(b),!1}return D.taskRemaining>1?(window.location.reload(),!1):D.isAMTTask?(document.getElementById("BusStopLabelerForm").submit(),!0):(window.location.reload(),!1)}return!1}function k(a){return a.preventDefault(),E.disableSkip?i():(svw.tracker.push("Click_OpenSkipWindow"),x.css({visibility:"visible"})),!1}function l(a){return a.preventDefault(),svw.tracker.push("Click_CloseSkipWindow"),x.css({visibility:"hidden"}),!1}function m(){if(E.radioValue=a(this).attr("value"),svw.tracker.push("Click_SkipRadio",{RadioValue:E.radioValue}),"Other:"!==E.radioValue)E.skipReasonDescription=E.radioValue,f();else{var b=w.val();b?f():e()}}function n(){if(E.radioValue&&"Other:"===E.radioValue){var a=w.val();a?f():e()}}function o(b){E.taskDifficulty=parseInt(a('input[name="taskDifficulty"]:radio:checked').val(),10),E.taskDifficultyComment=a("#task-difficulty-comment").val(),E.taskDifficultyComment=""!=E.taskDifficultyComment?E.taskDifficultyComment:void 0,console.log(E.taskDifficultyComment),E.taskDifficulty&&("submitType"in E&&"submit"==E.submitType?g(b):"submitType"in E&&"skip"==E.submitType&&j(b))}var p,q,r,s,t,u,v,w,x,y,z,A,B,C={className:"Form"},D={commentFieldMessage:void 0,isAMTTask:!1,isPreviewMode:!1,previousLabelingTaskId:void 0,dataStoreUrl:void 0,onboarding:!1,taskRemaining:0,taskDescription:void 0,taskPanoramaId:void 0,hitId:void 0,assignmentId:void 0,turkerId:void 0,userExperiment:!1},E={disabledButtonMessageVisibility:"hidden",disableSkipButton:!1,disableSubmit:!1,radioValue:void 0,skipReasonDescription:void 0,submitType:void 0,taskDifficulty:void 0,taskDifficultyComment:void 0},F={disableSkipButton:!1,disableSubmit:!1};return C.checkSubmittable=function(){if("progressPov"in svw&&svw.progressPov)var a=svw.progressPov.getCompletionRate();else var a=0;var b=svw.canvas.getNumLabels();return.01>1-a?(b>0?(C.enableSubmit(),C.disableSkip()):(C.disableSubmit(),C.enableSkip()),!0):(C.disableSubmit(),C.disableSkip(),!1)},C.compileSubmissionData=function(){return d()},C.disableSubmit=function(){return F.disableSubmit?!1:(E.disableSubmit=!0,r.css("opacity",.5),this)},C.disableSkip=function(){return F.disableSkip?!1:(E.disableSkip=!0,s.css("opacity",.5),this)},C.enableSubmit=function(){return F.disableSubmit?!1:(E.disableSubmit=!1,r.css("opacity",1),this)},C.enableSkip=function(){return F.disableSkip?!1:(E.disableSkip=!1,s.css("opacity",1),this)},C.goldenInsertionSubmit=function(){return h()},C.isPreviewMode=function(){return D.isPreviewMode},C.lockDisableSubmit=function(){return F.disableSubmit=!0,this},C.lockDisableSkip=function(){return F.disableSkip=!0,this},C.setPreviousLabelingTaskId=function(a){return D.previousLabelingTaskId=a,this},C.setTaskDescription=function(a){return D.taskDescription=a,this},C.setTaskRemaining=function(a){return D.taskRemaining=a,this},C.setTaskPanoramaId=function(a){return D.taskPanoramaId=a,this},C.unlockDisableSubmit=function(){return F.disableSubmit=!1,this},C.unlockDisableSkip=function(){return F.disableSkipButton=!1,this},c(b),C}function GoldenInsertion(a,b){function c(a){"goldenLabelVisibility"in a&&(p.goldenLabelVisibility=a.goldenLabelVisibility),l=new Onboarding(a,b),m=b("#ModeSwitchButton_CurbRamp"),n=b("#ModeSwitchButton_NoCurbRamp")}function d(){q.currentLabel=void 0,l.clear()}function e(){if(!("form"in svw&&svw.form))throw o.className+": Cannnot submit without a Form object.";svw.form.goldenInsertionSubmit()}function f(a,b){return a.relativeHeading<b.relativeHeading?-1:a.relativeHeading>b.relativeHeading?1:0}function g(a){if("canvas"in svw&&svw.canvas&&"map"in svw&&svw.map){svw.tracker.push("GoldenInsertion_ReviseFalseNegative");var b,c=a.getLabelId(),d=svw.canvas.getSystemLabels(!0),e=d.length;for(b=0;e>b;b++)c==d[b].getLabelId()?(a=d[b],a.unlockVisibility().setVisibility("visible").lockVisibility()):d[b].unlockVisibility().setVisibility("hidden").lockVisibility();var f=a.getLabelPov(),g=a.getLabelType();q.currentLabel=a,"CurbRamp"===g?q.boxMessage="You did not label this <b>curb ramp</b>. Please draw an outline around it.":q.boxMessage="You did not label this <b>missing curb ramp</b>. Please draw an outline around it.",svw.messageBox.hide(),svw.map.setPov(f,p.cameraMovementDuration,function(){q.currentLabel=a,j(),"CurbRamp"===g?svw.ribbon.modeSwitch("CurbRamp"):"NoCurbRamp"===g&&svw.ribbon.modeSwitch("NoCurbRamp")});var h="rgba(0,0,255, 0.5)";a.fill(h).blink(5)}}function h(a,b){if(b&&"number"==typeof b||(b=0),"canvas"in svw&&svw.canvas&&"map"in svw&&svw.map){svw.tracker.push("GoldenInsertion_ReviseFalsePositive");var c,d=a.getLabelId(),e=svw.canvas.getUserLabels(!0),f=svw.canvas.getUserLabelCount();for(c=0;f>c;c++)if(d==e[c].getLabelId()){a=e[c];break}var g=a.getLabelPov(),h=a.getLabelType();q.currentLabel=a,"CurbRamp"===h?b>0?q.boxMessage='This label does not precisely outline the <b>curb ramp</b>. Mouse over the label and click <img src="public/img/icons/Sidewalk/Icon_Delete.svg" class="MessageBoxIcons"/> to delete.':q.boxMessage='There does not appear to be a curb ramp to label here. Mouse over the label and click <img src="public/img/icons/Sidewalk/Icon_Delete.svg" class="MessageBoxIcons"/> to delete.':b>0?q.boxMessage='Your label is not on a <b>missing curb ramp</b>. Mouse over the label and click <img src="public/img/icons/Sidewalk/Icon_Delete.svg" class="MessageBoxIcons"/> to delete.':q.boxMessage='There does not appear to be any missing curb ramp to label here. Mouse over the label and click <img src="public/img/icons/Sidewalk/Icon_Delete.svg" class="MessageBoxIcons"/> to delete.',svw.messageBox.hide(),svw.map.setPov(g,p.cameraMovementDuration,function(){q.currentLabel=a,j()});var i="rgba(255, 0, 0, 0.7)";a.fill(i).blink(5)}}function i(){if("canvas"in svw&&svw.canvas&&"form"in svw&&svw.form&&"map"in svw&&svw.map&&"panorama"in svw&&svw.panorama){svw.tracker.push("GoldenInsertion_ReviewLabels");var a=svw.canvas.getLabels("user"),c=svw.canvas.getLabels("system"),i=[];d(),a=a.filter(function(a){return!a.isDeleted()&&a.isVisible()});var j=a.map(function(a){return a.labeledBy="user",a}),l=c.map(function(a){return a.labeledBy="system",a}),i=j.concat(l);i=i.map(function(a){var b=svw.panorama.getPov().heading,c=a.getLabelPov().heading,d=10;return a.relativeHeading=parseInt((c-b+360)%360),a.relativeHeading=a.relativeHeading<360-a.relativeHeading?a.relativeHeading:360-a.relativeHeading,a.relativeHeading="system"===a.labeledBy?a.relativeHeading+d:a.relativeHeading,a}),i.sort(f);var m,n,o,s,t,u=i.length;for(n=0;u>n;n++)if(!("correct"in i[n]&&i[n].correct)){t=!1;var v=0;if("user"===i[n].labeledBy){for(s=c.length,o=0;s>o;o++)if(i[n].getLabelType()===c[o].getLabelType()&&(m=i[n].overlap(c[o]),m>v&&(v=m),"CurbRamp"===i[n].getLabelType()&&m>p.curbRampThreshold||"NoCurbRamp"===i[n].getLabelType()&&m>p.noCurbRampThreshold)){i[n].correct=!0,c[o].correct=!0,t=!0;break}if(!t)return void(q.hasMistake?h(i[n],v):(k(h,{label:i[n],overlap:v}),q.hasMistake=!0))}else{for(s=a.length,o=0;s>o;o++)if(i[n].getLabelType()===a[o].getLabelType()&&(m=i[n].overlap(a[o]),"CurbRamp"===i[n].getLabelType()&&m>p.curbRampThreshold||"NoCurbRamp"===i[n].getLabelType()&&m>p.noCurbRampThreshold)){i[n].correct=!0,a[o].correct=!0,t=!0;break}if(!t)return void(q.hasMistake?g(i[n]):(k(g,{label:i[n]}),q.hasMistake=!0))}}var w="<div style='height: 10px'></div>";if(q.hasMistake)var x="Great, you corrected all the mistakes! Please try to be as accurate as possible. Your labels will be used to make our cities better and more accessible.Now, let's move on to the next task. <br/>"+w+r;else var x="Fantastic! You labeled everything correctly! Let's move on to the next task. <br />"+w+r;var y=0,z=320,A=700,B=null;return svw.messageBox.setMessage(x).setPosition(y,z,A,B,!0).show(),void b("#GoldenInsertionOkButton").bind("click",e)}}function j(){l.clear();var a=q.currentLabel.getBoundingBox(),b=a.x+a.width+50,c=a.y+a.height/2+60;svw.messageBox.setMessage(q.boxMessage).setPosition(b,c).show(),l.renderArrow(b,a.y+a.height/2+10,b-25,a.y+a.height/2,{arrowWidth:3})}function k(a,c){if(!c)return!1;if(!("label"in c&&c.label))return!1;var d="<div style='height: 10px'></div>",e='<img src="public/img/icons/Icon_WarningSign.svg" class="MessageBoxIcons" style="height:30px; width:30px; top:6px;"/> Uh oh, looks like there is a problem with your labels. Let\'s see if we can fix this. <br />'+d+r,f=0,g=320,h=720,i=null;svw.messageBox.setMessage(e).setPosition(f,g,h,i,!0).show(),b("#GoldenInsertionOkButton").bind("click",function(){svw.messageBox.hide(),"overlap"in c?a(c.label,c.overlap):a(c.label)})}var l,m,n,o={className:"GoldenInsertion"},p={cameraMovementDuration:500,curbRampThreshold:.35,goldenLabelVisibility:"hidden",noCurbRampThreshold:.1},q={boxMessage:"",currentLabel:void 0,hasMistake:!1,revisingLabels:!1},r='<button id="GoldenInsertionOkButton" class="button" style="">OK</button>';return o.disableOkButton=function(){b("#GoldenInsertionOkButton").unbind("click"),b("#GoldenInsertionOkButton").css("opacity",.7)},o.getGoldenLabelVisibility=function(){return p.goldenLabelVisibility},o.isRevisingLabels=function(){return q.revisingLabels},o.renderMessage=function(){q.currentLabel&&""!==q.boxMessage&&j()},o.reviewLabels=function(){return q.revisingLabels=!0,i()},c(a),o}function Keyboard(a){function b(){h=a("#CommentField").length>0?a("#CommentField"):null,i=a("#task-difficulty-comment").length>0?a("#task-difficulty-comment"):null,j=a("#Text_BusStopAbsenceOtherReason").length>0?a("#Text_BusStopAbsenceOtherReason"):null,h&&(h.bind("focus",g),h.bind("blur",f)),i&&(i.bind("focus",g),i.bind("blur",f)),j&&(j.bind("focus",g),j.bind("blur",f)),a(document).bind("keyup",d),a(document).bind("keydown",c),a(document).bind("mouseup",e)}function c(a){if(!l.focusOnTextField)switch("tracker"in svw&&svw.tracker.push("KeyDown",{keyCode:a.keyCode}),a.keyCode){case 16:l.shiftDown=!0}}function d(a){if(!l.focusOnTextField)switch("tracker"in svw&&svw.tracker.push("KeyUp",{keyCode:a.keyCode}),a.keyCode){case 16:l.shiftDown=!1;break;case 27:svw.canvas.cancelDrawing();break;case 67:svw.ribbon.modeSwitchClick("CurbRamp");break;case 69:svw.ribbon.modeSwitchClick("Walk");break;case 77:svw.ribbon.modeSwitchClick("NoCurbRamp");break;case 90:l.shiftDown?"zoomControl"in svw&&svw.zoomControl.zoomOut():"zoomControl"in svw&&svw.zoomControl.zoomIn()}}function e(a){var b;a=a||window.event,"which"in a?b=3==a.which:"button"in a&&(b=2==a.button),b&&k.clearShiftDown()}function f(){l.focusOnTextField=!1}function g(){l.focusOnTextField=!0}var h,i,j,k={className:"Keyboard"},l={focusOnTextField:!1,shiftDown:!1};return k.clearShiftDown=function(){return l.shiftDown=!1,this},k.getStatus=function(a){return a in l||console.warn("You have passed an invalid key for status."),l[a]},k.isShiftDown=function(){return l.shiftDown},k.setStatus=function(a,b){return a in l&&(l[a]=b),this},b(),k}function Label(a,b){function c(a,b){try{if(!b){var c='The passed "path" is empty.';throw c}g=b;for(attrName in h)if("tagHeight"!==attrName&&"tagWidth"!==attrName&&"tagX"!==attrName&&"tagY"!==attrName&&"labelerId"!==attrName&&"photographerPov"!==attrName&&"photographerHeading"!==attrName&&"photographerPitch"!==attrName||a[attrName]){if(!(attrName in a)){var c='"'+attrName+'" is not in the passed parameter.';throw c}h[attrName]=a[attrName]}return g.setBelongsTo(f),!0}catch(d){return console.error(f.className,":","Error initializing the Label object.",d),!1}}function d(a){if(3!==arguments.length)return!1;var b=g.getBoundingBox(),c=h.labelDescription,d=c.split("\n");"DefaultValue"!==h.labelerId&&d.push("Labeler: "+h.labelerId),a.font="10.5pt Calibri";for(var e=h.tagHeight*d.length,f=-1,i=0;i<d.length;i+=1){var j=a.measureText(d[i]).width+5;j>f&&(f=j)}h.tagWidth=f;var k,l;a.save(),a.lineWidth=3.5,a.fillStyle="rgba(255,255,255,1)",a.strokeStyle="rgba(255,255,255,1)",a.beginPath();var m=15;m>b.width&&(m=b.width-1),k=b.x<5?5:b.x,b.y+b.height<400?(a.moveTo(k+m,b.y+b.height),a.lineTo(k+m,b.y+b.height+10),a.stroke(),a.closePath(),a.restore(),l=b.y+b.height+10):(a.moveTo(k+m,b.y),a.lineTo(k+m,b.y-10),a.stroke(),a.closePath(),a.restore(),l=b.y-e-20);var n=16,o=30,p=10;a.save(),a.lineCap="square",a.lineWidth=2,a.fillStyle="rgba(255, 255, 255, 0.9)",a.strokeStyle="rgba(255,255,255,1)",a.beginPath(),a.moveTo(k,l),a.lineTo(k+f+n+o,l),a.lineTo(k+f+n+o,l+e+p),a.lineTo(k,l+e+p),a.lineTo(k,l),a.fill(),a.stroke(),a.closePath(),a.restore(),a.save(),a.fillStyle="#000";var q,r,s,t,u,v=h.labelType,w=getLabelIconImagePath()[v].iconImagePath;q=new Image,r=s=25,t=k+5,u=l+2,q.src=w,a.drawImage(q,t,u,r,s);for(var i=0;i<d.length;i+=1)a.fillText(d[i],k+n+20,l+20+20*i);a.restore()}function e(){if("hidden"!==i.tagVisibility){var a=g.getBoundingBox(),b=a.x+a.width-20,c=a.y,d=$("#Holder_LabelDeleteIcon");d.css({visibility:"visible",left:b,top:c})}}var f={className:"Label"},g=void 0,h={canvasWidth:void 0,canvasHeight:void 0,canvasDistortionAlphaX:void 0,canvasDistortionAlphaY:void 0,labelerId:"DefaultValue",labelId:"DefaultValue",labelType:void 0,labelDescription:void 0,labelFillStyle:void 0,panoId:void 0,panoramaLat:void 0,panoramaLng:void 0,panoramaHeading:void 0,panoramaPitch:void 0,panoramaZoom:void 0,photographerHeading:void 0,photographerPitch:void 0,svImageWidth:void 0,svImageHeight:void 0,svMode:void 0,tagHeight:20,tagWidth:1,tagX:-1,tagY:-1},i={deleted:!1,tagVisibility:"visible",visibility:"visible"},j={tagVisibility:!1,visibility:!1};return f.blink=function(a,b){a?0>a&&(a=0):a=3;var c,d,e=!0,g=f.getPath(),h=g.getPoints(),i=h.length,j="rgba(200,200,200,0.1)",k=g.getFillStyle();return c=setInterval(function(){if(a>0)if(e){for(e=!1,g.setFillStyle(j),d=0;i>d;d++)h[d].setFillStyle(j);svw.canvas.clear().render2()}else{for(e=!0,g.setFillStyle(k),d=0;i>d;d++)h[d].setFillStyle(k);svw.canvas.clear().render2(),a-=1}else{if(b){for(g.setFillStyle(j),d=0;i>d;d++)h[d].setFillStyle(j);svw.canvas.clear().render2()}f.setAlpha(.05),svw.canvas.clear().render2(),window.clearInterval(c)}},500),this},f.fadeFillStyle=function(a){var b=f.getPath(),c=b.getPoints(),d=0,e=c.length,g=void 0;for(a||(a="default"),g="gray"===a?"rgba(200,200,200,0.5)":"rgba(255,165,0,0.8)",b.setFillStyle(g);e>d;d++)c[d].setFillStyle(g);return this},f.getBoundingBox=function(a){var b=f.getPath();return b.getBoundingBox(a)},f.getCoordinate=function(){if(g&&g.points.length>0){var a=g.getPOV();return $.extend(!0,{},g.points[0].getCanvasCoordinate(a))}return g},f.getGSVImageCoordinate=function(){return g&&g.points.length>0?g.points[0].getGSVImageCoordinate():void 0},f.getImageCoordinates=function(){return g?g.getImageCoordinates():!1},f.getLabelId=function(){return h.labelId},f.getLabelType=function(){return h.labelType},f.getPath=function(a){return g?a?g:$.extend(!0,{},g):!1},f.getPoint=function(){return g&&g.points.length>0?g.points[0]:g},f.getPoints=function(a){return g?g.getPoints(a):!1},f.getLabelPov=function(){var a,b=parseInt(h.panoramaPitch,10),c=parseInt(h.panoramaZoom,10),d=f.getPoints(),e=d.map(function(a){return a.svImageCoordinate.x});if(e.max()-e.min()>svw.svImageWidth/2){e=e.map(function(a){return a<svw.svImageWidth/2&&(a+=svw.svImageWidth),a});var g=parseInt(e.mean(),10)%svw.svImageWidth}else var g=parseInt(e.mean(),10);return a=parseInt(g/svw.svImageWidth*360,10)%360,{heading:parseInt(a,10),pitch:b,zoom:c}},f.getProperties=function(){return $.extend(!0,{},h)},f.getProperty=function(a){return a in h?h[a]:!1},f.getstatus=function(a){return i[a]},f.getVisibility=function(){return i.visibility},f.fill=function(a){var b=f.getPath(),c=b.getPoints(),d=0,e=c.length;for(b.setFillStyle(a);e>d;d++)c[d].setFillStyle(a);return this},f.highlight=function(){var a="rgba(255,165,0,0.8)";return f.fill(a)},f.isDeleted=function(){return i.deleted},f.isOn=function(a,b){if(i.deleted||"hidden"===i.visibility)return!1;var c=g.isOn(a,b);return c?c:!1},f.isVisible=function(){return"visible"===i.visibility?!0:!1},f.lockTagVisibility=function(){return j.tagVisibility=!0,this},f.lockVisibility=function(){return j.visibility=!0,this},f.overlap=function(a,b){if(b||(b="boundingbox"),"boundingbox"!==b)throw f.className+": "+mobede+" is not a valid option.";var c=f.getPath(),d=a.getPath();return c.overlap(d,b)},f.removePath=function(){g.removePoints(),g=void 0},f.render=function(a,b,c){if(c||(c=!1),!i.deleted&&"visible"===i.visibility){if("visible"===i.tagVisibility){h.labelDescription;c||(d(a),g.renderBoundingBox(a),e())}g.render2(a,b)}return this},f.resetFillStyle=function(){var a=f.getPath(),b=a.getPoints(),c=0,d=b.length;for(a.resetFillStyle();d>c;c++)b[c].resetFillStyle();return this},f.resetTagCoordinate=function(){return h.tagX=0,h.tagY=0,this},f.setAlpha=function(a){var b=f.getPath(),c=b.getPoints(),d=0,e=c.length,g=b.getFillStyle();for(g=svw.util.color.changeAlphaRGBA(g,.3),b.setFillStyle(g);e>d;d++)c[d].setFillStyle(g);return this},f.setIconPath=function(a){if(g&&g.points[0]){var b=g.points[0];return b.setIconPath(a),this}return!1},f.setLabelerId=function(a){return h.labelerId=a,this},f.setStatus=function(a,b){a in i&&("visibility"!==a||"visible"!==b&&"hidden"!==b?"tagVisibility"!==a||"visible"!==b&&"hidden"!==b?"deleted"===a&&"boolean"==typeof b&&(i[a]=b):f.setTagVisibility(b):f.setVisibility(b))},f.setTagVisibility=function(a){return j.tagVisibility||("visible"===a||"hidden"===a)&&(i.tagVisibility=a),this},f.setSubLabelDescription=function(a){var b=getLabelDescriptions(),c=b[a].text;return h.labelProperties.subLabelDescription=c,this},f.setVisibility=function(a){return j.visibility||(i.visibility=a),this},f.setVisibilityBasedOnLocation=function(a,b){return i.deleted||(b===h.panoId?f.setVisibility(a):(a="visible"===a?"hidden":"visible",f.setVisibility(a))),this},f.setVisibilityBasedOnLabelerId=function(a,b,c){return void 0===c?-1!==b.indexOf(h.labelerId)?f.unlockVisibility().setVisibility(a).lockVisibility():(a="visible"===a?"hidden":"visible",f.unlockVisibility().setVisibility(a).lockVisibility()):c?-1!==b.indexOf(h.labelerId)&&f.unlockVisibility().setVisibility(a).lockVisibility():-1===b.indexOf(h.labelerId)&&f.unlockVisibility().setVisibility(a).lockVisibility(),this},f.setVisibilityBasedOnLabelerIdAndLabelTypes=function(a,b,c){var d,e=b.length,g=!1;for(d=0;e>d;d+=1)-1!==b[d].userIds.indexOf(h.labelerId)&&-1!==b[d].labelTypesToRender.indexOf(h.labelProperties.labelType)&&(g=!0);void 0===c?g?f.unlockVisibility().setVisibility(a).lockVisibility():(a="visible"===a?"hidden":"visible",f.unlockVisibility().setVisibility(a).lockVisibility()):c?g&&f.unlockVisibility().setVisibility(a).lockVisibility():g||f.unlockVisibility().setVisibility(a).lockVisibility()},f.unlockTagVisibility=function(){return j.tagVisibility=!1,this},f.unlockVisibility=function(){return j.visibility=!1,this},f.runTestCases=function(){module("Label tests"),test("functioning",function(){ok(!0,"Test")})},c(b,a)?f:!1}function LabeledLandmarkFeedback(a,b){function c(a){svw.ui&&svw.ui.ribbonMenu&&(d=svw.ui.labeledLandmark.curbRamp,e=svw.ui.labeledLandmark.noCurbRamp,f=svw.ui.labeledLandmark.submitted,d.html(0),e.html(0))}var d,e,f,g={className:"LabeledLandmarkFeedback"};return g.setLabelCount=function(a){return svw.ui&&svw.ui.ribbonMenu&&(d.html(a.CurbRamp),e.html(a.NoCurbRamp)),this},g.setSubmittedLabelMessage=function(a){if(!a)return this;if(svw.ui&&svw.ui.ribbonMenu)if("message"in a)f.html(b);else if("numCurbRampLabels"in a&&"numMissingCurbRampLabels"in a){var b="You've submitted <b>"+a.numCurbRampLabels+"</b> curb ramp labels and <br /><b>"+a.numMissingCurbRampLabels+"</b> missing curb ramp labels.";f.html(b)}return this},c(b),g}function Main(a,b){function c(b){b=b||{},svw.ui=new UI(a),svw.tracker=new Tracker,svw.keyboard=new Keyboard(a),svw.canvas=new Canvas(a),svw.form=new Form(a,b.form),svw.examples=void 0,svw.overlayMessageBox=new OverlayMessageBox(a),svw.missionDescription=new MissionDescription(a,b.missionDescription),svw.labeledLandmarkFeedback=new LabeledLandmarkFeedback(a),svw.qualificationBadges=void 0,svw.progressFeedback=new ProgressFeedback(a),svw.actionStack=new ActionStack(a),svw.ribbon=new RibbonMenu(a),svw.messageBox=new MessageBox(a),svw.zoomControl=new ZoomControl(a),svw.tooltip=void 0,svw.onboarding=void 0,svw.progressPov=new ProgressPov(a),svw.form.disableSubmit(),svw.tracker.push("TaskStart");var c={};c.canvas=svw.canvas,c.overlayMessageBox=svw.overlayMessageBox;var d,e,f,g="_AUz5cV_ofocoDbesxY3Kw",h=[],i=-1,j=-1,k=-1,l=!1;i=1,j=1,k=i-j,f=k/i,svw.form.setTaskRemaining(j),svw.form.setTaskDescription("TestTask"),svw.form.setTaskPanoramaId(g),d=parseFloat(38.894799),e=parseFloat(-77.021906),f=parseFloat(f),c.Lat=d,c.Lng=e,c.panoramaPov={heading:0,pitch:-10,zoom:1},c.taskPanoId=g,h=[c.taskPanoId],c.availablePanoIds=h,svw.missionDescription.setCurrentStatusDescription('Your mission is to <span class="bold">find and label</span> presence and absence of curb ramps at intersections.'),svw.progressFeedback.setProgress(f),svw.progressFeedback.setMessage("You have finished "+(i-j)+" out of "+i+"."),l?(svw.messageBox.setPosition(10,120,width=400,height=void 0,background=!0),svw.messageBox.setMessage("<span class='bold'>Remember, label all the landmarks close to the bus stop.</span> Now the actual task begins. Click OK to start the task."),svw.messageBox.appendOKButton(),svw.messageBox.show()):svw.messageBox.hide(),svw.map=new Map(c),svw.map.setStatus("hideNonavailablePanoLinks",!0)}var d={moduleName:"MainUI"};return c(b),d}function getPanoId(){if(svw.panorama){var a=svw.panorama.getPano();return a}throw"getPanoId() (in Map.js): panorama not defined."}function getPosition(){if(!svw.panorama)throw"getPosition() (in Map.js): panorama not defined.";var a=svw.panorama.getPosition();if(a){var b={lat:a.lat(),lng:a.lng()};return b}}function getPOV(){if(svw.panorama){for(var a=svw.panorama.getPov();a.heading<0;)a.heading+=360;for(;a.heading>360;)a.heading-=360;return a}throw"getPOV() (in Map.js): panoarama not defined."}function getLinks(){if(svw.panorama){var a=svw.panorama.getLinks();return a}throw"getLinks() (in Map.js): panorama not defined."}function Map(a){function b(a){if(I.properties=N,N.browser=getBrowser(),v=a.overlayMessageBox,!a.taskPanoId)throw a.Lat&&a.Lng?(x=new google.maps.LatLng(a.Lat,a.Lng),w={mode:"html4",position:x,pov:N.panoramaPov},I.className+" init(): Specifying a dropping point with a latlng coordinate is no longer a good idea. It does not drop the pegman on the specified position."):I.className+" init(): The pano id nor panorama position is give. Cannot initialize the panorama.";w={mode:"html4",pov:N.panoramaPov,pano:a.taskPanoId};var b=document.getElementById("pano");svw.panorama=new google.maps.StreetViewPanorama(b,w),svw.panorama.set("addressControl",!1),svw.panorama.set("clickToGo",!1),svw.panorama.set("disableDefaultUI",!0),svw.panorama.set("linksControl",!0),svw.panorama.set("navigationControl",!1),svw.panorama.set("panControl",!1),svw.panorama.set("zoomControl",!1),N.initialPanoId=a.taskPanoId,B=svw.ui.map.canvas,C=svw.ui.map.drawingLayer,D=svw.ui.map.pano,E=svw.ui.map.streetViewHolder,F=svw.ui.map.viewControlLayer,G=svw.ui.map.modeSwitchWalk,H=svw.ui.map.modeSwitchDraw,O.availablePanoIds=a.availablePanoIds,F.bind("mousedown",q),F.bind("mouseup",r),F.bind("mousemove",s),F.bind("mouseleave",t),google.maps.event.addListener(svw.panorama,"pov_changed",l),google.maps.event.addListener(svw.panorama,"position_changed",l),google.maps.event.addListener(svw.panorama,"pano_changed",o),y.setStreetView(svw.panorama),google.maps.event.addListenerOnce(svw.panorama,"pano_changed",I.modeSwitchWalkClick),S=setInterval(k,100),"onboarding"in svw&&svw.onboarding&&"Onboarding_LabelingCurbRampsDifficultScene"===svw.onboarding.className&&(Q.zoomViewAngles=[Math.PI/2,Math.PI/4,Math.PI/8]),Q.interval=setInterval(j,250),K=setInterval(c,.2),N.isInternetExplore=$.browser.msie,N.isInternetExplore&&F.append('<canvas width="720px" height="480px"  class="Window_StreetView" style=""></canvas>')}function c(){var a=$(".gmnoprint");a.length>0&&(window.clearInterval(K),$.each($(".gmnoprint"),function(a,b){var c=$(b).find("img");c&&c.css("visibility","hidden")}))}function d(){O.lockDisableWalking||(h(),G.css("opacity",.5),O.disableWalking=!0)}function e(){O.lockDisableWalking||(n(),G.css("opacity",1),O.disableWalking=!1)}function f(){var a=svw.getPOV();if(a){var b=a.heading,c=b*(Math.PI/180);svw.fog.updateFromPOV(current,radius,c,Math.PI/2)}}function g(){return D.find("svg").parent()}function h(){"chrome"===N.browser?$("path").css("visibility","hidden"):$("path").css("visibility","hidden")}function i(){var a=g();F.append(a),"mozilla"===N.browser?F.append(B):"msie"===N.browser&&F.insertBefore(C)}function j(){current&&(Q.center=current,Q.radius=200,current=svw.panorama.getPosition(),svw.fog=new Fog(y,Q),fogSet=!0,window.clearInterval(Q.interval),f())}function k(){var a=F.find("path").length;0!==a&&(O.svLinkArrowsLoaded=!0,window.clearTimeout(S)),O.svLinkArrowsLoaded||h()}function l(){if(svw.canvas){getPosition(),svw.getPOV().heading;svw.canvas.clear(),O.currentPanoId!==svw.getPanoId()&&svw.canvas.setVisibilityBasedOnLocation("visible",svw.getPanoId()),O.currentPanoId=svw.getPanoId(),"Evaluation"===N.mode&&myTables.updateCanvas(),svw.canvas.render2()}fogMode&&"fog"in svw&&(current=svw.panorama.getPosition(),current&&fogSet&&f()),$("svg")[0]&&(R||(R=!0,$("svg")[0].addEventListener("mousedown",function(a){n()})))}function m(a){switch(a){case"ZoomOut":F.css("cursor","url(img/cursors/Cursor_ZoomOut.png) 4 4, move");break;case"OpenHand":F.css("cursor","url(img/cursors/openhand.cur) 4 4, move");break;case"ClosedHand":F.css("cursor","url(img/cursors/closedhand.cur) 4 4, move");break;default:F.css("cursor","default")}}function n(a){if(!O.svLinkArrowsLoaded){var b=F.find("path").length;0===b?i():O.svLinkArrowsLoaded=!0}O.hideNonavailablePanoLinks&&O.availablePanoIds?$.each($("path"),function(a,b){if($(b).attr("pano")){var c=$(b).attr("pano"),d=O.availablePanoIds.indexOf(c);-1===d?($(b).prev().prev().remove(),$(b).prev().remove(),$(b).remove()):($(b).prev().prev().css("visibility","visible"),$(b).prev().css("visibility","visible"),$(b).css("visibility","visible"))}}):"chrome"===N.browser?$("path").css("visibility","visible"):(a||(a=0),$("path").css("visibility","hidden"))}function o(){if(!svw.panorama)throw I.className+" updateMap(): panorama not defined.";var a=svw.panorama.getPosition();y.setCenter(a),svw.canvas&&(svw.canvas.clear(),svw.canvas.setVisibilityBasedOnLocation("visible",svw.getPanoId()),"Evaluation"===N.mode&&myTables.updateCanvas(),svw.canvas.render2()),fogSet&&f()}function p(a,b){if(!svw.panorama)throw J+" updatePov(): panorama not defined!";var c=svw.panorama.getPov(),d=.25;c.heading-=d*a,c.pitch+=d*b,c.pitch>N.maxPitch?c.pitch=N.maxPitch:c.pitch<N.minPitch&&(c.pitch=N.minPitch),N.minHeading&&N.maxHeading&&(N.minHeading<=N.maxHeading?c.heading>N.maxHeading?c.heading=N.maxHeading:c.heading<N.minHeading&&(c.heading=N.minHeading):c.heading<N.minHeading&&c.heading>N.maxHeading&&(Math.abs(c.heading-N.maxHeading)<Math.abs(c.heading-N.minHeading)?c.heading=N.maxHeading:c.heading=N.minHeading)),N.panoramaPov=c,svw.panorama.setPov(c)}function q(a){if(P.isLeftDown=!0,P.leftDownX=mouseposition(a,this).x,P.leftDownY=mouseposition(a,this).y,!O.disableWalking)try{m(svw.keyboard.isShiftDown()?"ZoomOut":"ClosedHand")}catch(a){console.error(a)}if(!O.panoLinkListenerSet)try{$("svg")[0].addEventListener("click",function(a){var b=a.target.getAttribute("pano");b&&svw.tracker.push("WalkTowards",{TargetPanoId:b})}),O.panoLinkListenerSet=!0}catch(b){}svw.tracker.push("ViewControl_MouseDown",{x:P.leftDownX,y:P.leftDownY})}function r(a){var b;if(P.isLeftDown=!1,P.leftUpX=mouseposition(a,this).x,
P.leftUpY=mouseposition(a,this).y,svw.tracker.push("ViewControl_MouseUp",{x:P.leftUpX,y:P.leftUpY}),!O.disableWalking)try{m(svw.keyboard.isShiftDown()?"ZoomOut":"OpenHand")}catch(a){console.error(a)}b=(new Date).getTime(),b-P.prevMouseUpTime<300&&(svw.tracker.push("ViewControl_DoubleClick"),svw.keyboard.isShiftDown()?(svw.zoomControl.zoomOut(),svw.tracker.push("ViewControl_ZoomOut")):(svw.zoomControl.pointZoomIn(P.leftUpX,P.leftUpY),svw.tracker.push("ViewControl_ZoomIn"))),P.prevMouseUpTime=b}function s(a){if(P.currX=mouseposition(a,this).x,P.currY=mouseposition(a,this).y,O.disableWalking)m("default");else if(n(2e3),!P.isLeftDown)try{m(svw.keyboard.isShiftDown()?"ZoomOut":"OpenHand")}catch(a){console.error(a)}if(P.isLeftDown&&O.disableWalking===!1){var b=P.currX-P.prevX,c=P.currY-P.prevY,d=svw.getPOV(),e=d.zoom,f=svw.zoomFactor[e];b/=2*f,c/=2*f,b*=1.5,c*=1.5,p(b,c)}if("canvas"in svw&&svw.canvas){var g=svw.canvas.isOn(P.currX,P.currY);if(g&&"Point"===g.className){var h=g.belongsTo(),i=h.belongsTo();svw.canvas.setCurrentLabel(i),svw.canvas.showLabelTag(i),svw.canvas.clear(),svw.canvas.render2()}else if(g&&"Label"===g.className){var i=g;svw.canvas.setCurrentLabel(i),svw.canvas.showLabelTag(i)}else if(g&&"Path"===g.className){var j=g.belongsTo();svw.canvas.clear(),svw.canvas.render2(),svw.canvas.showLabelTag(j)}else svw.canvas.showLabelTag(void 0),svw.canvas.setCurrentLabel(void 0)}P.prevX=mouseposition(a,this).x,P.prevY=mouseposition(a,this).y}function t(a){P.isLeftDown=!1}var u,v,w,x,y,z,A,B,C,D,E,F,G,H,I={className:"Map"},J="Map",K=void 0,L={renderLabels:!1},M=[],N={browser:"unknown",latlng:{lat:void 0,lng:void 0},initialPanoId:void 0,panoramaPov:{heading:359,pitch:-10,zoom:1},maxPitch:0,minPitch:-35,minHeading:void 0,maxHeading:void 0,mode:"Labeling",isInternetExplore:void 0},O={availablePanoIds:void 0,currentPanoId:void 0,disableWalking:!1,hideNonavailablePanoLinks:!1,lockDisableWalking:!1,panoLinkListenerSet:!1,svLinkArrowsLoaded:!1},P={currX:0,currY:0,prevX:0,prevY:0,leftDownX:0,leftDownY:0,leftUpX:0,leftUpY:0,isLeftDown:!1},Q={interval:void 0,ready:void 0},R=!1,S=void 0;if(a.panoramaPov?N.panoramaPov=a.panoramaPov:N.panoramaPov={heading:0,pitch:0,zoom:1},a.latlng)N.latlng=a.latlng;else{if(!("Lat"in a&&"Lng"in a))throw I.className+": latlng not defined.";N.latlng={lat:a.Lat,lng:a.Lng}}x=new google.maps.LatLng(N.latlng.lat,N.latlng.lng),z={center:x,mapTypeControl:!1,mapTypeId:google.maps.MapTypeId.ROADMAP,maxZoom:20,minZoom:14,overviewMapControl:!1,panControl:!1,rotateControl:!1,scaleControl:!1,streetViewControl:!0,zoomControl:!1,zoom:18};var T=document.getElementById("google-maps");return y=new google.maps.Map(T,z),A=[{featureType:"all",stylers:[{visibility:"off"}]},{featureType:"road",stylers:[{visibility:"on"}]},{elementType:"labels",stylers:[{visibility:"off"}]}],y.setOptions({styles:A}),I.disableWalking=function(){return O.lockDisableWalking?!1:(d(),this)},I.enableWalking=function(){return O.lockDisableWalking?!1:(e(),this)},I.getInitialPanoId=function(){return N.initialPanoId},I.getMaxPitch=function(){return N.maxPitch},I.getMinPitch=function(){return N.minPitch},I.getProperty=function(a){return a in N?N[a]:!1},I.hideLinks=function(){return h(),this},I.lockDisableWalking=function(){return O.lockDisableWalking=!0,this},I.lockRenderLabels=function(){return L.renderLabels=!0,this},I.modeSwitchWalkClick=function(){F.css("z-index","1"),C.css("z-index","0"),O.disableWalking||(n(),i())},I.modeSwitchLabelClick=function(){C.css("z-index","1"),F.css("z-index","0"),"mozilla"===N.browser&&C.append(B),h()},I.plotMarkers=function(){if(u){var a=void 0,b=0,c=void 0,d=void 0,e=void 0;a=u.getLabels(),b=a.length;for(var f=0;f<M.length;f+=1)M[f].setMap(null);for(M=[],f=0;b>f;f++)if(c=a[f].getProperties(),d=c.labelProperties.labelType,e=c.panoramaProperties.latlng,-1===c.labelerId.indexOf("Researcher")){var g=new google.maps.LatLng(e.lat,e.lng),h=new google.maps.Marker({position:g,map:y,zIndex:f});M.push(h)}}return!1},I.setHeadingRange=function(a){return N.minHeading=a[0],N.maxHeading=a[1],this},I.setMode=function(a){return N.mode=a,this},I.setPitchRange=function(a){return N.minPitch=a[0],N.maxPitch=a[1],this},I.setPov=function(a,b,c){if("panorama"in svw&&svw.panorama){var d,e=svw.panorama.getPov();if(a.heading=parseInt(a.heading,10),a.pitch=parseInt(a.pitch,10),a.zoom=parseInt(a.zoom,10),a.pitch>N.maxPitch?a.pitch=N.maxPitch:a.pitch<N.minPitch&&(a.pitch=N.minPitch),N.minHeading&&N.maxHeading&&(N.minHeading<=N.maxHeading?a.heading>N.maxHeading?a.heading=N.maxHeading:a.heading<N.minHeading&&(a.heading=N.minHeading):a.heading<N.minHeading&&a.heading>N.maxHeading&&(Math.abs(a.heading-N.maxHeading)<Math.abs(a.heading-N.minHeading)?a.heading=N.maxHeading:a.heading=N.minHeading)),b){var f,g=25,h=(a.heading-e.heading+360)%360,i=360-h;f=i>h?h*(g/b):-i*(g/b);var j,k=a.pitch-e.pitch;j=k*(g/b),d=window.setInterval(function(){var b=a.heading-e.heading;Math.abs(b)>1?(e.heading+=f,e.pitch+=j,e.heading=(e.heading+360)%360,e.pitch=e.pitch,svw.panorama.setPov(e)):(a.zoom||(a.zoom=1),svw.panorama.setZoom(a.zoom),window.clearInterval(d),c&&c())},g)}else svw.panorama.setPov(a)}return this},I.setStatus=function(a,b){if(a in O){if("disableWalking"===a){if("boolean"!=typeof b)return!1;b?d():e()}else O[a]=b;return this}return!1},I.unlockDisableWalking=function(){return O.lockDisableWalking=!1,this},I.unlockRenderLabels=function(){return L.renderLabels=!1,this},I.test=function(){u.testCases.renderLabels()},b(a),I}function MessageBox(a,b){function c(){d=a("#Holder_Message"),e=a("#MessageBox")}var d,e,f={className:"MessageBox"},g='<button id="MessageBoxOkButton" class="button" style="position: absolute; bottom: 10px; left: 10px;">OK</button>';return f.setMessage=function(a){return e.html(a),this},f.setPosition=function(a,b,c,f,g){return a&&"number"==typeof a&&(a+="px"),b&&"number"==typeof b&&(b+="px"),c?"number"==typeof c&&(c+="px"):c="240px",f&&"number"==typeof f&&(f+="px"),g||(g=!1),g?(d.css({height:"100%",left:"0px",top:"0px",visibility:"visible",width:"100%",zIndex:1e3}),e.css({left:a,top:b,width:c,zIndex:1e3}),f&&e.css("height",f)):(d.css({height:"1px",left:a,top:b,width:"1px",zIndex:1e3}),e.css({left:"0px",top:"0px",width:c}),f&&e.css("height",f)),this},f.appendOKButton=function(b){e.css("padding-bottom","50px"),e.append(g),a("#MessageBoxOkButton").on("click",function(){"tracker"in svw&&svw.tracker&&(b?svw.tracker.push("MessageBox_ClickOk",{message:b}):svw.tracker.push("MessageBox_ClickOk")),d.css({visibility:"hidden"}),e.css({"padding-bottom":"",visibility:"hidden"}),a("#MessageBoxOkButton").remove()})},f.hide=function(){return e.css("visibility","hidden"),d.css("visibility","hidden"),this},f.show=function(a){return a||(a=!1),e.css("visibility","visible"),a&&d.css("visibility","visible"),this},c(),f}function MissionDescription(a,b){function c(a){svw.ui&&svw.ui.missinDescription&&(d=svw.ui.missinDescription.description,d.html(a.description))}var d,e={className:"MissionDescription"};return e.setCurrentStatusDescription=function(a){return svw.ui&&svw.ui.missinDescription&&d.html(a),this},c(b),e}function OverlayMessageBox(a,b){function c(){svw.ui&&svw.ui.overlayMessage&&(d=svw.ui.overlayMessage.message,e=svw.ui.overlayMessage.box,f.setMessage("Walk"))}var d,e,f={className:"OverlayMessageBox"},g={visibility:"visible"};return f.setMessage=function(a,b){var c=svw.misc.getLabelInstructions(),f=svw.misc.getLabelColors();if(a in c&&a in f){var g=f[a],h=changeAlphaRGBA(g.fillStyle,.85);return h=changeDarknessRGBA(h,.35),e.css({background:h}),d.css({color:c[a].textColor}),b?d.html(b):d.html("<strong>"+c[a].instructionalText+"</strong>"),this}return!1},f.setVisibility=function(a){return("visible"===a||"hidden"===a)&&(g.visibility=a),this},c(),f}function Path(a,b){function c(a,b){var c,d;for(m.points=a,c=a.length,d=0;c>d;d+=1)a[d].setBelongsTo(m);if(b)for(var e in b)e in n&&(n[e]=b[e]);n.fillStyle=changeAlphaRGBA(a[0].getProperty("fillStyleInnerCircle"),.5),n.originalFillStyle=n.fillStyle,n.originalStrokeStyle=n.strokeStyle}function d(){return n.lineWidth}function e(){return n.fillStyle}function f(a){n.fillStyle=a}function g(a){var b,c,d,e=a?a:getPOV(),f=-1,g=1e6,h=-1,j=1e6;for(d=i(e),c=d.length,b=0;c>b;b+=1){var k=d[b];k.x<g&&(g=k.x),k.x>f&&(f=k.x),k.y<j&&(j=k.y),k.y>h&&(h=k.y)}return{x:g,y:j,width:f-g,height:h-j}}function h(){var a,b,c=j(),d=c.length,e=-1,f=1e6,g=-1e6,h=1e6,i=!1;for(a=0;d>a;a++)b=c[a],b.x<f&&(f=b.x),b.x>e&&(e=b.x),b.y<h&&(h=b.y),b.y>g&&(g=b.y);if(e-f>5e3)for(i=!0,e=-1,f=1e6,a=0;d>a;a++)b=c[a],b.x>6e3?b.x<f&&(f=b.x):b.x>e&&(e=b.x);return i?{x:f,y:h,width:svw.svImageWidth-f+e,height:g-h,boundary:!0}:{x:f,y:h,width:e-f,height:g-h,boundary:!1}}function i(a){var b,c,d=j(),e=d.length,f=[],g=1e7,h=-1;for(b=0;e>b;b+=1)g>d[b].x&&(g=d[b].x),h<d[b].x&&(h=d[b].x);var i=3328;for(b=0;e>b;b+=1)a.heading<180?h>svw.svImageWidth-i&&d[b].x>i&&(d[b].x-=svw.svImageWidth):i>g&&d[b].x<svw.svImageWidth-i&&(d[b].x+=svw.svImageWidth),c=svw.gsvImageCoordinate2CanvasCoordinate(d[b].x,d[b].y,a),f.push(c);return f}function j(){var a,b=m.points.length,c=[];for(a=0;b>a;a+=1)c.push(m.points[a].getGSVImageCoordinate());return c}function k(a){var b=g();a.save(),a.lineWidth=2,a.strokeStyle="rgba(255,255,255,1)",a.beginPath(),a.moveTo(b.x,b.y),a.lineTo(b.x+b.width,b.y),a.lineTo(b.x+b.width,b.y+b.height),a.lineTo(b.x,b.y+b.height),a.lineTo(b.x,b.y),a.stroke(),a.closePath(),a.restore()}var l,m={className:"Path",points:void 0},n={fillStyle:"rgba(255,255,255,0.5)",lineCap:"round",lineJoin:"round",lineWidth:"3",numPoints:a.length,originalFillStyle:void 0,originalStrokeStyle:void 0,strokeStyle:"rgba(255,255,255,1)",strokeStyle_bg:"rgba(255,255,255,1)"},o={visibility:"visible"};return m.belongsTo=function(){return l?l:!1},m.getPOV=function(){return a[0].getPOV()},m.getBoundingBox=function(a){return g(a)},m.getLineWidth=function(){return d()},m.getFill=function(){return e()},m.getFillStyle=function(){return n.fillStyle},m.getSvImageBoundingBox=function(){return h()},m.getImageCoordinates=function(){return j()},m.getPoints=function(a){return a||(a=!1),a?m.points:$.extend(!0,[],m.points)},m.isOn=function(a,b){var c,d,e,f,h;for(f=m.points.length,d=0;f>d;d+=1)if(e=m.points[d],h=e.isOn(a,b))return h;return c=g(),c.x<a&&c.x+c.width>a&&c.y<b&&c.y+c.height>b?this:!1},m.overlap=function(a,b){b||(b="boundingbox");var c=0;if("boundingbox"===b){var d,e,f=h(),g=a.getSvImageBoundingBox();f.boundary&&g.boundary||(f.boundary?(f.x=f.x-svw.svImageWidth,g.x>6e3&&(g.x=g.x-svw.svImageWidth)):g.boundary&&(g.x=g.x-svw.svImageWidth,f.x>6e3&&(f.x=f.x-svw.svImageWidth))),d=f.x<g.x?f.x:g.x,e=f.y<g.y?f.y:g.y,f.x-=d,g.x-=d,f.y-=e,g.y-=e;var i=f.x,j=f.x+f.width,k=f.y,l=f.y+f.height,m=g.x,n=g.x+g.width,o=g.y,p=g.y+g.height,q=0,r=0,s=n>j?n:j,t=p>l?p:l,u=0,v=0,w=!1,x=!1;for(q=0;s>q;q++)for(r=0;t>r;r++)w=q>i&&j>q&&r>k&&l>r,x=q>m&&n>q&&r>o&&p>r,w&&x&&(v+=1),(w||x)&&(u+=1);c=v/u}return c},m.removePoints=function(){m.points=void 0},m.render2=function(a,b){return m.render(b,a)},m.render=function(a,b){if("visible"===o.visibility){var c,d,e;c=m.points.length;var f=i(a);for(d=m.points[0],b.save(),b.beginPath(),n.fillStyle?b.fillStyle=n.fillStyle:(n.fillStyle=changeAlphaRGBA(d.getProperty("fillStyleInnerCircle"),.5),n.originalFillStyle=n.fillStyle,b.fillStyle=n.fillStyle),b.moveTo(f[0].x,f[0].y),e=1;c>e;e+=1)b.lineTo(f[e].x,f[e].y);for(b.lineTo(f[0].x,f[0].y),b.fill(),b.closePath(),b.restore(),e=0;c>e;e+=1)d=m.points[e],d.render(a,b);for(e=0;c>e;e+=1){if(e>0)var g=f[e],h=f[e-1];else var g=f[e],h=f[c-1];var j=d.getProperty("radiusInnerCircle");b.save(),b.strokeStyle=n.strokeStyle,svw.util.shape.lineWithRoundHead(b,h.x,h.y,j,g.x,g.y,j),b.restore()}}},m.renderBoundingBox=function(a){k(a)},m.resetFillStyle=function(){return n.fillStyle=n.originalFillStyle,this},m.resetStrokeStyle=function(){return n.strokeStyle=n.originalStrokeStyle,this},m.setFill=function(a){return f("rgba"==a.substring(0,4)?a:"rgba"+a.substring(3,a.length-1)+",0.5)"),this},m.setBelongsTo=function(a){return l=a,this},m.setLineWidth=function(a){return isNaN(a)||(n.lineWidth=""+a),this},m.setFillStyle=function(a){return void 0!=a&&(n.fillStyle=a),this},m.setStrokeStyle=function(a){return n.strokeStyle=a,this},m.setVisibility=function(a){return("visible"===a||"hidden"===a)&&(o.visibility=a),this},c(a,b),m}function Point(a,b,c,d){"use strict";function e(a,b,c,d){var e=c.zoom,f=svw.zoomFactor[e],g=svw.svImageHeight,h=svw.svImageWidth;k.svImageCoordinate={},k.svImageCoordinate.x=h*c.heading/360+svw.alpha_x*(a-svw.canvasWidth/2)/f,k.svImageCoordinate.y=g/2*c.pitch/90+svw.alpha_y*(b-svw.canvasHeight/2)/f,k.svImageCoordinate.x<0&&(k.svImageCoordinate.x=k.svImageCoordinate.x+h),k.canvasCoordinate={x:a,y:b},k.originalCanvasCoordinate={x:a,y:b},k.pov={heading:c.heading,pitch:c.pitch,zoom:c.zoom},k.originalPov={heading:c.heading,pitch:c.pitch,zoom:c.zoom};for(var i in m){if("iconImagePath"===i){if(!d.iconImagePath)continue;m.iconImagePath=d.iconImagePath}i in d?m[i]=d[i]:-1===n.indexOf(i)}return m.originalFillStyleInnerCircle=m.fillStyleInnerCircle,m.originalStrokeStyleOuterCircle=m.strokeStyleOuterCircle,!0}function f(){return!0}function g(){return k.canvasCoordinate.x}function h(){return k.canvasCoordinate.y}function i(){return m.fillStyleInnerCircle}function j(){return c}void 0==d.fillStyle&&(d.fillStyle="rgba(255,255,255,0.5)");var k={className:"Point",svImageCoordinate:void 0,canvasCoordinate:void 0,originalCanvasCoordinate:void 0,pov:void 0,originalPov:void 0},l=void 0,m={fillStyleInnerCircle:d.fillStyle,lineWidthOuterCircle:2,iconImagePath:void 0,originalFillStyleInnerCircle:void 0,originalStrokeStyleOuterCircle:void 0,radiusInnerCircle:4,radiusOuterCircle:5,strokeStyleOuterCircle:"rgba(255,255,255,1)",storedInDatabase:!1},n=["originalFillStyleInnerCircle","originalStrokeStyleOuterCircle"],o={deleted:!1,visibility:"visible",visibilityIcon:"visible"};k.belongsTo=function(){return l?l:!1},k.getPOV=function(){return j()},k.getCanvasCoordinate=function(a){return k.canvasCoordinate=svw.gsvImageCoordinate2CanvasCoordinate(k.svImageCoordinate.x,k.svImageCoordinate.y,a),svw.gsvImageCoordinate2CanvasCoordinate(k.svImageCoordinate.x,k.svImageCoordinate.y,a)},k.getCanvasX=g,k.getCanvasY=h,k.getFill=i,k.getFillStyle=function(){return i()},k.getGSVImageCoordinate=function(){return $.extend(!0,{},k.svImageCoordinate)},k.getProperty=function(a){if(!(a in m))throw k.className+' : A property name "'+a+'" does not exist in properties.';return m[a]},k.getProperties=function(){return $.extend(!0,{},m)},k.isOn=function(a,b){var c=m.radiusOuterCircle/2+3;return a<k.canvasCoordinate.x+c&&a>k.canvasCoordinate.x-c&&b<k.canvasCoordinate.y+c&&b>k.canvasCoordinate.y-c?this:!1},k.render=function(a,b){if("visible"===o.visibility){var c,d,e;m.radiusInnerCircle;c=k.getCanvasCoordinate(a),d=c.x,e=c.y,b.save(),b.strokeStyle=m.strokeStyleOuterCircle,b.lineWidth=m.lineWidthOuterCircle,b.beginPath(),b.arc(d,e,m.radiusOuterCircle,2*Math.PI,0,!0),b.closePath(),b.stroke(),b.fillStyle=m.fillStyleInnerCircle,b.beginPath(),b.arc(d,e,m.radiusInnerCircle,2*Math.PI,0,!0),b.closePath(),b.fill(),b.restore()}},k.resetFillStyle=function(){return m.fillStyleInnerCircle=m.originalFillStyleInnerCircle,this},k.resetSVImageCoordinate=function(a){return k.svImageCoordinate=a,k.canvasCoordinate={x:0,y:0},this},k.resetStrokeStyle=function(){return m.strokeStyleOuterCircle=m.originalStrokeStyleOuterCircle,this},k.setBelongsTo=function(a){return l=a,this},k.setFillStyle=function(a){return m.fillStyleInnerCircle=a,this},k.setIconPath=function(a){return m.iconImagePath=a,this},k.setPhotographerPov=function(a,b){return m.photographerHeading=a,m.photographerPitch=b,this},k.setProperties=function(a){for(key in a)key in m&&(m[key]=a[key]);return"originalCanvasCoordinate"in a&&(k.originalCanvasCoordinate=a.originalCanvasCoordinate),k.pov=k.pov||{},"pov"in a&&(k.pov=a.pov),"heading"in a&&(k.pov.heading=a.heading),"pitch"in a&&(k.pov.pitch=a.pitch),"zoom"in a&&(k.pov.zoom=a.zoom),k.originalPov=k.originalPov||{},"originalHeading"in a&&(k.originalPov.heading=a.originalHeading),"originalPitch"in a&&(k.originalPov.pitch=a.originalPitch),"originalZoom"in a&&(k.originalPov.zoom=a.originalZoom),m.originalFillStyleInnerCircle||(m.originalFillStyleInnerCircle=m.fillStyleInnerCircle),m.originalStrokeStyleOuterCircle||(m.originalStrokeStyleOuterCircle=m.strokeStyleOuterCircle),this},k.setStrokeStyle=function(a){return m.strokeStyleOuterCircle=a,this},k.setVisibility=function(a){return("visible"===a||"hidden"===a)&&(o.visibility=a),this},k.resetProperties=k.setProperties;var p=arguments.length;return 4===p?e(a,b,c,d):f(),k}function ProgressFeedback(a,b){function c(b){d=a("#ProgressBarContainer"),e=a("#ProgressBarFilled"),f=a("#Progress_Message"),h.progressBarWidth=d.width(),b&&b.message?g.setMessage(b.message):g.setMessage(""),g.setProgress(0)}var d,e,f,g={className:"ProgressFeedback"},h={progressBarWidth:void 0},i={progress:void 0};return g.setMessage=function(a){f.html(a)},g.setProgress=function(a){if("number"!=typeof a&&(a=parseFloat(a)),NaN===a)throw new TypeError(g.className+": The passed value cannot be parsed.");if(a>1&&(a=1,console.error(g.className+": You can not pass a value larger than 1 to setProgress.")),i.progress=a,h.progressBarWidth){var b,c,d;.5>a?(b=255,c=parseInt(255*a*2)):(b=parseInt(255*(1-a)*2),c=255),d="rgba("+b+","+c+",0,1)",e.css({background:d,width:a*h.progressBarWidth})}return this},c(b),g}function ProgressPov(a,b){function c(a){g=svw.ui.progressPov.rate,h=svw.ui.progressPov.bar,i=svw.ui.progressPov.filler,k.surveyedAngles=new Array(100);for(var b=0;100>b;b++)k.surveyedAngles[b]=0;if(a&&a.pov)k.previousHeading=a.pov.heading;else try{var c=svw.getPov();k.previousHeading=c.heading}catch(e){k.previousHeading=0}d()}function d(){var a=100*j.getCompletionRate();return a=a.toFixed(0,10),a+="%",g.html(a),this}function e(){var a,b,c,d=j.getCompletionRate(),e=255;.5>d?(a=e,b=parseInt(e*d*2)):(a=parseInt(e*(1-d)*2),b=e),c="rgba("+a+","+b+",0,1)",d*=100,d=d.toFixed(0,10),d-=.8,d+="%",i.css({background:c,width:d})}function f(){d(),e()}var g,h,i,j={className:"ProgressPov"},k={currentCompletionRate:0,previousHeading:0,surveyedAngles:void 0};return j.getCompletionRate=function(){try{if(k.currentCompletionRate<1){var a=25,b=svw.getPOV(),c=b.heading,d=(c-a+360)%360,e=(c+a)%360,f=Math.floor(d/360*100),g=Math.floor(e/360*100),h=0;if(g>f)for(h=f;g>h;h++)k.surveyedAngles[h]=1;else{for(h=f;100>h;h++)k.surveyedAngles[h]=1;for(h=0;g>h;h++)k.surveyedAngles[h]=1}var i=Math.floor(c/360*100),j=k.previousHeading;if(c!==j){var l=Math.floor(j/360*100),m=c-j;if(m>0&&300>m||-300>m)for(h=l;h==k.surveyedAngles.length&&(h=0),k.surveyedAngles[h]=1,h!=i;h++);else for(h=l;-1==h&&(h=k.surveyedAngles.length-1),k.surveyedAngles[h]=1,h!=i;h--);}var n=k.surveyedAngles.reduce(function(a,b){return a+b});return k.currentCompletionRate=n/100,k.previousHeading=c,n/100}return 1}catch(o){return 0}},j.setCompletedHeading=function(a){var b,c=a[0],d=a[1],e=Math.floor(c/360*100),f=Math.floor(d/360*100);for(b=e;f>b;b++)k.surveyedAngles[b]=1;return this},j.updateCompletionRate=function(){return f()},c(b),j}function QualificationBadges(a,b){function c(b){d=a("#BadgeImageHolder_BusStopAuditor"),e=a("#BadgeImageHolder_BusStopExplorer"),d.html('<img src="'+g.badgePlaceHolderImagePath+'" class="'+g.badgeClassName+'">'),e.html('<img src="'+g.badgePlaceHolderImagePath+'" class="'+g.badgeClassName+'">')}var d,e,f={className:"QualificationBadges"},g={badgeClassName:"Badge",badgePlaceHolderImagePath:"public/img/badges/EmptyBadge.png",busStopAuditorImagePath:"public/img/badges/Onboarding_BusStopExplorerBadge_Orange.png",busStopExplorerImagePath:"public/img/badges/Onboarding_BusStopInspector_Green.png"};return f.giveBusStopAuditorBadge=function(){return d.html('<img src="'+g.busStopAuditorImagePath+'" class="'+g.badgeClassName+'">'),this},f.giveBusStopExplorerBadge=function(){e.html('<img src="'+g.busStopExplorerImagePath+'" class="'+g.badgeClassName+'">')},c(b),f}function RibbonMenu(a,b){function c(){var b=getBrowser();"mozilla"===b?o.originalBackgroundColor="-moz-linear-gradient(center top , #fff, #eee)":"msie"===b?o.originalBackgroundColor="#ffffff":o.originalBackgroundColor="-webkit-gradient(linear, left top, left bottom, from(#fff), to(#eee))";var c=svw.misc.getLabelColors();svw.ui&&svw.ui.ribbonMenu&&(j=svw.ui.ribbonMenu.streetViewHolder,k=svw.ui.ribbonMenu.bottonBottomBorders,l=svw.ui.ribbonMenu.connector,m=svw.ui.ribbonMenu.buttons,a.each(k,function(b,d){var e=a(d).attr("value"),f=c[e].fillStyle;"Walk"===e&&a(d).css("width","56px"),a(d).css("border-top-color",f),a(d).css("background",f)}),i(p.mode),h(p.mode),m.bind("click",e),m.bind({mouseenter:f,mouseleave:g}))}function d(b){var c;if(c="string"==typeof b?b:a(this).attr("val"),p.disableModeSwitch===!1){var d,e,f;"canvas"in svw&&svw.canvas&&svw.canvas.isDrawing()&&svw.canvas.cancelDrawing(),d=getLabelColors(),e=getRibbonConnectionPositions(),f=d[c].fillStyle,"map"in svw&&svw.map&&("Walk"===c?(n.setStatus("mode","Walk"),n.setStatus("selectedLabelType",void 0),svw.map&&svw.map.modeSwitchWalkClick()):(n.setStatus("mode",c),n.setStatus("selectedLabelType",c),svw.map&&svw.map.modeSwitchLabelClick())),svw.ui&&svw.ui.ribbonMenu&&(i(c),h(c),l.css("left",e[c].labelRibbonConnection),l.css("border-left-color",f),j.css("border-color",f)),svw.overlayMessageBox&&svw.overlayMessageBox.setMessage(c)}}function e(){if(p.disableModeSwitch===!1){var b;if(b=a(this).attr("val"),p.allowedMode&&p.allowedMode!==b)return!1;svw.tracker.push("Click_ModeSwitch_"+b),d(b)}}function f(){if(p.disableModeSwitch===!1){var b=a(this).attr("val");if(p.allowedMode&&p.allowedMode!==b)return!1;h(b),i(b)}}function g(){p.disableModeSwitch===!1&&(i(p.mode),h(p.mode))}function h(b){if(svw.ui&&svw.ui.ribbonMenu){var c,d,e,f;d=getLabelColors(),e=d[b].fillStyle,a.each(m,function(d,g){c=a(g).attr("val"),c===b?(f="Walk"===c?"#ccc":e,a(this).css({background:f})):(f=o.originalBackgroundColor,c!==p.mode&&a(this).css({background:f}))})}return this}function i(b){if(svw.ui&&svw.ui.ribbonMenu){var c,d,e;d=getLabelColors(),e=d[b].fillStyle,a.each(m,function(d,f){c=a(f).attr("val"),c===b?a(this).css({"border-color":e,"border-style":"solid","border-width":o.borderWidth}):c!==p.mode&&a(this).css({"border-color":o.modeSwitchDefaultBorderColor,"border-style":"solid","border-width":o.borderWidth})})}return this}var j,k,l,m,n={className:"RibbonMenu"},o={borderWidth:"3px",modeSwitchDefaultBorderColor:"rgba(200,200,200,0.75)",originalBackgroundColor:"white"},p={disableModeSwitch:!1,lockDisableModeSwitch:!1,mode:"Walk",selectedLabelType:void 0};return n.backToWalk=function(){return d("Walk"),this},n.disableModeSwitch=function(){return p.lockDisableModeSwitch||(p.disableModeSwitch=!0,svw.ui&&svw.ui.ribbonMenu&&m.css("opacity",.5)),this},n.disableLandmarkLabels=function(){return svw.ui&&svw.ui.ribbonMenu&&a.each(m,function(b,c){var d=a(c).attr("val");"Walk"!==d&&"StopSign"!==d&&"Landmark_Shelter"!==d&&a(c).css("opacity",.5)}),p.disableLandmarkLabels=!0,this},n.enableModeSwitch=function(){return p.lockDisableModeSwitch||(p.disableModeSwitch=!1,svw.ui&&svw.ui.ribbonMenu&&m.css("opacity",1)),this},n.enableLandmarkLabels=function(){return svw.ui&&svw.ui.ribbonMenu&&a.each(m,function(b,c){a(c).attr("val");a(c).css("opacity",1)}),p.disableLandmarkLabels=!1,this},n.lockDisableModeSwitch=function(){return p.lockDisableModeSwitch=!0,this},n.modeSwitch=function(a){d(a)},n.modeSwitchClick=function(a){d(a)},n.getStatus=function(a){return a in p?p[a]:void console.warn(n.className,'You cannot access a property "'+a+'".')},n.setAllowedMode=function(a){return p.allowedMode=a,this},n.setStatus=function(a,b){try{if(a in p)return"disableModeSwitch"===a?"boolean"==typeof b?(b?n.disableModeSwitch():n.enableModeSwitch(),this):!1:(p[a]=b,this);var c='"'+a+'" is not a modifiable status.';throw c}catch(d){return console.error(n.className,d),!1}},n.unlockDisableModeSwitch=function(){return p.lockDisableModeSwitch=!1,this},c(b),n}function RightClickMenu(a){function b(a){B=a.canvas,C=a.ribbonMenu,D=$("div#labelDrawingLayer_LabelMenu"),E=$("#labelDrawingLayer_LabelMenuBar"),F=$("div#LabelDeleteMenu"),G=$("div#Holder_RightClickMenu"),H=$("input.Radio_BusStopType"),I=$("button#LabelDeleteMenu_DeleteButton"),J=$("button#LabelDeleteMenu_CancelButton"),K=$(".BusStopLabelMenuItem"),P=$("#Holder_BusStopLabelMenuOptionCloseIcon"),L=$("#BusStopPositionMenu"),M=$("#BusStopPositionMenu_MenuBar"),N=$(".BusStopPositionMenu_MenuItem"),O=$("#BusStopPositinoMenu_BackButton"),Q=$("#Holder_BusStopPositionMenuCloseIcon"),R=$(".RightClickMenuBar"),S=$(".Holder_BusStopLabelMenuQuestionMarkIcon"),T=$(".Holder_BusStopPositionMenuQuestionMarkIcon"),K.bind("mouseup",g),K.bind("mouseenter",h),K.bind("mouseleave",i),E.bind("mousedown",j),E.bind("mouseup",k),E.bind("mousemove",l),P.bind("click",m),P.bind("mouseenter",n),P.bind("mouseleave",o),N.bind("mouseup",p),N.bind("mouseenter",q),N.bind("mouseleave",r),M.bind("mousedown",v),M.bind("mouseup",w),M.bind("mousemove",x),Q.bind("click",u),Q.bind("mouseenter",s),Q.bind("mouseleave",t),S.bind({mouseenter:c,mouseleave:d,mouseup:e}),T.bind({mouseenter:c,mouseleave:d,mouseup:e}),R.bind("mouseenter",f),O.bind("click",A)}function c(a){$(this).find(".tooltip").css("visibility","visible")}function d(){$(this).find(".tooltip").css("visibility","hidden")}function e(a){a.stopPropagation();var b=$(this).parent().attr("value");myExamples.show(b)}function f(){$(this).css("cursor","url(public/img/cursors/openhand.cur) 4 4, move")}function g(){if(!V.disableMenuSelect){var a,b,c,d;a=getLabelColors().StopSign.fillStyle,d=$(this),d.css("background","transparent"),setTimeout(function(){d.css("background",a),setTimeout(function(){d.css("background","transparent"),U.hideBusStopType(),c=d.attr("value"),c||(c="StopSign"),V.currentLabel.setSubLabelDescription(c),b=getLabelIconImagePath()[c].iconImagePath,V.currentLabel.setIconPath(b),B.clear().render(),z()},100)},100)}}function h(){if(!V.disableMenuSelect){var a=getLabelColors().StopSign.fillStyle;return $(this).css({background:a,cursor:"pointer"}),this}return!1}function i(){return V.disableMenuSelect?void 0:($(this).css({background:"transparent",cursor:"default"}),this)}function j(){W.mouseDownOnBusStopLabelMenuBar=!0,$(this).css("cursor","url(public/img/cursors/closedhand.cur) 4 4, move")}function k(){W.mouseDownOnBusStopLabelMenuBar=!1,$(this).css("cursor","url(public/img/cursors/openhand.cur) 4 4, move")}function l(a){if(W.mouseDownOnBusStopLabelMenuBar){var b,c,d=D.css("left"),e=D.css("top");e=parseInt(e.replace("px","")),d=parseInt(d.replace("px","")),b=a.pageX-W.prevX,c=a.pageY-W.prevY,d+=b,e+=c,D.css({left:d,top:e})}W.prevX=a.pageX,W.prevY=a.pageY}function m(){if(!V.disableMenuClose){var a;V.currentLabel&&(a=V.currentLabel.getProperties(),("DefaultValue"===a.labelProperties.busStopPosition||"DefaultValue"===a.labelProperties.subLabelDescription)&&(myCanvas.removeLabel(V.currentLabel),myActionStack.pop())),W.mouseDownOnBusStopLabelMenuBar=!1,U.hideBusStopType(),B.enableLabeling(),myMenu.setStatus("disableModeSwitch",!1)}}function n(){V.disableMenuClose||$(this).css("cursor","pointer")}function o(){$(this).css("cursor","default")}function p(){if(!V.disableMenuSelect){var a,b,c;b=getLabelColors().StopSign.fillStyle,V.currentLabel.setStatus("visibilityTag","visible"),c=$(this),c.css("background","transparent"),a=c.attr("value"),V.currentLabel.setBusStopPosition(a),setTimeout(function(){c.css("background",b),setTimeout(function(){c.css("background","transparent"),y(),myMap.enableWalking(),myMenu.backToWalk()},100)},100)}}function q(){if(!V.disableMenuSelect){var a=getLabelColors().StopSign.fillStyle;return $(this).css({background:a,cursor:"pointer"}),this}}function r(){return V.disableMenuSelect?void 0:($(this).css({background:"transparent",cursor:"default"}),this)}function s(){V.disableMenuClose||$(this).css({cursor:"pointer"})}function t(){$(this).css({cursor:"default"})}function u(){if(!V.disableMenuClose&&V.currentLabel){var a;a=V.currentLabel.getProperties(),("DefaultValue"===a.labelProperties.busStopPosition||"DefaultValue"===a.labelProperties.subLabelDescription)&&(myCanvas.removeLabel(V.currentLabel),myActionStack.pop()),W.mouseDownOnBusStopPositionMenuBar=!1,y(),B.enableLabeling(),myMenu.setStatus("disableModeSwitch",!1)}}function v(a){W.mouseDownOnBusStopPositionMenuBar=!0,$(this).css("cursor","url(public/img/cursors/closedhand.cur) 4 4, move")}function w(a){W.mouseDownOnBusStopPositionMenuBar=!1,$(this).css("cursor","url(public/img/cursors/openhand.cur) 4 4, move")}function x(a){if(W.mouseDownOnBusStopPositionMenuBar){var b,c,d=L.css("left"),e=L.css("top");e=parseInt(e.replace("px","")),d=parseInt(d.replace("px","")),b=a.pageX-W.prevX,c=a.pageY-W.prevY,d+=b,e+=c,L.css({left:d,top:e})}W.prevX=a.pageX,W.prevY=a.pageY}function y(){V.visibilityBusStopPositionMenu="hidden",G.css("visibility","hidden"),L.css("visibility","hidden"),U.isAllClosed()&&(B.setStatus("disableLabeling",!1),myMenu.setStatus("disableModeSwitch",!1),V.disableLabelDelete=!1,V.currentLabel=void 0,myActionStack.unlockDisableRedo().enableRedo().lockDisableRedo(),myActionStack.unlockDisableUndo().enableUndo().lockDisableUndo(),myForm.unlockDisableSubmit().enableSubmit().lockDisableSubmit(),myForm.unlockDisableNoBusStopButton().enableNoBusStopButton().lockDisableNoBusStopButton())}function z(){var a=V.menuPosition.x,b=V.menuPosition.y;V.visibilityBusStopPositionMenu="visible",M.css({background:getLabelColors().StopSign.fillStyle}),a>400&&(a-=300),b>300&&(b-=200),L.css({visibility:"visible",position:"absolute",left:a,top:b,"z-index":4}),B.setStatus("visibilityMenu","visible"),B.disableLabeling(),myMenu.setStatus("disableModeSwitch",!0),myActionStack.unlockDisableRedo().disableRedo().lockDisableRedo(),myActionStack.unlockDisableUndo().disableUndo().lockDisableUndo()}function A(){var a=V.currentLabel;y(),U.showBusStopType(a.getCoordinate().x,a.getCoordinate().y)}var B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T,U={className:"RightClickMenu"},V={currentLabel:void 0,disableLabelDelete:!1,disableMenuClose:!1,disableMenuSelect:!1,lockDisableMenuSelect:!1,visibilityDeleteMenu:"hidden",visibilityBusStopLabelMenu:"hidden",visibilityBusStopPositionMenu:"hidden",menuPosition:{x:-1,y:-1}},W={currX:0,currY:0,prevX:0,prevY:0,leftDownX:0,leftDownY:0,leftUpX:0,leftUpY:0,mouseDownOnBusStopLabelMenuBar:!1,mouseDownOnBusStopPositionMenuBar:!1};return U.close=function(){m(),u()},U.disableMenuClose=function(){return V.disableMenuClose=!0,this},U.disableMenuSelect=function(){return V.lockDisableMenuSelect||(V.disableMenuSelect=!0),this},U.enableMenuClose=function(){return V.disableMenuClose=!1,this},U.enableMenuSelect=function(){return V.lockDisableMenuSelect||(V.disableMenuSelect=!1),this},U.getMenuPosition=function(){return{x:V.menuPosition.x,y:V.menuPosition.y}},U.hideBusStopPosition=function(){return y(),this},U.hideBusStopType=function(){G.css("visibility","hidden"),D.css("visibility","hidden"),V.visibilityBusStopLabelMenu="hidden",B.setStatus("visibilityMenu","hidden"),U.isAllClosed()&&(myActionStack.unlockDisableRedo().enableRedo().lockDisableRedo(),myActionStack.unlockDisableUndo().enableUndo().lockDisableUndo(),myForm.unlockDisableSubmit().disableSubmit().lockDisableSubmit(),myForm.unlockDisableNoBusStopButton().disableNoBusStopButton().lockDisableNoBusStopButton())},U.hideDeleteLabel=function(){G.css("visibility","hidden"),V.visibilityDeleteMenu="hidden",F.css("visibility","hidden"),B.setStatus("visibilityMenu","hidden"),U.isAllClosed()&&(B.enableLabeling(),myMenu.setStatus("disableModeSwitch",!1))},U.isAllClosed=function(){return"hidden"===V.visibilityBusStopLabelMenu&&"hidden"===V.visibilityDeleteMenu&&"hidden"===V.visibilityBusStopPositionMenu?!0:!1},U.isAnyOpen=function(){return!U.isAllClosed()},U.lockDisableMenuSelect=function(){return V.lockDisableMenuSelect=!0,this},U.setStatus=function(a,b){return a in V?"disableMenuClose"===a?"boolean"==typeof b?(b?U.enableMenuClose():U.disableMenuClose(),
this):!1:(V[a]=b,this):!1},U.showBusStopType=function(a,b){if(V.currentLabel=B.getCurrentLabel(),V.currentLabel&&"StopSign"===V.currentLabel.getLabelType()){var c,d;G.css("visibility","visible"),V.visibilityBusStopLabelMenu="visible",E.css({background:getLabelColors().StopSign.fillStyle}),c=a+25,d=b+25,c>400&&(c-=300),d>300&&(d-=200),V.menuPosition.x=c,V.menuPosition.y=d,D.css({visibility:"visible",position:"absolute",left:c,top:d,"z-index":4}),V.visibilityBusStopLabelMenu="visible",B.setStatus("visibilityMenu","visible"),B.setStatus("disableLabeling",!0),B.disableLabeling(),myMap.setStatus("disableWalking",!0),myMenu.setStatus("disableModeSwitch",!0)}},U.showDeleteLabel=function(a,b){var c,d;V.disableLabelDelete||(G.css("visibility","visible"),c=a-5,d=b-5,F.css({visibility:"visible",position:"absolute",left:c,top:d,"z-index":4}),V.visibilityDeleteMenu="visible",V.visibilityMenu="visible",V.disableLabeling=!0,myMenu.setStatus("disableModeSwitch",!0))},U.unlockDisableMenuSelect=function(){return V.lockDisableMenuSelect=!1,this},b(a),U}function Tooltip(a,b){function c(b){d=a(b.domIds.tooltipHolder)}var d,e={className:"Tooltip"};return e.show=function(a){d.html(a),d.css("visibility","visible")},e.hide=function(){d.css("visibility","hidden")},c(b),e}function Tracker(){var a={className:"Tracker"},b=[],c=["TaskStart","TaskSubmit","TaskSubmitSkip","Click_ModeSwitch_Walk","Click_ModeSwitch_CurbRamp","Click_ModeSwitch_NoCurbRamp","Click_Undo","Click_Redo","Click_ZoomIn","Click_ZoomOut","Click_LabelDelete","Click_LabelEdit","Click_Path","Click_OpenSkipWindow","Click_CloseSkipWindow","Click_SkipRadio","LabelingCanvas_MouseUp","LabelingCanvas_MouseDown","LabelingCanvas_CancelLabeling","LabelingCanvas_StartLabeling","LabelingCanvas_FinishLabeling","ViewControl_MouseDown","ViewControl_MouseUp","ViewControl_DoubleClick","ViewControl_ZoomIn","ViewControl_ZoomOut","WalkTowards","KeyDown","KeyUp","RemoveLabel","Redo_AddLabel","Redo_RemoveLabel","Undo_AddLabel","Undo_RemoveLabel","MessageBox_ClickOk","GoldenInsertion_Submit","GoldenInsertion_ReviewLabels","GoldenInsertion_ReviseFalseNegative","GoldenInsertion_ReviseFalsePositive","Onboarding1_Start","Onboarding1_FirstCorner_IntroduceCurbRamps","Onboarding1_FirstCorner_LabelTheFirstCurbRamps","Onboarding1_FirstCorner_RedoLabelingTheFirstCurbRamps","Onboarding1_FirstCorner_SwitchTheModeToCurbRampForLabelTheSecondCurbRamps","Onboarding1_FirstCorner_LabelTheSecondCurbRamps","Onboarding1_FirstCorner_RedoLabelingTheSecondCurbRamps","Onboarding1_GrabAndDragToMoveToTheNextCorner","Onboarding1_KeepDragging","Onboarding1_SecondCorner_ModeSwitchToCurbRamps","Onboarding1_SecondCorner_LabelTheCurbRamps","Onboarding1_SecondCorner_RedoLabelingTheThirdCurbRamps","Onboarding1_SecondCorner_IntroductionToAMissingCurbRamp","Onboarding1_SecondCorner_LabelTheMissingCurbRamp","Onboarding1_SecondCorner_RedoLabelingTheMissingCurbRamps","Onboarding1_DoneLabelingAllTheCorners_EndLabeling","Onboarding1_Submit","Onboarding2_Start","Onboarding2_FirstCorner_IntroduceMissingCurbRamps","Onboarding2_FirstCorner_LabelTheMissingCurbRamps","Onboarding2_FirstCorner_RedoLabelingTheMissingCurbRamps","Onboarding2_FirstCorner_V2_LabelTheFirstMissingCurbRamps","Onboarding2_FirstCorner_V2_RedoLabelingTheFirstMissingCurbRamps","Onboarding2_FirstCorner_V2_ModeSwitchToMissingCurbRamp","Onboarding2_FirstCorner_V2_LabelTheSecondMissingCurbRamps","Onboarding2_FirstCorner_V2_RedoLabelingTheSecondMissingCurbRamps","Onboarding2_FirstCorner_MissingCurbRampExampleLabels","Onboarding2_GrabAndDragToTheSecondCorner","Onboarding2_KeepDraggingToTheSecondCorner","Onboarding2_SecondCorner_ModeSwitchToCurbRamp","Onboarding2_SecondCorner_LabelTheCurbRamp","Onboarding2_SecondCorner_RedoLabelingTheCurbRamps","Onboarding2_SecondCorner_ExamplesOfDiagonalCurbRamps","Onboarding2_RemindAboutTheCompletionRateMeter","Onboarding2_GrabAndDragToTheThirdCorner","Onboarding2_KeepDraggingToTheThirdCorner","Onboarding2_ThirdCorner_FirstZoomIn","Onboarding2_ThirdCorner_FirstModeSwitchToCurbRamp","Onboarding2_ThirdCorner_LabelTheFirstCurbRamp","Onboarding2_ThirdCorner_RedoLabelingTheFirstCurbRamps","Onboarding2_ThirdCorner_AdjustTheCameraAngle","Onboarding2_ThirdCorner_KeepAdjustingTheCameraAngle","Onboarding2_ThirdCorner_SecondZoomIn","Onboarding2_ThirdCorner_SecondModeSwitchToCurbRamp","Onboarding2_ThirdCorner_LabelTheSecondCurbRamps","Onboarding2_ThirdCorner_RedoLabelingTheSecondCurbRamps","Onboarding2_ThirdCorner_FirstZoomOut","Onboarding2_ThirdCorner_SecondZoomOut","Onboarding2_GrabAndDragToTheFourthCorner","Onboarding2_KeepDraggingToTheFourthCorner","Onboarding2_FourthCorner_IntroduceOcclusion","Onboarding2_DoneLabelingAllTheCorners_EndLabeling","Onboarding2_Submit","Onboarding3_Start","Onboarding3_ShowNorthSideOfTheIntersection","Onboarding3_GrabAndDrag","Onboarding3_KeepDragging","Onboarding3_SouthSideOfTheIntersection","Onboarding3_GrabAndDragToNorth","Onboarding3_ClickSkip","Onboarding3_SelectSkipOption","Onboarding3_ClickSkipOk","Onboarding3_finalMessage","Onboarding3_Submit","OnboardingQuickCheck_nextClick","OnboardingQuickCheck_clickQuickCheckImages","OnboardingQuickCheck_submitClick","OnboardingQuickCheck_submit"],d="undefined";return a.getActions=function(){return b},a.getAvailableActionTypes=function(){var a=c.slice(0);return a},a.push=function(a,e){if(-1===c.indexOf(a))return console.warn("Unknown action: "+a),!1;var f,g,h,i,j;j=e?"x"in e&&"y"in e?"x:"+e.x+",y:"+e.y:"TargetPanoId"in e?e.TargetPanoId:"RadioValue"in e?e.RadioValue:"keyCode"in e?"keyCode:"+e.keyCode:"errorType"in e?"errorType:"+e.errorType:"quickCheckImageId"in e?e.quickCheckImageId:"quickCheckCorrectness"in e?e.quickCheckCorrectness:"labelId"in e?"labelId:"+e.labelId:d:d;try{f=svw.getPOV()}catch(k){f={heading:d,pitch:d,zoom:d}}try{g=getPosition()}catch(k){g={lat:d,lng:d}}g||(g={lat:d,lng:d});try{h=getPanoId()}catch(k){h=d}return i={actionType:a,heading:f.heading,lat:g.lat,lng:g.lng,panoId:h,pitch:f.pitch,timestamp:(new Date).getTime(),zoom:f.zoom,note:j},b.push(i),this},a}function UI(a,b){function c(b){$buttonRedo=a("#ActionStackRedoButton"),$buttonUndo=a("#ActionStackUndoButton"),d.actionStack={},d.actionStack.redo=$buttonRedo,d.actionStack.undo=$buttonUndo,$labelCountCurbRamp=a("#LabeledLandmarkCount_CurbRamp"),$labelCountNoCurbRamp=a("#LabeledLandmarkCount_NoCurbRamp"),$submittedLabelMessage=a("#LabeledLandmarks_SubmittedLabelCount"),d.labeledLandmark={},d.labeledLandmark.curbRamp=$labelCountCurbRamp,d.labeledLandmark.noCurbRamp=$labelCountNoCurbRamp,d.labeledLandmark.submitted=$submittedLabelMessage,d.map={},d.map.canvas=a("canvas#labelCanvas"),d.map.drawingLayer=a("div#labelDrawingLayer"),d.map.pano=a("div#pano"),d.map.streetViewHolder=a("div#streetViewHolder"),d.map.viewControlLayer=a("div#viewControlLayer"),d.map.modeSwitchWalk=a("span#modeSwitchWalk"),d.map.modeSwitchDraw=a("span#modeSwitchDraw"),$currentStatusDescription=a("#CurrentStatus_Description"),d.missinDescription={},d.missinDescription.description=$currentStatusDescription,d.overlayMessage={},d.overlayMessage.box=a("#OverlayMessageBox"),d.overlayMessage.message=a("#OverlayMessage"),d.progressPov={},d.progressPov.rate=a("#Holder_CurrentCompletionRate"),d.progressPov.bar=a("#Holder_CurrentCompletionBar"),d.progressPov.filler=a("#Holder_CurrentCompletionBarFiller"),$divStreetViewHolder=a("#Holder_StreetView"),$ribbonButtonBottomLines=a(".RibbonModeSwitchHorizontalLine"),$ribbonConnector=a("#StreetViewLabelRibbonConnection"),$spansModeSwitches=a("span.modeSwitch"),d.ribbonMenu={},d.ribbonMenu.streetViewHolder=$divStreetViewHolder,d.ribbonMenu.buttons=$spansModeSwitches,d.ribbonMenu.bottonBottomBorders=$ribbonButtonBottomLines,d.ribbonMenu.connector=$ribbonConnector,$buttonZoomIn=a("#ZoomControlZoomInButton"),$buttonZoomOut=a("#ZoomControlZoomOutButton"),d.zoomControl={},d.zoomControl.zoomIn=$buttonZoomIn,d.zoomControl.zoomOut=$buttonZoomOut}var d={moduleName:"MainUI"};return d.streetViewPane={},c(b),d}function Validator(a,b){function c(a){var c=b(this),d=c.attr("value");c.css("background","rgba(230, 230, 230, 1)"),I.radioCurrentLabelHoverState=d,l()}function d(a){var c=b(this);c.css("background","transparent"),I.radioCurrentLabelHoverState="ShowLabel",l()}function e(a){var c=b(this).attr("value");I.radioCurrentLabelCheckState=c,l()}function f(a,b){var c,d,e=b.length,f=[],g=1e7,h=-1;for(c=0;e>c;c+=1)g>b[c].x&&(g=b[c].x),h<b[c].x&&(h=b[c].x);var i=3328;for(c=0;e>c;c+=1)a.heading<180?h>svw.svImageWidth-i&&b[c].x>i&&(b[c].x-=svw.svImageWidth):i>g&&b[c].x<svw.svImageWidth-i&&(b[c].x+=svw.svImageWidth),d=svw.gsvImageCoordinate2CanvasCoordinate(b[c].x,b[c].y,a),f.push(d);return f}function g(a){var b,c=a.points.length,d=svw.getPOV(),e=void 0,g=[];for(b=0;c>b;b++)e={x:parseInt(a.points[b].svImageX),y:parseInt(a.points[b].svImageY)},g.push(e);var h,i=f(d,g),j=-1;for(b=0;c>b;b++)h=i[b],j<h.y&&(j=h.y);return j}function h(a){var b,c=a.points.length,d={heading:parseFloat(a.points[0].heading),pitch:parseFloat(a.points[0].pitch),zoom:parseFloat(a.points[0].zoom)},e=void 0,g=[];for(b=0;c>b;b++)e={x:parseInt(a.points[b].svImageX),y:parseInt(a.points[b].svImageY)},g.push(e);var h,i=f(d,g),j=1e6;for(b=0;c>b;b++)h=i[b],j>h.x&&(j=h.x);return j}function i(){var a,b,c=L.length,d=!0;for(a=0;c>a;a++)if(b=L[a],!b.validated){d=!1;break}return d?(I.allLabelsHaveBeenValidated=d,!1):b}function j(){var a,b=L.length,c=0;for(a=0;b>a;a++)L[a].validated&&(c+=1);return c}function k(){x.css("visibility","hidden")}function l(){if(!K)throw G.className+": highlightCurrentLabel(): currentLabel is not set.";var a,b,c,d,e,f,g,h;if(!svw.canvas)throw G.className+": highlightCurrentLabel(): canvas is not defined.";var i=void 0;for(d=svw.canvas.getLabels(),c=d.length,i="ShowLabel"===I.radioCurrentLabelHoverState?!0:!1,a=0;c>a;a++)if(e=d[a],f=e.getPath(!0),K.meta.labelId===d[a].getProperty("labelId")&&i)for(e.setVisibility("visible"),g=f.points,h=g.length,b=0;h>b;b++)g[b].resetFillStyle(),g[b].resetStrokeStyle();else for(e.setVisibility("hidden"),g=f.points,h=g.length,b=0;h>b;b++)g[b].setFillStyle("rgba(255,255,255,0)"),g[b].setStrokeStyle("rgba(255,255,255,0)");svw.canvas.clear(),svw.canvas.render2()}function m(a){H.previewMode=a.previewMode,v=b(a.domIds.holder),x=b("#ValidationDialogWindow"),w=b("#ValidationDialogWindowMenuBar"),y=b("#ValidationLabelValue"),z=b("#ValidationButtonAgree"),A=b("#ValidationButtonDisagree"),B=b(".SpanValidationCurrentLabeliVisibility"),C=b(".RadioValidationCurrentLabelVisibility"),D=b("#NumCompletedTasks"),E=b("#NumTotalTasks"),F=b("#ProgressBarFiller"),w.on({mousedown:r,mouseleave:s,mousemove:t,mouseup:u}),B.hover(c,d),C.on("mousedown",e),z.on("click",p),A.on("click",q),k(),o(),b("#Holder_GoogleMap").css("visibility","hidden")}function n(a){if("number"!=typeof a&&(console.error(G.className,"A parameter of showDialogWindow() should be in milli-seconds (number)."),a=void 0),K){var b,c=g(K),d=h(K);b="CurbRamp"===K.meta.labelType?"We believe the green box (label) is correctly placed on a curb ramp in this image. Do you agree?":'We believe <span class="bold">there should be a curb ramp</span> under the highlighted area.',y.html(b),a?setTimeout(function(){c=g(K),d=h(K),x.css({left:d,top:c+20,visibility:"visible"})},a):x.css({left:d,top:c+20,visibility:"visible"})}}function o(){var a=L.length,b=0;b=j(),D.text(b),E.text(a);var c,d,e,f=b/a,g=parseInt(100*f,10)+"%";.5>f?(c=255,d=parseInt(255*f*2)):(c=parseInt(255*(1-f)*2),d=255),e="rgb(4,"+d+", 0)",F.css({background:e,width:g})}function p(){return K||(K=i()),K.validated=!0,K.validationLabel="Agree",G.validateNext(),o(),H.onboarding?!1:j()<L.length?!1:H.previewMode?(window.location.reload(),!1):!0}function q(){return K||(K=i()),K.validated=!0,K.validationLabel="Disagree",G.validateNext(),o(),H.onboarding?!1:j()<L.length?!1:H.previewMode?(window.location.reload(),!1):!0}function r(a){var b=mouseposition(a,"body");I.menuBarMouseDown=!0,J.menuBarPrevX=b.x,J.menuBarPrevY=b.y,J.menuBarMouseDownX=b.x,J.menuBarMouseDownY=b.y}function s(a){var b=mouseposition(a,"body");I.menuBarMouseDown=!1,J.menuBarMouseUpX=b.x,J.menuBarMouseUpY=b.y}function t(a){var b=mouseposition(a,"body");if(I.menuBarMouseDown&&b&&b.x&&b.y&&J.menuBarPrevX&&J.menuBarPrevX){var c=b.x-J.menuBarPrevX,d=b.y-J.menuBarPrevY,e=parseInt(x.css("left"),10),f=parseInt(x.css("top"),10);x.css({left:e+c,top:f+d})}J.menuBarPrevX=b.x,J.menuBarPrevY=b.y}function u(a){var b=mouseposition(a,"body");I.menuBarMouseDown=!1,J.menuBarMouseUpX=b.x,J.menuBarMouseUpY=b.y}var v,w,x,y,z,A,B,C,D,E,F,G={className:"Validator"},H={onboarding:!1},I={allLabelsHaveBeenValidated:!1,disableAgreeButton:!1,disableDisagreeButton:!1,disableRadioButtons:!1,menuBarMouseDown:!1,radioCurrentLabelCheckState:"ShowLabel",radioCurrentLabelHoverState:"ShowLabel"},J={menuBarMouseDownX:void 0,menuBarMouseDownY:void 0,menuBarMouseUpX:void 0,menuBarMouseUpY:void 0,menuBarPrevX:void 0,menuBarPrevY:void 0},K=void 0,L=[];return G.disableAgreeButton=function(){return I.disableAgreeButton=!0,z.css("opacity","0.5"),z.attr("disabled",!0),this},G.disableDisagreeButton=function(){return I.disableDisagreeButton=!0,A.css("opacity","0.5"),A.attr("disabled",!0),this},G.disableRadioButtons=function(){return I.disableRadioButtons=!0,C.each(function(a,c){b(c).attr("disabled",!0)}),this},G.enableAgreeButton=function(){return I.disableAgreeButton=!1,z.css("opacity","1"),z.attr("disabled",!1),this},G.enableDisagreeButton=function(){I.disableDisagreeButton=!1,A.css("opacity","1"),A.attr("disabled",!1)},G.enableRadioButtons=function(){I.disableRadioButtons=!1,C.each(function(a,c){b(c).attr("disabled",!1)})},G.getLabels=function(){return b.extend(!0,[],L)},G.hideDialogWindow=function(){return k(),this},G.insertLabels=function(a){var b=svw.misc.getLabelDescriptions(),c={};c.canvasWidth=svw.canvasWidth,c.canvasHeight=svw.canvasHeight,c.canvasDistortionAlphaX=svw.alpha_x,c.canvasDistortionAlphaY=svw.alpha_y,c.labelId=a[0].LabelId,c.labelType=a[0].LabelType,c.labelDescription=b[c.labelType].text,c.panoId=a[0].LabelGSVPanoramaId,c.panoramaLat=a[0].Lat,c.panoramaLng=a[0].Lng,c.panoramaHeading=a[0].heading,c.panoramaPitch=a[0].pitch,c.panoramaZoom=a[0].zoom,c.svImageWidth=svw.svImageWidth,c.svImageHeight=svw.svImageHeight,c.svMode="html4";var d={meta:c,points:a,validated:!1,validationLabel:void 0};L.push(d),o()},G.setDialogWindowBorderWidth=function(a){return x.css("border-width",a),this},G.setDialogWindowBorderColor=function(a){return x.css("border-color",a),this},G.showDialogWindow=function(a){return n(a),this},G.sortLabels=function(){function a(a,b){return parseInt(a.points[0].svImageX)<parseInt(b.points[0].svImageX)?-1:parseInt(a.points[0].svImageX)>parseInt(b.points[0].svImageX)?1:0}return L.sort(a),this},G.validateNext=function(a){if(!("map"in svw))throw G.className+": Map is not defined.";if(!("canvas"in svw))throw G.className+": Canvas is not defined.";if(K=i()){var b={heading:parseFloat(K.meta.panoramaHeading),pitch:parseFloat(K.meta.panoramaPitch),zoom:parseFloat(K.meta.zoom)};if(k(),"number"==typeof a&&a>=0){var c=500;svw.map.setPov(b,c),l(),n(c)}else svw.map.setPov(b,500),l(),n(500)}else{if(k(),H.onboarding)return!1;svw.validatorForm.submit()}return this},G.setOnboarding=function(a){H.onboarding=a},m(a),G}function ValidatorForm(a,b){function c(a){for(attr in f)f[attr]=a[attr]}function d(){if(!("validator"in svw&&svw.validator))throw e.className+": Validator not defined.";var a,c,d,h,i,j=f.panoId,k=f.dataStoreUrl,l={};if(a=f.hitId?f.hitId:"Test_Hit",c=f.assignmentId?f.assignmentId:"Test_Assignment",d=f.turkerId?f.turkerId:"Test_Kotaro",!f.onboarding){l.assignment={amazon_turker_id:d,amazon_hit_id:a,amazon_assignment_id:c,interface_type:"StreetViewValidator",interface_version:"1",completed:0,task_description:f.taskDescription},l.labelBinId=g,l.validationTask={task_panorama_id:f.taskPanoramaId,task_gsv_panorama_id:j,description:""},l.validationTaskEnvironment={browser:getBrowser(),browser_version:getBrowserVersion(),browser_width:b(window).width(),browser_height:b(window).height(),screen_width:screen.width,screen_height:screen.height,avail_width:screen.availWidth,avail_height:screen.availHeight,operating_system:getOperatingSystem()},svw.tracker.push("TaskSubmit"),l.userInteraction=svw.tracker.getActions(),l.labels=[];var m=svw.validator.getLabels();for(i=m.length,h=0;i>h;h++){console.log(m[h]);var n={};n.labelId=m[h].points[0].LabelId,n.result="Disagree"===m[h].validationLabel?0:1,l.labels.push(n)}try{b.ajax({async:!1,url:k,type:"post",data:l,dataType:"json",success:function(a){if(a.error)throw a.error.message},error:function(a){throw a}})}catch(o){console.log(o)}if(!(f.taskRemaining>1))return f.isAMTTask?(b('input[name="assignmentId"]').attr("value",c),b('input[name="workerId"]').attr("value",d),b('input[name="hitId"]').attr("value",a),!0):(window.location.reload(),!1);window.location.reload()}return!1}var e={className:"ValidatorForm"},f={dataStoreUrl:void 0,onboarding:void 0,taskDescription:void 0,taskPanoramaId:void 0,assignmentId:void 0,hitId:void 0,turkerId:void 0},g=void 0;return e.setLabelBinId=function(a){return g=a,this},e.submit=function(){return d()},c(a),e}function ZoomControl(a,b){function c(a){svw.ui&&svw.ui.zoomControl&&(h=svw.ui.zoomControl.zoomIn,i=svw.ui.zoomControl.zoomOut,h.bind("click",d),i.bind("click",e))}function d(){if("tracker"in svw&&svw.tracker.push("Click_ZoomIn"),!l.disableZoomIn){var a=svw.panorama.getPov();g(a.zoom+1),svw.canvas.clear().render2()}}function e(){if("traker"in svw&&svw.tracker.push("Click_ZoomOut"),!l.disableZoomOut){var a=svw.panorama.getPov();g(a.zoom-1),svw.canvas.clear().render2()}}function f(a,b){if(!l.disableZoomIn){if("canvas"in svw&&svw.canvas.cancelDrawing(),"panorama"in svw){console.log("hi");var c=svw.panorama.getPov(),d=c.zoom;if(d>=k.maxZoomLevel)return!1;var e=svw.canvasWidth,f=svw.canvasHeight,g=svw.map.getProperty("minPitch"),h=svw.map.getProperty("maxPitch"),i=d,j=(a-e/2)/e*(90/i),m=-(b-f/2)/f*(70/i),n={};n.zoom=d+1,n.heading=c.heading+j,n.pitch=c.pitch+m;var h=svw.map.getMaxPitch(),g=svw.map.getMinPitch();return n.pitch>h?n.pitch=h:n.pitch<g&&(n.pitch=g),svw.panorama.setPov(n),d}return!1}}function g(a){if("number"!=typeof a)return!1;"canvas"in svw&&svw.canvas.cancelDrawing();var b=void 0;return a=parseInt(a),b=1>a?1:a>k.maxZoomLevel?k.maxZoomLevel:a,svw.panorama.setZoom(b),b}var h,i,j={className:"ZoomControl"},k={maxZoomLevel:3,minZoomLevel:1},l={disableZoomIn:!1,disableZoomOut:!1},m={disableZoomIn:!1,disableZoomOut:!1};return j.disableZoomIn=function(){return m.disableZoomIn||(l.disableZoomIn=!0,h&&h.css("opacity",.5)),this},j.disableZoomOut=function(){return m.disableZoomOut||(l.disableZoomOut=!0,i&&i.css("opacity",.5)),this},j.enableZoomIn=function(){return m.disableZoomIn||(l.disableZoomIn=!1,h&&h.css("opacity",1)),this},j.enableZoomOut=function(){return m.disableZoomOut||(l.disableZoomOut=!1,i&&i.css("opacity",1)),this},j.getLock=function(a){if(a in m)return m[a];var b='You cannot access a property "'+a+'".';throw b},j.getStatus=function(a){if(a in l)return l[a];var b='You cannot access a property "'+a+'".';throw b},j.getProperties=function(a){if(a in k)return k[a];var b='You cannot access a property "'+a+'".';throw b},j.lockDisableZoomIn=function(){return m.disableZoomIn=!0,this},j.lockDisableZoomOut=function(){return m.disableZoomOut=!0,this},j.updateOpacity=function(){var a=svw.getPOV();if(a){var b=a.zoom;b>=k.maxZoomLevel?(h.css("opacity",.5),i.css("opacity",1)):b<=k.minZoomLevel?(h.css("opacity",1),i.css("opacity",.5)):(h.css("opacity",1),i.css("opacity",1))}return l.disableZoomIn&&h.css("opacity",.5),l.disableZoomOut&&i.css("opacity",.5),this},j.pointZoomIn=function(a,b){return l.disableZoomIn?!1:f(a,b)},j.setMaxZoomLevel=function(a){return k.maxZoomLevel=a,this},j.setMinZoomLevel=function(a){return k.minZoomLevel=a,this},j.unlockDisableZoomIn=function(){return m.disableZoomIn=!1,this},j.unlockDisableZoomOut=function(){return m.disableZoomOut=!1,this},j.zoomIn=function(){if(l.disableZoomIn)return!1;var a=svw.panorama.getPov();return g(a.zoom+1),svw.canvas.clear().render2(),this},j.zoomOut=function(){if(l.disableZoomOut)return!1;var a=svw.panorama.getPov();return g(a.zoom-1),svw.canvas.clear().render2(),this},c(b),j}!function(a){function b(a,b){B.biginteger_used=1,null!=a&&("number"==typeof a?this.fromString(Math.floor(a).toString(),10):null==b&&"string"!=typeof a?this.fromString(a,256):(-1!=a.indexOf(".")&&(a=a.substring(0,a.indexOf("."))),this.fromString(a,b)))}function c(){return new b(null)}function d(a,b,c,d,e,f){for(;0<=--f;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function e(a,b,c,d,e,f){var g=32767&b;for(b>>=15;0<=--f;){var h=32767&this[a],i=this[a++]>>15,j=b*h+i*g,h=g*h+((32767&j)<<15)+c[d]+(1073741823&e);e=(h>>>30)+(j>>>15)+b*i+(e>>>30),c[d++]=1073741823&h}return e}function f(a,b,c,d,e,f){var g=16383&b;for(b>>=14;0<=--f;){var h=16383&this[a],i=this[a++]>>14,j=b*h+i*g,h=g*h+((16383&j)<<14)+c[d]+e;e=(h>>28)+(j>>14)+b*i,c[d++]=268435455&h}return e}function g(a,b){var c=D[a.charCodeAt(b)];return null==c?-1:c}function h(a){var b=c();return b.fromInt(a),b}function i(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=a>>1&&(c+=1),c}function j(a){this.m=a}function k(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function l(a,b){return a&b}function m(a,b){return a|b}function n(a,b){return a^b}function o(a,b){return a&~b}function p(){}function q(a){return a}function r(a){this.r2=c(),this.q3=c(),b.ONE.dlShiftTo(2*a.t,this.r2),this.mu=this.r2.divide(a),this.m=a}var s,t,u,v,w,x,y,z=navigator.userAgent.toString().toLowerCase();s=-1!=z.indexOf("chrome")&&-1==z.indexOf("chromium")?1:0,t=-1!=z.indexOf("chromium")?1:0,u=-1!=z.indexOf("safari")&&-1==z.indexOf("chrome")&&-1==z.indexOf("chromium")?1:0,v=-1!=z.indexOf("firefox")?1:0,z.indexOf("firefox/17"),z.indexOf("firefox/15"),z.indexOf("firefox/3"),w=-1!=z.indexOf("opera")?1:0,z.indexOf("msie 10"),z.indexOf("msie 9"),x=-1!=z.indexOf("msie 8")?1:0,y=-1!=z.indexOf("msie 7")?1:0;var A,z=-1!=z.indexOf("msie ")?1:0,B={biginteger_used:null};"Microsoft Internet Explorer"==navigator.appName?(b.prototype.am=e,A=30):"Netscape"!=navigator.appName?(b.prototype.am=d,A=26):(b.prototype.am=f,A=28),b.prototype.DB=A,b.prototype.DM=(1<<A)-1,b.prototype.DV=1<<A,b.prototype.FV=Math.pow(2,52),b.prototype.F1=52-A,b.prototype.F2=2*A-52;var C,D=[];for(A=48,C=0;9>=C;++C)D[A++]=C;for(A=97,C=10;36>C;++C)D[A++]=C;for(A=65,C=10;36>C;++C)D[A++]=C;j.prototype.convert=function(a){return 0>a.s||0<=a.compareTo(this.m)?a.mod(this.m):a},j.prototype.revert=function(a){return a},j.prototype.reduce=function(a){a.divRemTo(this.m,null,a)},j.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},j.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},k.prototype.convert=function(a){var d=c();return a.abs().dlShiftTo(this.m.t,d),d.divRemTo(this.m,null,d),0>a.s&&0<d.compareTo(b.ZERO)&&this.m.subTo(d,d),d},k.prototype.revert=function(a){var b=c();return a.copyTo(b),this.reduce(b),b},k.prototype.reduce=function(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM,c=b+this.m.t;for(a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),0<=a.compareTo(this.m)&&a.subTo(this.m,a)},k.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},k.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)},b.prototype.copyTo=function(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s},b.prototype.fromInt=function(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0},b.prototype.fromString=function(a,c){var d;if(16==c)d=4;else if(8==c)d=3;else if(256==c)d=8;else if(2==c)d=1;else if(32==c)d=5;else{if(4!=c)return void this.fromRadix(a,c);d=2}this.s=this.t=0;for(var e=a.length,f=!1,h=0;0<=--e;){var i=8==d?255&a[e]:g(a,e);0>i?"-"==a.charAt(e)&&(f=!0):(f=!1,0==h?this[this.t++]=i:h+d>this.DB?(this[this.t-1]|=(i&(1<<this.DB-h)-1)<<h,this[this.t++]=i>>this.DB-h):this[this.t-1]|=i<<h,h+=d,h>=this.DB&&(h-=this.DB))}8==d&&0!=(128&a[0])&&(this.s=-1,h>0&&(this[this.t-1]|=(1<<this.DB-h)-1<<h)),this.clamp(),f&&b.ZERO.subTo(this,this)},b.prototype.clamp=function(){for(var a=this.s&this.DM;0<this.t&&this[this.t-1]==a;)--this.t},b.prototype.dlShiftTo=function(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s},b.prototype.drShiftTo=function(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s},b.prototype.lShiftTo=function(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()},b.prototype.rShiftTo=function(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)b.t=0;else{var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}},b.prototype.subTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()},b.prototype.multiplyTo=function(a,c){var d=this.abs(),e=a.abs(),f=d.t;for(c.t=f+e.t;0<=--f;)c[f]=0;for(f=0;f<e.t;++f)c[f+d.t]=d.am(0,e[f],c,f,0,d.t);c.s=0,c.clamp(),this.s!=a.s&&b.ZERO.subTo(c,c)},b.prototype.squareTo=function(a){for(var b=this.abs(),c=a.t=2*b.t;0<=--c;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}0<a.t&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()},b.prototype.divRemTo=function(a,d,e){var f=a.abs();if(!(0>=f.t)){var g=this.abs();if(g.t<f.t)null!=d&&d.fromInt(0),null!=e&&this.copyTo(e);else{null==e&&(e=c());var h=c(),j=this.s;a=a.s;var k=this.DB-i(f[f.t-1]);if(k>0?(f.lShiftTo(k,h),g.lShiftTo(k,e)):(f.copyTo(h),g.copyTo(e)),f=h.t,g=h[f-1],0!=g){var l=g*(1<<this.F1)+(f>1?h[f-2]>>this.F2:0),m=this.FV/l,l=(1<<this.F1)/l,n=1<<this.F2,o=e.t,p=o-f,q=null==d?c():d;for(h.dlShiftTo(p,q),0<=e.compareTo(q)&&(e[e.t++]=1,e.subTo(q,e)),b.ONE.dlShiftTo(f,q),q.subTo(h,h);h.t<f;)h[h.t++]=0;for(;0<=--p;){var r=e[--o]==g?this.DM:Math.floor(e[o]*m+(e[o-1]+n)*l);if((e[o]+=h.am(0,r,e,p,0,f))<r)for(h.dlShiftTo(p,q),e.subTo(q,e);e[o]<--r;)e.subTo(q,e)}null!=d&&(e.drShiftTo(f,d),j!=a&&b.ZERO.subTo(d,d)),e.t=f,e.clamp(),k>0&&e.rShiftTo(k,e),0>j&&b.ZERO.subTo(e,e)}}}},b.prototype.invDigit=function(){if(1>this.t)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a,b=b*(2-(15&a)*b)&15,b=b*(2-(255&a)*b)&255,b=b*(2-((65535&a)*b&65535))&65535,b=b*(2-a*b%this.DV)%this.DV;return b>0?this.DV-b:-b},b.prototype.isEven=function(){return 0==(0<this.t?1&this[0]:this.s)},b.prototype.exp=function(a,d){if(a>4294967295||1>a)return b.ONE;var e=c(),f=c(),g=d.convert(this),h=i(a)-1;for(g.copyTo(e);0<=--h;)if(d.sqrTo(e,f),(a&1<<h)>0)d.mulTo(f,g,e);else var j=e,e=f,f=j;return d.revert(e)},b.prototype.toString=function(a){if(0>this.s)return"-"+this.negate().toString(a);if(16==a)a=4;else if(8==a)a=3;else if(2==a)a=1;else if(32==a)a=5;else{if(4!=a)return this.toRadix(a);a=2}var b,c=(1<<a)-1,d=!1,e="",f=this.t,g=this.DB-f*this.DB%a;if(0<f--)for(g<this.DB&&0<(b=this[f]>>g)&&(d=!0,e="0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));f>=0;)a>g?(b=(this[f]&(1<<g)-1)<<a-g,b|=this[--f]>>(g+=this.DB-a)):(b=this[f]>>(g-=a)&c,0>=g&&(g+=this.DB,--f)),b>0&&(d=!0),d&&(e+="0123456789abcdefghijklmnopqrstuvwxyz".charAt(b));return d?e:"0"},b.prototype.negate=function(){var a=c();return b.ZERO.subTo(this,a),a},b.prototype.abs=function(){return 0>this.s?this.negate():this},b.prototype.compareTo=function(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t,b=c-a.t;if(0!=b)return 0>this.s?-b:b;for(;0<=--c;)if(0!=(b=this[c]-a[c]))return b;return 0},b.prototype.bitLength=function(){return 0>=this.t?0:this.DB*(this.t-1)+i(this[this.t-1]^this.s&this.DM)},b.prototype.mod=function(a){var d=c();return this.abs().divRemTo(a,null,d),0>this.s&&0<d.compareTo(b.ZERO)&&a.subTo(d,d),d},b.prototype.modPowInt=function(a,b){var c;return c=256>a||b.isEven()?new j(b):new k(b),this.exp(a,c)},b.ZERO=h(0),b.ONE=h(1),p.prototype.convert=q,p.prototype.revert=q,p.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c)},p.prototype.sqrTo=function(a,b){a.squareTo(b)},r.prototype.convert=function(a){if(0>a.s||a.t>2*this.m.t)return a.mod(this.m);if(0>a.compareTo(this.m))return a;var b=c();return a.copyTo(b),this.reduce(b),b},r.prototype.revert=function(a){return a},r.prototype.reduce=function(a){for(a.drShiftTo(this.m.t-1,this.r2),a.t>this.m.t+1&&(a.t=this.m.t+1,a.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);0>a.compareTo(this.r2);)a.dAddOffset(1,this.m.t+1);for(a.subTo(this.r2,a);0<=a.compareTo(this.m);)a.subTo(this.m,a)},r.prototype.mulTo=function(a,b,c){a.multiplyTo(b,c),this.reduce(c)},r.prototype.sqrTo=function(a,b){a.squareTo(b),this.reduce(b)};var E=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],F=67108864/E[E.length-1];b.prototype.chunkSize=function(a){return Math.floor(Math.LN2*this.DB/Math.log(a))},b.prototype.toRadix=function(a){if(null==a&&(a=10),0==this.signum()||2>a||a>36)return"0";var b=this.chunkSize(a),b=Math.pow(a,b),d=h(b),e=c(),f=c(),g="";for(this.divRemTo(d,e,f);0<e.signum();)g=(b+f.intValue()).toString(a).substr(1)+g,e.divRemTo(d,e,f);return f.intValue().toString(a)+g},b.prototype.fromRadix=function(a,c){this.fromInt(0),null==c&&(c=10);for(var d=this.chunkSize(c),e=Math.pow(c,d),f=!1,h=0,i=0,j=0;j<a.length;++j){var k=g(a,j);0>k?"-"==a.charAt(j)&&0==this.signum()&&(f=!0):(i=c*i+k,++h>=d&&(this.dMultiply(e),this.dAddOffset(i,0),i=h=0))}h>0&&(this.dMultiply(Math.pow(c,h)),this.dAddOffset(i,0)),f&&b.ZERO.subTo(this,this)},b.prototype.fromNumber=function(a,c,d){if("number"==typeof c)if(2>a)this.fromInt(1);else for(this.fromNumber(a,d),this.testBit(a-1)||this.bitwiseTo(b.ONE.shiftLeft(a-1),m,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(c);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(b.ONE.shiftLeft(a-1),this);else{d=[];var e=7&a;d.length=(a>>3)+1,c.nextBytes(d),d[0]=e>0?d[0]&(1<<e)-1:0,this.fromString(d,256)}},b.prototype.bitwiseTo=function(a,b,c){var d,e,f=Math.min(a.t,this.t);for(d=0;f>d;++d)c[d]=b(this[d],a[d]);if(a.t<this.t){for(e=a.s&this.DM,d=f;d<this.t;++d)c[d]=b(this[d],e);c.t=this.t}else{for(e=this.s&this.DM,d=f;d<a.t;++d)c[d]=b(e,a[d]);c.t=a.t}c.s=b(this.s,a.s),c.clamp()},b.prototype.changeBit=function(a,c){var d=b.ONE.shiftLeft(a);return this.bitwiseTo(d,c,d),d},b.prototype.addTo=function(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]+a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d+=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d+=a[c],b[c++]=d&this.DM,d>>=this.DB;d+=a.s}b.s=0>d?-1:0,d>0?b[c++]=d:-1>d&&(b[c++]=this.DV+d),b.t=c,b.clamp()},b.prototype.dMultiply=function(a){this[this.t]=this.am(0,a-1,this,0,0,this.t),++this.t,this.clamp()},b.prototype.dAddOffset=function(a,b){
if(0!=a){for(;this.t<=b;)this[this.t++]=0;for(this[b]+=a;this[b]>=this.DV;)this[b]-=this.DV,++b>=this.t&&(this[this.t++]=0),++this[b]}},b.prototype.multiplyLowerTo=function(a,b,c){var d=Math.min(this.t+a.t,b);for(c.s=0,c.t=d;d>0;)c[--d]=0;var e;for(e=c.t-this.t;e>d;++d)c[d+this.t]=this.am(0,a[d],c,d,0,this.t);for(e=Math.min(a.t,b);e>d;++d)this.am(0,a[d],c,d,0,b-d);c.clamp()},b.prototype.multiplyUpperTo=function(a,b,c){--b;var d=c.t=this.t+a.t-b;for(c.s=0;0<=--d;)c[d]=0;for(d=Math.max(b-this.t,0);d<a.t;++d)c[this.t+d-b]=this.am(b-d,a[d],c,0,0,this.t+d-b);c.clamp(),c.drShiftTo(1,c)},b.prototype.modInt=function(a){if(0>=a)return 0;var b=this.DV%a,c=0>this.s?a-1:0;if(0<this.t)if(0==b)c=this[0]%a;else for(var d=this.t-1;d>=0;--d)c=(b*c+this[d])%a;return c},b.prototype.millerRabin=function(a){var d=this.subtract(b.ONE),e=d.getLowestSetBit();if(0>=e)return!1;var f=d.shiftRight(e);a=a+1>>1,a>E.length&&(a=E.length);for(var g=c(),h=0;a>h;++h){g.fromInt(E[Math.floor(Math.random()*E.length)]);var i=g.modPow(f,this);if(0!=i.compareTo(b.ONE)&&0!=i.compareTo(d)){for(var j=1;j++<e&&0!=i.compareTo(d);)if(i=i.modPowInt(2,this),0==i.compareTo(b.ONE))return!1;if(0!=i.compareTo(d))return!1}}return!0},b.prototype.clone=function(){var a=c();return this.copyTo(a),a},b.prototype.intValue=function(){if(0>this.s){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},b.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},b.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},b.prototype.signum=function(){return 0>this.s?-1:0>=this.t||1==this.t&&0>=this[0]?0:1},b.prototype.toByteArray=function(){var a=this.t,b=[];b[0]=this.s;var c,d=this.DB-a*this.DB%8,e=0;if(0<a--)for(d<this.DB&&(c=this[a]>>d)!=(this.s&this.DM)>>d&&(b[e++]=c|this.s<<this.DB-d);a>=0;)8>d?(c=(this[a]&(1<<d)-1)<<8-d,c|=this[--a]>>(d+=this.DB-8)):(c=this[a]>>(d-=8)&255,0>=d&&(d+=this.DB,--a)),0!=(128&c)&&(c|=-256),0==e&&(128&this.s)!=(128&c)&&++e,(e>0||c!=this.s)&&(b[e++]=c);return b},b.prototype.equals=function(a){return 0==this.compareTo(a)},b.prototype.min=function(a){return 0>this.compareTo(a)?this:a},b.prototype.max=function(a){return 0<this.compareTo(a)?this:a},b.prototype.and=function(a){var b=c();return this.bitwiseTo(a,l,b),b},b.prototype.or=function(a){var b=c();return this.bitwiseTo(a,m,b),b},b.prototype.xor=function(a){var b=c();return this.bitwiseTo(a,n,b),b},b.prototype.andNot=function(a){var b=c();return this.bitwiseTo(a,o,b),b},b.prototype.not=function(){for(var a=c(),b=0;b<this.t;++b)a[b]=this.DM&~this[b];return a.t=this.t,a.s=~this.s,a},b.prototype.shiftLeft=function(a){var b=c();return 0>a?this.rShiftTo(-a,b):this.lShiftTo(a,b),b},b.prototype.shiftRight=function(a){var b=c();return 0>a?this.lShiftTo(-a,b):this.rShiftTo(a,b),b},b.prototype.getLowestSetBit=function(){for(var a=0;a<this.t;++a)if(0!=this[a]){var b=a*this.DB;if(a=this[a],0==a)a=-1;else{var c=0;0==(65535&a)&&(a>>=16,c+=16),0==(255&a)&&(a>>=8,c+=8),0==(15&a)&&(a>>=4,c+=4),0==(3&a)&&(a>>=2,c+=2),0==(1&a)&&++c,a=c}return b+a}return 0>this.s?this.t*this.DB:-1},b.prototype.bitCount=function(){for(var a=0,b=this.s&this.DM,c=0;c<this.t;++c){for(var d=this[c]^b,e=0;0!=d;)d&=d-1,++e;a+=e}return a},b.prototype.testBit=function(a){var b=Math.floor(a/this.DB);return b>=this.t?0!=this.s:0!=(this[b]&1<<a%this.DB)},b.prototype.setBit=function(a){return this.changeBit(a,m)},b.prototype.clearBit=function(a){return this.changeBit(a,o)},b.prototype.flipBit=function(a){return this.changeBit(a,n)},b.prototype.add=function(a){var b=c();return this.addTo(a,b),b},b.prototype.subtract=function(a){var b=c();return this.subTo(a,b),b},b.prototype.multiply=function(a){var b=c();return this.multiplyTo(a,b),b},b.prototype.divide=function(a){var b=c();return this.divRemTo(a,b,null),b},b.prototype.remainder=function(a){var b=c();return this.divRemTo(a,null,b),b},b.prototype.divideAndRemainder=function(a){var b=c(),d=c();return this.divRemTo(a,b,d),[b,d]},b.prototype.modPow=function(a,b){var d,e,f=a.bitLength(),g=h(1);if(0>=f)return g;d=18>f?1:48>f?3:144>f?4:768>f?5:6,e=8>f?new j(b):b.isEven()?new r(b):new k(b);var l=[],m=3,n=d-1,o=(1<<d)-1;if(l[1]=e.convert(this),d>1)for(f=c(),e.sqrTo(l[1],f);o>=m;)l[m]=c(),e.mulTo(f,l[m-2],l[m]),m+=2;for(var p,q=a.t-1,s=!0,t=c(),f=i(a[q])-1;q>=0;){for(f>=n?p=a[q]>>f-n&o:(p=(a[q]&(1<<f+1)-1)<<n-f,q>0&&(p|=a[q-1]>>this.DB+f-n)),m=d;0==(1&p);)p>>=1,--m;if(0>(f-=m)&&(f+=this.DB,--q),s)l[p].copyTo(g),s=!1;else{for(;m>1;)e.sqrTo(g,t),e.sqrTo(t,g),m-=2;m>0?e.sqrTo(g,t):(m=g,g=t,t=m),e.mulTo(t,l[p],g)}for(;q>=0&&0==(a[q]&1<<f);)e.sqrTo(g,t),m=g,g=t,t=m,0>--f&&(f=this.DB-1,--q)}return e.revert(g)},b.prototype.modInverse=function(a){var c=a.isEven();if(this.isEven()&&c||0==a.signum())return b.ZERO;for(var d=a.clone(),e=this.clone(),f=h(1),g=h(0),i=h(0),j=h(1);0!=d.signum();){for(;d.isEven();)d.rShiftTo(1,d),c?(f.isEven()&&g.isEven()||(f.addTo(this,f),g.subTo(a,g)),f.rShiftTo(1,f)):g.isEven()||g.subTo(a,g),g.rShiftTo(1,g);for(;e.isEven();)e.rShiftTo(1,e),c?(i.isEven()&&j.isEven()||(i.addTo(this,i),j.subTo(a,j)),i.rShiftTo(1,i)):j.isEven()||j.subTo(a,j),j.rShiftTo(1,j);0<=d.compareTo(e)?(d.subTo(e,d),c&&f.subTo(i,f),g.subTo(j,g)):(e.subTo(d,e),c&&i.subTo(f,i),j.subTo(g,j))}return 0!=e.compareTo(b.ONE)?b.ZERO:0<=j.compareTo(a)?j.subtract(a):0>j.signum()?(j.addTo(a,j),0>j.signum()?j.add(a):j):j},b.prototype.pow=function(a){return this.exp(a,new p)},b.prototype.gcd=function(a){var b=0>this.s?this.negate():this.clone();if(a=0>a.s?a.negate():a.clone(),0>b.compareTo(a)){var c=b,b=a;a=c}var c=b.getLowestSetBit(),d=a.getLowestSetBit();if(0>d)return b;for(d>c&&(d=c),d>0&&(b.rShiftTo(d,b),a.rShiftTo(d,a));0<b.signum();)0<(c=b.getLowestSetBit())&&b.rShiftTo(c,b),0<(c=a.getLowestSetBit())&&a.rShiftTo(c,a),0<=b.compareTo(a)?(b.subTo(a,b),b.rShiftTo(1,b)):(a.subTo(b,a),a.rShiftTo(1,a));return d>0&&a.lShiftTo(d,a),a},b.prototype.isProbablePrime=function(a){var b,c=this.abs();if(1==c.t&&c[0]<=E[E.length-1]){for(b=0;b<E.length;++b)if(c[0]==E[b])return!0;return!1}if(c.isEven())return!1;for(b=1;b<E.length;){for(var d=E[b],e=b+1;e<E.length&&F>d;)d*=E[e++];for(d=c.modInt(d);e>b;)if(0==d%E[b++])return!1}return c.millerRabin(a)},b.prototype.square=function(){var a=c();return this.squareTo(a),a},B.Math_Abs_Int64=B.Math_Abs_Int32=B.Math_Abs_Double=function(a){return Math.abs(a)},B.Math_Max_Int32_Int32=function(a,b){return Math.max(a,b)},B.Cast_Int32=z||w||u?function(a){return 0|a}:function(a){return~~a},B.Cast_Int64=s?function(a){return-2147483648>a||a>2147483647?0>a?Math.ceil(a):Math.floor(a):~~a}:v&&"function"==typeof Number.toInteger?function(a){return Number.toInteger(a)}:y||x?function(a){return parseInt(a,10)}:z?function(a){return-2147483648>a||a>2147483647?0>a?Math.ceil(a):Math.floor(a):0|a}:function(a){return 0>a?Math.ceil(a):Math.floor(a)},B.Clear=function(a){a.length=0},B.MaxSteps=64,B.PI=3.141592653589793,B.PI2=6.283185307179586,B.IntPoint=function(){var a=arguments;1==a.length&&(this.X=a[0].X,this.Y=a[0].Y),2==a.length&&(this.X=a[0],this.Y=a[1])},B.IntRect=function(){var a=arguments;if(4==a.length){var b=a[1],c=a[2],d=a[3];this.left=a[0],this.top=b,this.right=c,this.bottom=d}else this.bottom=this.right=this.top=this.left=0},B.Polygon=function(){return[]},B.Polygons=function(){return[[]]},B.ExPolygon=function(){this.holes=this.outer=null},B.ClipType={ctIntersection:0,ctUnion:1,ctDifference:2,ctXor:3},B.PolyType={ptSubject:0,ptClip:1},B.PolyFillType={pftEvenOdd:0,pftNonZero:1,pftPositive:2,pftNegative:3},B.JoinType={jtSquare:0,jtRound:1,jtMiter:2},B.EdgeSide={esLeft:1,esRight:2},B.Protects={ipNone:0,ipLeft:1,ipRight:2,ipBoth:3},B.Direction={dRightToLeft:0,dLeftToRight:1},B.TEdge=function(){this.tmpX=this.deltaY=this.deltaX=this.dx=this.ytop=this.xtop=this.ycurr=this.xcurr=this.ybot=this.xbot=0,this.polyType=B.PolyType.ptSubject,this.side=null,this.outIdx=this.windCnt2=this.windCnt=this.windDelta=0,this.prevInSEL=this.nextInSEL=this.prevInAEL=this.nextInAEL=this.nextInLML=this.prev=this.next=null},B.IntersectNode=function(){this.next=this.pt=this.edge2=this.edge1=null},B.LocalMinima=function(){this.Y=0,this.next=this.rightBound=this.leftBound=null},B.Scanbeam=function(){this.Y=0,this.next=null},B.OutRec=function(){this.idx=0,this.isHole=!1,this.bottomPt=this.pts=this.AppendLink=this.FirstLeft=null},B.OutPt=function(){this.idx=0,this.prev=this.next=this.pt=null},B.JoinRec=function(){this.pt1b=this.pt1a=null,this.poly1Idx=0,this.pt2b=this.pt2a=null,this.poly2Idx=0},B.HorzJoinRec=function(){this.edge=null,this.savedIdx=0},B.ClipperBase=function(){this.m_CurrentLM=this.m_MinimaList=null,this.m_edges=[[]],this.m_UseFullRange=!1},B.ClipperBase.horizontal=-9007199254740992,B.ClipperBase.loRange=47453132,B.ClipperBase.hiRange=0xfffffffffffff,B.ClipperBase.PointsEqual=function(a,b){return a.X==b.X&&a.Y==b.Y},B.ClipperBase.prototype.PointIsVertex=function(a,b){var c=b;do{if(B.ClipperBase.PointsEqual(c.pt,a))return!0;c=c.next}while(c!=b);return!1},B.ClipperBase.prototype.PointInPolygon=function(a,c,d){var e=c,f=!1;if(d){do(e.pt.Y<=a.Y&&a.Y<e.prev.pt.Y||e.prev.pt.Y<=a.Y&&a.Y<e.pt.Y)&&0>new b(a.X-e.pt.X).compareTo(new b(e.prev.pt.X-e.pt.X).multiply(new b(a.Y-e.pt.Y)).divide(new b(e.prev.pt.Y-e.pt.Y)))&&(f=!f),e=e.next;while(e!=c)}else do(e.pt.Y<=a.Y&&a.Y<e.prev.pt.Y||e.prev.pt.Y<=a.Y&&a.Y<e.pt.Y)&&a.X-e.pt.X<(e.prev.pt.X-e.pt.X)*(a.Y-e.pt.Y)/(e.prev.pt.Y-e.pt.Y)&&(f=!f),e=e.next;while(e!=c);return f},B.ClipperBase.prototype.SlopesEqual=function(){var a,c,d,e,f=arguments;return 3==f.length?(a=f[0],c=f[1],(f=f[2])?new b(a.deltaY).multiply(new b(c.deltaX)).toString()==new b(a.deltaX).multiply(new b(c.deltaY)).toString():a.deltaY*c.deltaX==a.deltaX*c.deltaY):4==f.length?(a=f[0],c=f[1],d=f[2],(f=f[3])?new b(a.Y-c.Y).multiply(new b(c.X-d.X)).toString()==new b(a.X-c.X).multiply(new b(c.Y-d.Y)).toString():0==(a.Y-c.Y)*(c.X-d.X)-(a.X-c.X)*(c.Y-d.Y)):5==f.length?(a=f[0],c=f[1],d=f[2],e=f[3],(f=f[4])?new b(a.Y-c.Y).multiply(new b(d.X-e.X)).toString()==new b(a.X-c.X).multiply(new b(d.Y-e.Y)).toString():0==(a.Y-c.Y)*(d.X-e.X)-(a.X-c.X)*(d.Y-e.Y)):void 0},B.ClipperBase.prototype.Clear=function(){this.DisposeLocalMinimaList();for(var a=0;a<this.m_edges.length;++a){for(var b=0;b<this.m_edges[a].length;++b)this.m_edges[a][b]=null;B.Clear(this.m_edges[a])}B.Clear(this.m_edges),this.m_UseFullRange=!1},B.ClipperBase.prototype.DisposeLocalMinimaList=function(){for(;null!=this.m_MinimaList;){var a=this.m_MinimaList.next;this.m_MinimaList=null,this.m_MinimaList=a}this.m_CurrentLM=null},B.ClipperBase.prototype.AddPolygons=function(a,b){var c=!1,d=!1;if(!(a instanceof Array))return c;for(var e=0;e<a.length;++e)if((d=this.AddPolygon(a[e],b,!0))&&"exceed"!=d)c=!0;else if("exceed"==d)break;return"exceed"==d&&B.Error("Coordinate exceeds range bounds in AddPolygons()."),c},B.ClipperBase.prototype.AddPolygon=function(a,b,c){if(!(a instanceof Array))return!1;var d=a.length;if(3>d)return!1;var e=new B.Polygon;e.push(new B.IntPoint(a[0].X,a[0].Y));var f,g=0,h=!1;for(f=1;d>f;++f){var i;if(i=this.m_UseFullRange?B.ClipperBase.hiRange:B.ClipperBase.loRange,B.Math_Abs_Int64(a[f].X)>i||B.Math_Abs_Int64(a[f].Y)>i){if(B.Math_Abs_Int64(a[f].X)>B.ClipperBase.hiRange||B.Math_Abs_Int64(a[f].Y)>B.ClipperBase.hiRange){if("undefined"!=typeof c)return"exceed";h=!0;break}this.m_UseFullRange=!0}B.ClipperBase.PointsEqual(e[g],a[f])||(g>0&&this.SlopesEqual(e[g-1],e[g],a[f],this.m_UseFullRange)?B.ClipperBase.PointsEqual(e[g-1],a[f])&&g--:g++,g<e.length?e[g]=a[f]:e.push(new B.IntPoint(a[f].X,a[f].Y)))}if(h&&"undefined"==typeof c&&B.Error("Coordinate exceeds range bounds in AddPolygon()"),2>g)return!1;for(d=g+1;d>2;){if(B.ClipperBase.PointsEqual(e[g],e[0]))g--;else if(B.ClipperBase.PointsEqual(e[0],e[1])||this.SlopesEqual(e[g],e[0],e[1],this.m_UseFullRange))e[0]=e[g--];else if(this.SlopesEqual(e[g-1],e[g],e[0],this.m_UseFullRange))g--;else{if(!this.SlopesEqual(e[0],e[1],e[2],this.m_UseFullRange))break;for(f=2;g>=f;++f)e[f-1]=e[f];g--}d--}if(3>d)return!1;for(a=[],f=0;d>f;f++)a.push(new B.TEdge);for(this.m_edges.push(a),a[0].xcurr=e[0].X,a[0].ycurr=e[0].Y,this.InitEdge(a[d-1],a[0],a[d-2],e[d-1],b),f=d-2;f>0;--f)this.InitEdge(a[f],a[f+1],a[f-1],e[f],b);this.InitEdge(a[0],a[1],a[d-1],e[0],b),d=b=a[0];do b.xcurr=b.xbot,b.ycurr=b.ybot,b.ytop<d.ytop&&(d=b),b=b.next;while(b!=a[0]);0<d.windDelta&&(d=d.next),d.dx==B.ClipperBase.horizontal&&(d=d.next),b=d;do b=this.AddBoundsToLML(b);while(b!=d);return!0},B.ClipperBase.prototype.InitEdge=function(a,b,c,d,e){a.next=b,a.prev=c,a.xcurr=d.X,a.ycurr=d.Y,a.ycurr>=a.next.ycurr?(a.xbot=a.xcurr,a.ybot=a.ycurr,a.xtop=a.next.xcurr,a.ytop=a.next.ycurr,a.windDelta=1):(a.xtop=a.xcurr,a.ytop=a.ycurr,a.xbot=a.next.xcurr,a.ybot=a.next.ycurr,a.windDelta=-1),this.SetDx(a),a.polyType=e,a.outIdx=-1},B.ClipperBase.prototype.SetDx=function(a){a.deltaX=a.xtop-a.xbot,a.deltaY=a.ytop-a.ybot,a.dx=0==a.deltaY?B.ClipperBase.horizontal:a.deltaX/a.deltaY},B.ClipperBase.prototype.AddBoundsToLML=function(a){for(a.nextInLML=null,a=a.next;;){if(a.dx==B.ClipperBase.horizontal){if(a.next.ytop<a.ytop&&a.next.xbot>a.prev.xbot)break;a.xtop!=a.prev.xbot&&this.SwapX(a),a.nextInLML=a.prev}else{if(a.ycurr==a.prev.ycurr)break;a.nextInLML=a.prev}a=a.next}var b=new B.LocalMinima;for(b.next=null,b.Y=a.prev.ybot,a.dx==B.ClipperBase.horizontal?(a.xbot!=a.prev.xbot&&this.SwapX(a),b.leftBound=a.prev,b.rightBound=a):a.dx<a.prev.dx?(b.leftBound=a.prev,b.rightBound=a):(b.leftBound=a,b.rightBound=a.prev),b.leftBound.side=B.EdgeSide.esLeft,b.rightBound.side=B.EdgeSide.esRight,this.InsertLocalMinima(b);a.next.ytop!=a.ytop||a.next.dx==B.ClipperBase.horizontal;)a=a.nextInLML=a.next,a.dx==B.ClipperBase.horizontal&&a.xbot!=a.prev.xtop&&this.SwapX(a);return a.next},B.ClipperBase.prototype.InsertLocalMinima=function(a){if(null==this.m_MinimaList)this.m_MinimaList=a;else if(a.Y>=this.m_MinimaList.Y)a.next=this.m_MinimaList,this.m_MinimaList=a;else{for(var b=this.m_MinimaList;null!=b.next&&a.Y<b.next.Y;)b=b.next;a.next=b.next,b.next=a}},B.ClipperBase.prototype.PopLocalMinima=function(){null!=this.m_CurrentLM&&(this.m_CurrentLM=this.m_CurrentLM.next)},B.ClipperBase.prototype.SwapX=function(a){a.xcurr=a.xtop,a.xtop=a.xbot,a.xbot=a.xcurr},B.ClipperBase.prototype.Reset=function(){for(var a=this.m_CurrentLM=this.m_MinimaList;null!=a;){for(var b=a.leftBound;null!=b;)b.xcurr=b.xbot,b.ycurr=b.ybot,b.side=B.EdgeSide.esLeft,b.outIdx=-1,b=b.nextInLML;for(b=a.rightBound;null!=b;)b.xcurr=b.xbot,b.ycurr=b.ybot,b.side=B.EdgeSide.esRight,b.outIdx=-1,b=b.nextInLML;a=a.next}},B.ClipperBase.prototype.GetBounds=function(){var a=new B.IntRect,b=this.m_MinimaList;if(null==b)return a;for(a.left=b.leftBound.xbot,a.top=b.leftBound.ybot,a.right=b.leftBound.xbot,a.bottom=b.leftBound.ybot;null!=b;){b.leftBound.ybot>a.bottom&&(a.bottom=b.leftBound.ybot);for(var c=b.leftBound;;){for(var d=c;null!=c.nextInLML;)c.xbot<a.left&&(a.left=c.xbot),c.xbot>a.right&&(a.right=c.xbot),c=c.nextInLML;if(c.xbot<a.left&&(a.left=c.xbot),c.xbot>a.right&&(a.right=c.xbot),c.xtop<a.left&&(a.left=c.xtop),c.xtop>a.right&&(a.right=c.xtop),c.ytop<a.top&&(a.top=c.ytop),d!=b.leftBound)break;c=b.rightBound}b=b.next}return a},B.Clipper=function(){this.m_PolyOuts=null,this.m_ClipType=B.ClipType.ctIntersection,this.m_IntersectNodes=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null,this.m_ExecuteLocked=!1,this.m_SubjFillType=this.m_ClipFillType=B.PolyFillType.pftEvenOdd,this.m_HorizJoins=this.m_Joins=null,this.m_UsingExPolygons=this.m_ReverseOutput=!1,B.ClipperBase.call(this),this.m_IntersectNodes=this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null,this.m_ExecuteLocked=!1,this.m_PolyOuts=[],this.m_Joins=[],this.m_HorizJoins=[],this.m_UsingExPolygons=this.m_ReverseOutput=!1},B.Clipper.prototype.Clear=function(){0!=this.m_edges.length&&(this.DisposeAllPolyPts(),B.ClipperBase.prototype.Clear.call(this))},B.Clipper.prototype.DisposeScanbeamList=function(){for(;null!=this.m_Scanbeam;){var a=this.m_Scanbeam.next;this.m_Scanbeam=null,this.m_Scanbeam=a}},B.Clipper.prototype.Reset=function(){B.ClipperBase.prototype.Reset.call(this),this.m_SortedEdges=this.m_ActiveEdges=this.m_Scanbeam=null,this.DisposeAllPolyPts();for(var a=this.m_MinimaList;null!=a;)this.InsertScanbeam(a.Y),this.InsertScanbeam(a.leftBound.ytop),a=a.next},B.Clipper.prototype.get_ReverseSolution=function(){return this.m_ReverseOutput},B.Clipper.prototype.set_ReverseSolution=function(a){this.m_ReverseOutput=a},B.Clipper.prototype.InsertScanbeam=function(a){var b;if(null==this.m_Scanbeam)this.m_Scanbeam=new B.Scanbeam,this.m_Scanbeam.next=null,this.m_Scanbeam.Y=a;else if(a>this.m_Scanbeam.Y)b=new B.Scanbeam,b.Y=a,b.next=this.m_Scanbeam,this.m_Scanbeam=b;else{for(var c=this.m_Scanbeam;null!=c.next&&a<=c.next.Y;)c=c.next;a!=c.Y&&(b=new B.Scanbeam,b.Y=a,b.next=c.next,c.next=b)}},B.Clipper.prototype.Execute=function(a,b,c,d){var e;if(2==arguments.length&&(d=c=B.PolyFillType.pftEvenOdd),b.hasOwnProperty("outer")){if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,B.Clear(b),this.m_SubjFillType=c,this.m_ClipFillType=d,this.m_ClipType=a,this.m_UsingExPolygons=!0,(e=this.ExecuteInternal())&&this.BuildResultEx(b)}else{if(this.m_ExecuteLocked)return!1;this.m_ExecuteLocked=!0,B.Clear(b),this.m_SubjFillType=c,this.m_ClipFillType=d,this.m_ClipType=a,this.m_UsingExPolygons=!1,(e=this.ExecuteInternal())&&this.BuildResult(b)}return this.m_ExecuteLocked=!1,e},B.Clipper.prototype.PolySort=function(a,b){if(a==b)return 0;if(null==a.pts||null==b.pts)return null==a.pts!=(null==b.pts)?null==a.pts?1:-1:0;var c=(a.isHole?a.FirstLeft.idx:a.idx)-(b.isHole?b.FirstLeft.idx:b.idx);return 0==c&&a.isHole!=b.isHole?a.isHole?1:-1:c},B.Clipper.prototype.FindAppendLinkEnd=function(a){for(;null!=a.AppendLink;)a=a.AppendLink;return a},B.Clipper.prototype.FixHoleLinkage=function(a){var b;b=null!=a.bottomPt?this.m_PolyOuts[a.bottomPt.idx].FirstLeft:a.FirstLeft,a==b&&B.Error("HoleLinkage error"),null!=b&&(null!=b.AppendLink&&(b=this.FindAppendLinkEnd(b)),b==a?b=null:b.isHole&&(this.FixHoleLinkage(b),b=b.FirstLeft)),a.FirstLeft=b,null==b&&(a.isHole=!1),a.AppendLink=null},B.Clipper.prototype.ExecuteInternal=function(){var a;try{if(this.Reset(),null==this.m_CurrentLM)return!0;var b=this.PopScanbeam();do{this.InsertLocalMinimaIntoAEL(b),B.Clear(this.m_HorizJoins),this.ProcessHorizontals();var c=this.PopScanbeam();if(a=this.ProcessIntersections(b,c),!a)break;this.ProcessEdgesAtTopOfScanbeam(c),b=c}while(null!=this.m_Scanbeam)}catch(d){a=!1}if(a){for(c=0;c<this.m_PolyOuts.length;c++)b=this.m_PolyOuts[c],null!=b.pts&&(this.FixupOutPolygon(b),null!=b.pts&&(b.isHole&&this.m_UsingExPolygons&&this.FixHoleLinkage(b),(b.isHole^this.m_ReverseOutput)==0<this.Area(b,this.m_UseFullRange)&&this.ReversePolyPtLinks(b.pts)));this.JoinCommonEdges(),this.m_UsingExPolygons&&this.m_PolyOuts.sort(this.PolySort)}return B.Clear(this.m_Joins),B.Clear(this.m_HorizJoins),a},B.Clipper.prototype.PopScanbeam=function(){var a=this.m_Scanbeam.Y;return this.m_Scanbeam=this.m_Scanbeam.next,a},B.Clipper.prototype.DisposeAllPolyPts=function(){for(var a=0;a<this.m_PolyOuts.length;++a)this.DisposeOutRec(a);B.Clear(this.m_PolyOuts)},B.Clipper.prototype.DisposeOutRec=function(a){var b=this.m_PolyOuts[a];null!=b.pts&&this.DisposeOutPts(b.pts),this.m_PolyOuts[a]=null},B.Clipper.prototype.DisposeOutPts=function(a){if(null!=a)for(a.prev.next=null;null!=a;)a=a.next},B.Clipper.prototype.AddJoin=function(a,b,c,d){var e=new B.JoinRec;e.poly1Idx=c>=0?c:a.outIdx,e.pt1a=new B.IntPoint(a.xcurr,a.ycurr),e.pt1b=new B.IntPoint(a.xtop,a.ytop),e.poly2Idx=d>=0?d:b.outIdx,e.pt2a=new B.IntPoint(b.xcurr,b.ycurr),e.pt2b=new B.IntPoint(b.xtop,b.ytop),this.m_Joins.push(e)},B.Clipper.prototype.AddHorzJoin=function(a,b){var c=new B.HorzJoinRec;c.edge=a,c.savedIdx=b,this.m_HorizJoins.push(c)},B.Clipper.prototype.InsertLocalMinimaIntoAEL=function(a){for(var b,c;null!=this.m_CurrentLM&&this.m_CurrentLM.Y==a;){var d=this.m_CurrentLM.leftBound,e=this.m_CurrentLM.rightBound;if(this.InsertEdgeIntoAEL(d),this.InsertScanbeam(d.ytop),this.InsertEdgeIntoAEL(e),this.IsEvenOddFillType(d)?(d.windDelta=1,e.windDelta=1):e.windDelta=-d.windDelta,this.SetWindingCount(d),e.windCnt=d.windCnt,e.windCnt2=d.windCnt2,e.dx==B.ClipperBase.horizontal?(this.AddEdgeToSEL(e),this.InsertScanbeam(e.nextInLML.ytop)):this.InsertScanbeam(e.ytop),this.IsContributing(d)&&this.AddLocalMinPoly(d,e,new B.IntPoint(d.xcurr,this.m_CurrentLM.Y)),0<=e.outIdx&&e.dx==B.ClipperBase.horizontal)for(var f=0;f<this.m_HorizJoins.length;f++){b=new B.IntPoint,c=new B.IntPoint;var g=this.m_HorizJoins[f];b={Value:b},c={Value:c},this.GetOverlapSegment(new B.IntPoint(g.edge.xbot,g.edge.ybot),new B.IntPoint(g.edge.xtop,g.edge.ytop),new B.IntPoint(e.xbot,e.ybot),new B.IntPoint(e.xtop,e.ytop),b,c)&&this.AddJoin(g.edge,e,g.savedIdx,-1)}if(d.nextInAEL!=e)for(0<=e.outIdx&&0<=e.prevInAEL.outIdx&&this.SlopesEqual(e.prevInAEL,e,this.m_UseFullRange)&&this.AddJoin(e,e.prevInAEL,-1,-1),c=d.nextInAEL,b=new B.IntPoint(d.xcurr,d.ycurr);c!=e;)null==c&&B.Error("InsertLocalMinimaIntoAEL: missing rightbound!"),this.IntersectEdges(e,c,b,B.Protects.ipNone),c=c.nextInAEL;this.PopLocalMinima()}},B.Clipper.prototype.InsertEdgeIntoAEL=function(a){if(a.prevInAEL=null,a.nextInAEL=null,null==this.m_ActiveEdges)this.m_ActiveEdges=a;else if(this.E2InsertsBeforeE1(this.m_ActiveEdges,a))a.nextInAEL=this.m_ActiveEdges,this.m_ActiveEdges=this.m_ActiveEdges.prevInAEL=a;else{for(var b=this.m_ActiveEdges;null!=b.nextInAEL&&!this.E2InsertsBeforeE1(b.nextInAEL,a);)b=b.nextInAEL;a.nextInAEL=b.nextInAEL,null!=b.nextInAEL&&(b.nextInAEL.prevInAEL=a),a.prevInAEL=b,b.nextInAEL=a}},B.Clipper.prototype.E2InsertsBeforeE1=function(a,b){return b.xcurr==a.xcurr?b.dx>a.dx:b.xcurr<a.xcurr},B.Clipper.prototype.IsEvenOddFillType=function(a){return a.polyType==B.PolyType.ptSubject?this.m_SubjFillType==B.PolyFillType.pftEvenOdd:this.m_ClipFillType==B.PolyFillType.pftEvenOdd},B.Clipper.prototype.IsEvenOddAltFillType=function(a){return a.polyType==B.PolyType.ptSubject?this.m_ClipFillType==B.PolyFillType.pftEvenOdd:this.m_SubjFillType==B.PolyFillType.pftEvenOdd},B.Clipper.prototype.IsContributing=function(a){var b,c;switch(a.polyType==B.PolyType.ptSubject?(b=this.m_SubjFillType,c=this.m_ClipFillType):(b=this.m_ClipFillType,c=this.m_SubjFillType),b){case B.PolyFillType.pftEvenOdd:case B.PolyFillType.pftNonZero:if(1!=B.Math_Abs_Int32(a.windCnt))return!1;break;case B.PolyFillType.pftPositive:if(1!=a.windCnt)return!1;break;default:if(-1!=a.windCnt)return!1}switch(this.m_ClipType){case B.ClipType.ctIntersection:switch(c){case B.PolyFillType.pftEvenOdd:case B.PolyFillType.pftNonZero:return 0!=a.windCnt2;case B.PolyFillType.pftPositive:return 0<a.windCnt2;default:return 0>a.windCnt2}case B.ClipType.ctUnion:switch(c){case B.PolyFillType.pftEvenOdd:case B.PolyFillType.pftNonZero:return 0==a.windCnt2;case B.PolyFillType.pftPositive:return 0>=a.windCnt2;default:return 0<=a.windCnt2}case B.ClipType.ctDifference:if(a.polyType==B.PolyType.ptSubject)switch(c){case B.PolyFillType.pftEvenOdd:case B.PolyFillType.pftNonZero:return 0==a.windCnt2;case B.PolyFillType.pftPositive:return 0>=a.windCnt2;default:return 0<=a.windCnt2}else switch(c){case B.PolyFillType.pftEvenOdd:case B.PolyFillType.pftNonZero:return 0!=a.windCnt2;case B.PolyFillType.pftPositive:return 0<a.windCnt2;default:return 0>a.windCnt2}}return!0},B.Clipper.prototype.SetWindingCount=function(a){for(var b=a.prevInAEL;null!=b&&b.polyType!=a.polyType;)b=b.prevInAEL;if(null==b?(a.windCnt=a.windDelta,a.windCnt2=0,b=this.m_ActiveEdges):(a.windCnt=this.IsEvenOddFillType(a)?1:0>b.windCnt*b.windDelta?1<B.Math_Abs_Int32(b.windCnt)?0>b.windDelta*a.windDelta?b.windCnt:b.windCnt+a.windDelta:b.windCnt+b.windDelta+a.windDelta:1<B.Math_Abs_Int32(b.windCnt)&&0>b.windDelta*a.windDelta?b.windCnt:0==b.windCnt+a.windDelta?b.windCnt:b.windCnt+a.windDelta,a.windCnt2=b.windCnt2,b=b.nextInAEL),this.IsEvenOddAltFillType(a))for(;b!=a;)a.windCnt2=0==a.windCnt2?1:0,b=b.nextInAEL;else for(;b!=a;)a.windCnt2+=b.windDelta,b=b.nextInAEL},B.Clipper.prototype.AddEdgeToSEL=function(a){null==this.m_SortedEdges?(this.m_SortedEdges=a,a.prevInSEL=null,a.nextInSEL=null):(a.nextInSEL=this.m_SortedEdges,a.prevInSEL=null,this.m_SortedEdges=this.m_SortedEdges.prevInSEL=a)},B.Clipper.prototype.CopyAELToSEL=function(){var a=this.m_ActiveEdges;if(this.m_SortedEdges=a,null!=this.m_ActiveEdges)for(this.m_SortedEdges.prevInSEL=null,a=a.nextInAEL;null!=a;)a.prevInSEL=a.prevInAEL,a.prevInSEL.nextInSEL=a,a.nextInSEL=null,a=a.nextInAEL},B.Clipper.prototype.SwapPositionsInAEL=function(a,b){var c,d;!(null==a.nextInAEL&&null==a.prevInAEL)&&!(null==b.nextInAEL&&null==b.prevInAEL)&&(a.nextInAEL==b?(c=b.nextInAEL,null!=c&&(c.prevInAEL=a),d=a.prevInAEL,null!=d&&(d.nextInAEL=b),b.prevInAEL=d,b.nextInAEL=a,a.prevInAEL=b,a.nextInAEL=c):b.nextInAEL==a?(c=a.nextInAEL,null!=c&&(c.prevInAEL=b),d=b.prevInAEL,null!=d&&(d.nextInAEL=a),a.prevInAEL=d,a.nextInAEL=b,b.prevInAEL=a,b.nextInAEL=c):(c=a.nextInAEL,d=a.prevInAEL,a.nextInAEL=b.nextInAEL,null!=a.nextInAEL&&(a.nextInAEL.prevInAEL=a),a.prevInAEL=b.prevInAEL,null!=a.prevInAEL&&(a.prevInAEL.nextInAEL=a),b.nextInAEL=c,null!=b.nextInAEL&&(b.nextInAEL.prevInAEL=b),b.prevInAEL=d,null!=b.prevInAEL&&(b.prevInAEL.nextInAEL=b)),null==a.prevInAEL?this.m_ActiveEdges=a:null==b.prevInAEL&&(this.m_ActiveEdges=b))},B.Clipper.prototype.SwapPositionsInSEL=function(a,b){var c,d;!(null==a.nextInSEL&&null==a.prevInSEL)&&!(null==b.nextInSEL&&null==b.prevInSEL)&&(a.nextInSEL==b?(c=b.nextInSEL,null!=c&&(c.prevInSEL=a),d=a.prevInSEL,null!=d&&(d.nextInSEL=b),b.prevInSEL=d,b.nextInSEL=a,a.prevInSEL=b,a.nextInSEL=c):b.nextInSEL==a?(c=a.nextInSEL,null!=c&&(c.prevInSEL=b),d=b.prevInSEL,null!=d&&(d.nextInSEL=a),a.prevInSEL=d,a.nextInSEL=b,b.prevInSEL=a,b.nextInSEL=c):(c=a.nextInSEL,d=a.prevInSEL,a.nextInSEL=b.nextInSEL,null!=a.nextInSEL&&(a.nextInSEL.prevInSEL=a),a.prevInSEL=b.prevInSEL,null!=a.prevInSEL&&(a.prevInSEL.nextInSEL=a),b.nextInSEL=c,null!=b.nextInSEL&&(b.nextInSEL.prevInSEL=b),b.prevInSEL=d,null!=b.prevInSEL&&(b.prevInSEL.nextInSEL=b)),null==a.prevInSEL?this.m_SortedEdges=a:null==b.prevInSEL&&(this.m_SortedEdges=b))},B.Clipper.prototype.AddLocalMaxPoly=function(a,b,c){this.AddOutPt(a,c),a.outIdx==b.outIdx?(a.outIdx=-1,b.outIdx=-1):a.outIdx<b.outIdx?this.AppendPolygon(a,b):this.AppendPolygon(b,a)},B.Clipper.prototype.AddLocalMinPoly=function(a,b,c){var d;b.dx==B.ClipperBase.horizontal||a.dx>b.dx?(this.AddOutPt(a,c),b.outIdx=a.outIdx,a.side=B.EdgeSide.esLeft,b.side=B.EdgeSide.esRight,d=a,a=d.prevInAEL==b?b.prevInAEL:d.prevInAEL):(this.AddOutPt(b,c),a.outIdx=b.outIdx,a.side=B.EdgeSide.esRight,b.side=B.EdgeSide.esLeft,d=b,a=d.prevInAEL==a?a.prevInAEL:d.prevInAEL),null!=a&&0<=a.outIdx&&B.Clipper.TopX(a,c.Y)==B.Clipper.TopX(d,c.Y)&&this.SlopesEqual(d,a,this.m_UseFullRange)&&this.AddJoin(d,a,-1,-1)},B.Clipper.prototype.CreateOutRec=function(){var a=new B.OutRec;return a.idx=-1,a.isHole=!1,a.FirstLeft=null,a.AppendLink=null,a.pts=null,a.bottomPt=null,a},B.Clipper.prototype.AddOutPt=function(a,b){var c,d,e=a.side==B.EdgeSide.esLeft;if(0>a.outIdx)c=this.CreateOutRec(),this.m_PolyOuts.push(c),c.idx=this.m_PolyOuts.length-1,a.outIdx=c.idx,d=new B.OutPt,c.pts=d,c.bottomPt=d,d.pt=b,d.idx=c.idx,d.next=d,d.prev=d,this.SetHoleState(a,c);else{c=this.m_PolyOuts[a.outIdx],d=c.pts;var f;e&&B.ClipperBase.PointsEqual(b,d.pt)||!e&&B.ClipperBase.PointsEqual(b,d.prev.pt)||(f=new B.OutPt,f.pt=b,f.idx=c.idx,f.pt.Y==c.bottomPt.pt.Y&&f.pt.X<c.bottomPt.pt.X&&(c.bottomPt=f),f.next=d,f.prev=d.prev,f.prev.next=f,d.prev=f,e&&(c.pts=f))}},B.Clipper.prototype.SwapPoints=function(a,b){var c=a.Value;a.Value=b.Value,b.Value=c},B.Clipper.prototype.GetOverlapSegment=function(a,b,c,d,e,f){return B.Math_Abs_Int64(a.X-b.X)>B.Math_Abs_Int64(a.Y-b.Y)?(a.X>b.X&&(a={Value:a},b={Value:b},this.SwapPoints(a,b),a=a.Value,b=b.Value),c.X>d.X&&(c={Value:c},d={Value:d},this.SwapPoints(c,d),c=c.Value,d=d.Value),e.Value=a.X>c.X?a:c,f.Value=b.X<d.X?b:d,e.Value.X<f.Value.X):(a.Y<b.Y&&(a={Value:a},b={Value:b},this.SwapPoints(a,b),a=a.Value,b=b.Value),c.Y<d.Y&&(c={Value:c},d={Value:d},this.SwapPoints(c,d),c=c.Value,d=d.Value),e.Value=a.Y<c.Y?a:c,f.Value=b.Y>d.Y?b:d,e.Value.Y>f.Value.Y)},B.Clipper.prototype.FindSegment=function(a,b,c){if(null==a.Value)return!1;var d=a.Value,e=new B.IntPoint(b.Value),f=new B.IntPoint(c.Value);do{if(this.SlopesEqual(e,f,a.Value.pt,a.Value.prev.pt,!0)&&this.SlopesEqual(e,f,a.Value.pt,!0)&&this.GetOverlapSegment(e,f,a.Value.pt,a.Value.prev.pt,b,c))return!0;a.Value=a.Value.next}while(a.Value!=d);return!1},B.Clipper.prototype.Pt3IsBetweenPt1AndPt2=function(a,b,c){return B.ClipperBase.PointsEqual(a,c)||B.ClipperBase.PointsEqual(b,c)?!0:a.X!=b.X?a.X<c.X==c.X<b.X:a.Y<c.Y==c.Y<b.Y},B.Clipper.prototype.InsertPolyPtBetween=function(a,b,c){var d=new B.OutPt;return d.pt=c,b==a.next?(a.next=d,b.prev=d,d.next=b,d.prev=a):(b.next=d,a.prev=d,d.next=a,d.prev=b),d},B.Clipper.prototype.SetHoleState=function(a,b){for(var c=!1,d=a.prevInAEL;null!=d;)0<=d.outIdx&&(c=!c,null==b.FirstLeft&&(b.FirstLeft=this.m_PolyOuts[d.outIdx])),d=d.prevInAEL;c&&(b.isHole=!0)},B.Clipper.prototype.GetDx=function(a,b){return a.Y==b.Y?B.ClipperBase.horizontal:(b.X-a.X)/(b.Y-a.Y)},B.Clipper.prototype.FirstIsBottomPt=function(a,b){for(var c=a.prev;B.ClipperBase.PointsEqual(c.pt,a.pt)&&c!=a;)c=c.prev;for(var d=B.Math_Abs_Double(this.GetDx(a.pt,c.pt)),c=a.next;B.ClipperBase.PointsEqual(c.pt,a.pt)&&c!=a;)c=c.next;for(var e=B.Math_Abs_Double(this.GetDx(a.pt,c.pt)),c=b.prev;B.ClipperBase.PointsEqual(c.pt,b.pt)&&c!=b;)c=c.prev;for(var f=B.Math_Abs_Double(this.GetDx(b.pt,c.pt)),c=b.next;B.ClipperBase.PointsEqual(c.pt,b.pt)&&c!=b;)c=c.next;return c=B.Math_Abs_Double(this.GetDx(b.pt,c.pt)),d>=f&&d>=c||e>=f&&e>=c},B.Clipper.prototype.GetBottomPt=function(a){for(var b=null,c=a.next;c!=a;)c.pt.Y>a.pt.Y?(a=c,b=null):c.pt.Y==a.pt.Y&&c.pt.X<=a.pt.X&&(c.pt.X<a.pt.X?(b=null,a=c):c.next!=a&&c.prev!=a&&(b=c)),c=c.next;if(null!=b)for(;b!=c;)for(this.FirstIsBottomPt(c,b)||(a=b),b=b.next;!B.ClipperBase.PointsEqual(b.pt,a.pt);)b=b.next;return a},B.Clipper.prototype.GetLowermostRec=function(a,b){var c=a.bottomPt,d=b.bottomPt;return c.pt.Y>d.pt.Y?a:c.pt.Y<d.pt.Y?b:c.pt.X<d.pt.X?a:c.pt.X>d.pt.X?b:c.next==c?b:d.next==d?a:this.FirstIsBottomPt(c,d)?a:b},B.Clipper.prototype.Param1RightOfParam2=function(a,b){do if(a=a.FirstLeft,a==b)return!0;while(null!=a);return!1},B.Clipper.prototype.AppendPolygon=function(a,b){var c,d=this.m_PolyOuts[a.outIdx],e=this.m_PolyOuts[b.outIdx];c=this.Param1RightOfParam2(d,e)?e:this.Param1RightOfParam2(e,d)?d:this.GetLowermostRec(d,e);var f=d.pts,g=f.prev,h=e.pts,i=h.prev;for(a.side==B.EdgeSide.esLeft?(b.side==B.EdgeSide.esLeft?(this.ReversePolyPtLinks(h),h.next=f,f.prev=h,g.next=i,i.prev=g,d.pts=i):(i.next=f,f.prev=i,h.prev=g,g.next=h,d.pts=h),f=B.EdgeSide.esLeft):(b.side==B.EdgeSide.esRight?(this.ReversePolyPtLinks(h),g.next=i,i.prev=g,h.next=f,f.prev=h):(g.next=h,h.prev=g,f.prev=i,i.next=f),f=B.EdgeSide.esRight),c==e&&(d.bottomPt=e.bottomPt,d.bottomPt.idx=d.idx,e.FirstLeft!=d&&(d.FirstLeft=e.FirstLeft),d.isHole=e.isHole),e.pts=null,e.bottomPt=null,e.AppendLink=d,d=a.outIdx,e=b.outIdx,a.outIdx=-1,b.outIdx=-1,c=this.m_ActiveEdges;null!=c;){if(c.outIdx==e){c.outIdx=d,c.side=f;break}c=c.nextInAEL}for(c=0;c<this.m_Joins.length;++c)this.m_Joins[c].poly1Idx==e&&(this.m_Joins[c].poly1Idx=d),this.m_Joins[c].poly2Idx==e&&(this.m_Joins[c].poly2Idx=d);for(c=0;c<this.m_HorizJoins.length;++c)this.m_HorizJoins[c].savedIdx==e&&(this.m_HorizJoins[c].savedIdx=d)},B.Clipper.prototype.ReversePolyPtLinks=function(a){if(null!=a){var b,c;b=a;do c=b.next,b.next=b.prev,b=b.prev=c;while(b!=a)}},B.Clipper.SwapSides=function(a,b){var c=a.side;a.side=b.side,b.side=c},B.Clipper.SwapPolyIndexes=function(a,b){var c=a.outIdx;a.outIdx=b.outIdx,b.outIdx=c},B.Clipper.prototype.DoEdge1=function(a,b,c){this.AddOutPt(a,c),B.Clipper.SwapSides(a,b),B.Clipper.SwapPolyIndexes(a,b)},B.Clipper.prototype.DoEdge2=function(a,b,c){this.AddOutPt(b,c),B.Clipper.SwapSides(a,b),
B.Clipper.SwapPolyIndexes(a,b)},B.Clipper.prototype.DoBothEdges=function(a,b,c){this.AddOutPt(a,c),this.AddOutPt(b,c),B.Clipper.SwapSides(a,b),B.Clipper.SwapPolyIndexes(a,b)},B.Clipper.prototype.IntersectEdges=function(a,b,c,d){var e=0==(B.Protects.ipLeft&d)&&null==a.nextInLML&&a.xtop==c.X&&a.ytop==c.Y;d=0==(B.Protects.ipRight&d)&&null==b.nextInLML&&b.xtop==c.X&&b.ytop==c.Y;var f=0<=a.outIdx,g=0<=b.outIdx;if(a.polyType==b.polyType)if(this.IsEvenOddFillType(a)){var h=a.windCnt;a.windCnt=b.windCnt,b.windCnt=h}else a.windCnt=0==a.windCnt+b.windDelta?-a.windCnt:a.windCnt+b.windDelta,b.windCnt=0==b.windCnt-a.windDelta?-b.windCnt:b.windCnt-a.windDelta;else a.windCnt2=this.IsEvenOddFillType(b)?0==a.windCnt2?1:0:a.windCnt2+b.windDelta,b.windCnt2=this.IsEvenOddFillType(a)?0==b.windCnt2?1:0:b.windCnt2-a.windDelta;var i,j,k;switch(a.polyType==B.PolyType.ptSubject?(i=this.m_SubjFillType,k=this.m_ClipFillType):(i=this.m_ClipFillType,k=this.m_SubjFillType),b.polyType==B.PolyType.ptSubject?(j=this.m_SubjFillType,h=this.m_ClipFillType):(j=this.m_ClipFillType,h=this.m_SubjFillType),i){case B.PolyFillType.pftPositive:i=a.windCnt;break;case B.PolyFillType.pftNegative:i=-a.windCnt;break;default:i=B.Math_Abs_Int32(a.windCnt)}switch(j){case B.PolyFillType.pftPositive:j=b.windCnt;break;case B.PolyFillType.pftNegative:j=-b.windCnt;break;default:j=B.Math_Abs_Int32(b.windCnt)}if(f&&g)e||d||0!=i&&1!=i||0!=j&&1!=j||a.polyType!=b.polyType&&this.m_ClipType!=B.ClipType.ctXor?this.AddLocalMaxPoly(a,b,c):this.DoBothEdges(a,b,c);else if(f)(0==j||1==j)&&(this.m_ClipType!=B.ClipType.ctIntersection||b.polyType==B.PolyType.ptSubject||0!=b.windCnt2)&&this.DoEdge1(a,b,c);else if(g)(0==i||1==i)&&(this.m_ClipType!=B.ClipType.ctIntersection||a.polyType==B.PolyType.ptSubject||0!=a.windCnt2)&&this.DoEdge2(a,b,c);else if(!(0!=i&&1!=i||0!=j&&1!=j||e||d)){switch(k){case B.PolyFillType.pftPositive:f=a.windCnt2;break;case B.PolyFillType.pftNegative:f=-a.windCnt2;break;default:f=B.Math_Abs_Int32(a.windCnt2)}switch(h){case B.PolyFillType.pftPositive:g=b.windCnt2;break;case B.PolyFillType.pftNegative:g=-b.windCnt2;break;default:g=B.Math_Abs_Int32(b.windCnt2)}if(a.polyType!=b.polyType)this.AddLocalMinPoly(a,b,c);else if(1==i&&1==j)switch(this.m_ClipType){case B.ClipType.ctIntersection:f>0&&g>0&&this.AddLocalMinPoly(a,b,c);break;case B.ClipType.ctUnion:0>=f&&0>=g&&this.AddLocalMinPoly(a,b,c);break;case B.ClipType.ctDifference:(a.polyType==B.PolyType.ptClip&&f>0&&g>0||a.polyType==B.PolyType.ptSubject&&0>=f&&0>=g)&&this.AddLocalMinPoly(a,b,c);break;case B.ClipType.ctXor:this.AddLocalMinPoly(a,b,c)}else B.Clipper.SwapSides(a,b)}e!=d&&(e&&0<=a.outIdx||d&&0<=b.outIdx)&&(B.Clipper.SwapSides(a,b),B.Clipper.SwapPolyIndexes(a,b)),e&&this.DeleteFromAEL(a),d&&this.DeleteFromAEL(b)},B.Clipper.prototype.DeleteFromAEL=function(a){var b=a.prevInAEL,c=a.nextInAEL;null==b&&null==c&&a!=this.m_ActiveEdges||(null!=b?b.nextInAEL=c:this.m_ActiveEdges=c,null!=c&&(c.prevInAEL=b),a.nextInAEL=null,a.prevInAEL=null)},B.Clipper.prototype.DeleteFromSEL=function(a){var b=a.prevInSEL,c=a.nextInSEL;null==b&&null==c&&a!=this.m_SortedEdges||(null!=b?b.nextInSEL=c:this.m_SortedEdges=c,null!=c&&(c.prevInSEL=b),a.nextInSEL=null,a.prevInSEL=null)},B.Clipper.prototype.UpdateEdgeIntoAEL=function(a){null==a.Value.nextInLML&&B.Error("UpdateEdgeIntoAEL: invalid call");var b=a.Value.prevInAEL,c=a.Value.nextInAEL;a.Value.nextInLML.outIdx=a.Value.outIdx,null!=b?b.nextInAEL=a.Value.nextInLML:this.m_ActiveEdges=a.Value.nextInLML,null!=c&&(c.prevInAEL=a.Value.nextInLML),a.Value.nextInLML.side=a.Value.side,a.Value.nextInLML.windDelta=a.Value.windDelta,a.Value.nextInLML.windCnt=a.Value.windCnt,a.Value.nextInLML.windCnt2=a.Value.windCnt2,a.Value=a.Value.nextInLML,a.Value.prevInAEL=b,a.Value.nextInAEL=c,a.Value.dx!=B.ClipperBase.horizontal&&this.InsertScanbeam(a.Value.ytop)},B.Clipper.prototype.ProcessHorizontals=function(){for(var a=this.m_SortedEdges;null!=a;)this.DeleteFromSEL(a),this.ProcessHorizontal(a),a=this.m_SortedEdges},B.Clipper.prototype.ProcessHorizontal=function(a){var b,c,d;a.xcurr<a.xtop?(c=a.xcurr,d=a.xtop,b=B.Direction.dLeftToRight):(c=a.xtop,d=a.xcurr,b=B.Direction.dRightToLeft);var e;e=null!=a.nextInLML?null:this.GetMaximaPair(a);for(var f=this.GetNextInAEL(a,b);null!=f;){var g=this.GetNextInAEL(f,b);if(null!=e||b==B.Direction.dLeftToRight&&f.xcurr<=d||b==B.Direction.dRightToLeft&&f.xcurr>=c){if(f.xcurr==a.xtop&&null==e){if(this.SlopesEqual(f,a.nextInLML,this.m_UseFullRange)){0<=a.outIdx&&0<=f.outIdx&&this.AddJoin(a.nextInLML,f,a.outIdx,-1);break}if(f.dx<a.nextInLML.dx)break}if(f==e)return b==B.Direction.dLeftToRight?this.IntersectEdges(a,f,new B.IntPoint(f.xcurr,a.ycurr),0):this.IntersectEdges(f,a,new B.IntPoint(f.xcurr,a.ycurr),0),void(0<=e.outIdx&&B.Error("ProcessHorizontal error"));f.dx==B.ClipperBase.horizontal&&this.IsMinima(f),b==B.Direction.dLeftToRight?this.IntersectEdges(a,f,new B.IntPoint(f.xcurr,a.ycurr),this.IsTopHorz(a,f.xcurr)?B.Protects.ipLeft:B.Protects.ipBoth):this.IntersectEdges(f,a,new B.IntPoint(f.xcurr,a.ycurr),this.IsTopHorz(a,f.xcurr)?B.Protects.ipRight:B.Protects.ipBoth),this.SwapPositionsInAEL(a,f)}else if(b==B.Direction.dLeftToRight&&f.xcurr>d&&null==a.nextInSEL||b==B.Direction.dRightToLeft&&f.xcurr<c&&null==a.nextInSEL)break;f=g}null!=a.nextInLML?(0<=a.outIdx&&this.AddOutPt(a,new B.IntPoint(a.xtop,a.ytop)),a={Value:a},this.UpdateEdgeIntoAEL(a)):(0<=a.outIdx&&this.IntersectEdges(a,e,new B.IntPoint(a.xtop,a.ycurr),B.Protects.ipBoth),this.DeleteFromAEL(e),this.DeleteFromAEL(a))},B.Clipper.prototype.IsTopHorz=function(a,b){for(var c=this.m_SortedEdges;null!=c;){if(b>=Math.min(c.xcurr,c.xtop)&&b<=Math.max(c.xcurr,c.xtop))return!1;c=c.nextInSEL}return!0},B.Clipper.prototype.GetNextInAEL=function(a,b){return b==B.Direction.dLeftToRight?a.nextInAEL:a.prevInAEL},B.Clipper.prototype.IsMinima=function(a){return null!=a&&a.prev.nextInLML!=a&&a.next.nextInLML!=a},B.Clipper.prototype.IsMaxima=function(a,b){return null!=a&&a.ytop==b&&null==a.nextInLML},B.Clipper.prototype.IsIntermediate=function(a,b){return a.ytop==b&&null!=a.nextInLML},B.Clipper.prototype.GetMaximaPair=function(a){return this.IsMaxima(a.next,a.ytop)&&a.next.xtop==a.xtop?a.next:a.prev},B.Clipper.prototype.ProcessIntersections=function(a,b){if(null==this.m_ActiveEdges)return!0;try{if(this.BuildIntersectList(a,b),null==this.m_IntersectNodes)return!0;if(!this.FixupIntersections())return!1;this.ProcessIntersectList()}catch(c){this.m_SortedEdges=null,this.DisposeIntersectNodes(),B.Error("ProcessIntersections error")}return!0},B.Clipper.prototype.BuildIntersectList=function(a,b){if(null!=this.m_ActiveEdges){var c=this.m_ActiveEdges;for(c.tmpX=B.Clipper.TopX(c,b),this.m_SortedEdges=c,this.m_SortedEdges.prevInSEL=null,c=c.nextInAEL;null!=c;)c.prevInSEL=c.prevInAEL,c.prevInSEL.nextInSEL=c,c.nextInSEL=null,c.tmpX=B.Clipper.TopX(c,b),c=c.nextInAEL;for(var d=!0;d&&null!=this.m_SortedEdges;){for(d=!1,c=this.m_SortedEdges;null!=c.nextInSEL;){var e,f=c.nextInSEL,g=new B.IntPoint;(e=c.tmpX>f.tmpX)&&(g={Value:g},e=this.IntersectPoint(c,f,g),g=g.Value),e?(g.Y>a&&(g.Y=a,g.X=B.Clipper.TopX(c,g.Y)),this.AddIntersectNode(c,f,g),this.SwapPositionsInSEL(c,f),d=!0):c=f}if(null==c.prevInSEL)break;c.prevInSEL.nextInSEL=null}this.m_SortedEdges=null}},B.Clipper.prototype.FixupIntersections=function(){if(null==this.m_IntersectNodes.next)return!0;this.CopyAELToSEL();for(var a=this.m_IntersectNodes,b=this.m_IntersectNodes.next;null!=b;){var c=a.edge1;if(c.prevInSEL==a.edge2)b=c.prevInSEL;else if(c.nextInSEL==a.edge2)b=c.nextInSEL;else{for(;null!=b&&b.edge1.nextInSEL!=b.edge2&&b.edge1.prevInSEL!=b.edge2;)b=b.next;if(null==b)return!1;this.SwapIntersectNodes(a,b),c=a.edge1,b=a.edge2}this.SwapPositionsInSEL(c,b),a=a.next,b=a.next}return this.m_SortedEdges=null,a.edge1.prevInSEL==a.edge2||a.edge1.nextInSEL==a.edge2},B.Clipper.prototype.ProcessIntersectList=function(){for(;null!=this.m_IntersectNodes;){var a=this.m_IntersectNodes.next;this.IntersectEdges(this.m_IntersectNodes.edge1,this.m_IntersectNodes.edge2,this.m_IntersectNodes.pt,B.Protects.ipBoth),this.SwapPositionsInAEL(this.m_IntersectNodes.edge1,this.m_IntersectNodes.edge2),this.m_IntersectNodes=null,this.m_IntersectNodes=a}},s=function(a){return 0>a?Math.ceil(a-.5):Math.round(a)},v=function(a){return 0>a?Math.ceil(a-.5):Math.floor(a+.5)},w=function(a){return 0>a?-Math.round(Math.abs(a)):Math.round(a)},x=function(a){return 0>a?(a-=.5,-2147483648>a?Math.ceil(a):0|a):(a+=.5,a>2147483647?Math.floor(a):0|a)},B.Clipper.Round=z?s:t?w:u?x:v,B.Clipper.TopX=function(a,b){return b==a.ytop?a.xtop:a.xbot+B.Clipper.Round(a.dx*(b-a.ybot))},B.Clipper.prototype.AddIntersectNode=function(a,b,c){var d=new B.IntersectNode;if(d.edge1=a,d.edge2=b,d.pt=c,d.next=null,null==this.m_IntersectNodes)this.m_IntersectNodes=d;else if(this.ProcessParam1BeforeParam2(d,this.m_IntersectNodes))d.next=this.m_IntersectNodes,this.m_IntersectNodes=d;else{for(a=this.m_IntersectNodes;null!=a.next&&this.ProcessParam1BeforeParam2(a.next,d);)a=a.next;d.next=a.next,a.next=d}},B.Clipper.prototype.ProcessParam1BeforeParam2=function(a,b){var c;return a.pt.Y==b.pt.Y?a.edge1==b.edge1||a.edge2==b.edge1?(c=b.pt.X>a.pt.X,0<b.edge1.dx?!c:c):a.edge1==b.edge2||a.edge2==b.edge2?(c=b.pt.X>a.pt.X,0<b.edge2.dx?!c:c):b.pt.X>a.pt.X:a.pt.Y>b.pt.Y},B.Clipper.prototype.SwapIntersectNodes=function(a,b){var c=a.edge1,d=a.edge2,e=a.pt;a.edge1=b.edge1,a.edge2=b.edge2,a.pt=b.pt,b.edge1=c,b.edge2=d,b.pt=e},B.Clipper.prototype.IntersectPoint=function(a,b,c){var d,e;if(this.SlopesEqual(a,b,this.m_UseFullRange))return!1;if(0==a.dx)c.Value.X=a.xbot,b.dx==B.ClipperBase.horizontal?c.Value.Y=b.ybot:(e=b.ybot-b.xbot/b.dx,c.Value.Y=B.Clipper.Round(c.Value.X/b.dx+e));else if(0==b.dx)c.Value.X=b.xbot,a.dx==B.ClipperBase.horizontal?c.Value.Y=a.ybot:(d=a.ybot-a.xbot/a.dx,c.Value.Y=B.Clipper.Round(c.Value.X/a.dx+d));else{d=a.xbot-a.ybot*a.dx,e=b.xbot-b.ybot*b.dx;var f=(e-d)/(a.dx-b.dx);c.Value.Y=B.Clipper.Round(f),c.Value.X=B.Math_Abs_Double(a.dx)<B.Math_Abs_Double(b.dx)?B.Clipper.Round(a.dx*f+d):B.Clipper.Round(b.dx*f+e)}return c.Value.Y<a.ytop||c.Value.Y<b.ytop?a.ytop>b.ytop?(c.Value.X=a.xtop,c.Value.Y=a.ytop,B.Clipper.TopX(b,a.ytop)<a.xtop):(c.Value.X=b.xtop,c.Value.Y=b.ytop,B.Clipper.TopX(a,b.ytop)>b.xtop):!0},B.Clipper.prototype.DisposeIntersectNodes=function(){for(;null!=this.m_IntersectNodes;){var a=this.m_IntersectNodes.next;this.m_IntersectNodes=null,this.m_IntersectNodes=a}},B.Clipper.prototype.ProcessEdgesAtTopOfScanbeam=function(a){for(var b,c=this.m_ActiveEdges;null!=c;)if(this.IsMaxima(c,a)&&this.GetMaximaPair(c).dx!=B.ClipperBase.horizontal)b=c.prevInAEL,this.DoMaxima(c,a),c=null==b?this.m_ActiveEdges:b.nextInAEL;else{if(this.IsIntermediate(c,a)&&c.nextInLML.dx==B.ClipperBase.horizontal){if(0<=c.outIdx){for(this.AddOutPt(c,new B.IntPoint(c.xtop,c.ytop)),b=0;b<this.m_HorizJoins.length;++b){var d=new B.IntPoint,e=new B.IntPoint,f=this.m_HorizJoins[b],d={Value:d},e={Value:e};this.GetOverlapSegment(new B.IntPoint(f.edge.xbot,f.edge.ybot),new B.IntPoint(f.edge.xtop,f.edge.ytop),new B.IntPoint(c.nextInLML.xbot,c.nextInLML.ybot),new B.IntPoint(c.nextInLML.xtop,c.nextInLML.ytop),d,e)&&this.AddJoin(f.edge,c.nextInLML,f.savedIdx,c.outIdx)}this.AddHorzJoin(c.nextInLML,c.outIdx)}c={Value:c},this.UpdateEdgeIntoAEL(c),c=c.Value,this.AddEdgeToSEL(c)}else c.xcurr=B.Clipper.TopX(c,a),c.ycurr=a;c=c.nextInAEL}for(this.ProcessHorizontals(),c=this.m_ActiveEdges;null!=c;)this.IsIntermediate(c,a)&&(0<=c.outIdx&&this.AddOutPt(c,new B.IntPoint(c.xtop,c.ytop)),c={Value:c},this.UpdateEdgeIntoAEL(c),c=c.Value,b=c.prevInAEL,d=c.nextInAEL,null!=b&&b.xcurr==c.xbot&&b.ycurr==c.ybot&&0<=c.outIdx&&0<=b.outIdx&&b.ycurr>b.ytop&&this.SlopesEqual(c,b,this.m_UseFullRange)?(this.AddOutPt(b,new B.IntPoint(c.xbot,c.ybot)),this.AddJoin(c,b,-1,-1)):null!=d&&d.xcurr==c.xbot&&d.ycurr==c.ybot&&0<=c.outIdx&&0<=d.outIdx&&d.ycurr>d.ytop&&this.SlopesEqual(c,d,this.m_UseFullRange)&&(this.AddOutPt(d,new B.IntPoint(c.xbot,c.ybot)),this.AddJoin(c,d,-1,-1))),c=c.nextInAEL},B.Clipper.prototype.DoMaxima=function(a,b){for(var c=this.GetMaximaPair(a),d=a.xtop,e=a.nextInAEL;e!=c;)null==e&&B.Error("DoMaxima error"),this.IntersectEdges(a,e,new B.IntPoint(d,b),B.Protects.ipBoth),e=e.nextInAEL;0>a.outIdx&&0>c.outIdx?(this.DeleteFromAEL(a),this.DeleteFromAEL(c)):0<=a.outIdx&&0<=c.outIdx?this.IntersectEdges(a,c,new B.IntPoint(d,b),B.Protects.ipNone):B.Error("DoMaxima error")},B.Clipper.ReversePolygons=function(a){for(var b=a.length,c=0;b>c;c++)a[c]instanceof Array&&a[c].reverse()},B.Clipper.Orientation=function(a){return 0<=this.Area(a)},B.Clipper.prototype.PointCount=function(a){if(null==a)return 0;var b=0,c=a;do b++,c=c.next;while(c!=a);return b},B.Clipper.prototype.BuildResult=function(a){B.Clear(a);for(var b,c=this.m_PolyOuts.length,d=0;c>d;d++)if(b=this.m_PolyOuts[d],null!=b.pts){b=b.pts;var e=this.PointCount(b);if(!(3>e)){for(var f=new B.Polygon(e),g=0;e>g;g++)f.push(b.pt),b=b.prev;a.push(f)}}},B.Clipper.prototype.BuildResultEx=function(a){B.Clear(a);for(var b=0;b<this.m_PolyOuts.length;){var c=this.m_PolyOuts[b++];if(null==c.pts)break;var d=c.pts,c=this.PointCount(d);if(!(3>c)){var e=new B.ExPolygon;e.outer=new B.Polygon,e.holes=new B.Polygons;for(var f=0;c>f;f++)e.outer.push(d.pt),d=d.prev;for(;b<this.m_PolyOuts.length&&(c=this.m_PolyOuts[b],null!=c.pts&&c.isHole);){f=new B.Polygon,d=c.pts;do f.push(d.pt),d=d.prev;while(d!=c.pts);e.holes.push(f),b++}a.push(e)}}},B.Clipper.prototype.FixupOutPolygon=function(a){for(var b=null,c=a.pts=a.bottomPt;;){if(c.prev==c||c.prev==c.next)return this.DisposeOutPts(c),a.pts=null,void(a.bottomPt=null);if(B.ClipperBase.PointsEqual(c.pt,c.next.pt)||this.SlopesEqual(c.prev.pt,c.pt,c.next.pt,this.m_UseFullRange))b=null,c==a.bottomPt&&(a.bottomPt=null),c.prev.next=c.next,c=c.next.prev=c.prev;else{if(c==b)break;null==b&&(b=c),c=c.next}}null==a.bottomPt&&(a.bottomPt=this.GetBottomPt(c),a.bottomPt.idx=a.idx,a.pts=a.bottomPt)},B.Clipper.prototype.JoinPoints=function(a,b,c){b.Value=null,c.Value=null;var d=this.m_PolyOuts[a.poly1Idx],e=this.m_PolyOuts[a.poly2Idx];if(null==d||null==e)return!1;var f=d.pts,g=e.pts,h=a.pt2a,i=a.pt2b,j=a.pt1a;a=a.pt1b;var f={Value:f},h={Value:h},i={Value:i},k=this.FindSegment(f,h,i),f=f.Value,h=h.Value,i=i.Value;if(!k)return!1;if(d==e){if(g=f.next,g={Value:g},j={Value:j},a={Value:a},d=this.FindSegment(g,j,a),g=g.Value,j=j.Value,a=a.Value,!d||g==f)return!1}else if(g={Value:g},j={Value:j},a={Value:a},d=this.FindSegment(g,j,a),g=g.Value,j=j.Value,a=a.Value,!d)return!1;return h={Value:h},i={Value:i},j=this.GetOverlapSegment(h.Value,i.Value,j,a,h,i),h=h.Value,i=i.Value,j?(j=f.prev,b.Value=B.ClipperBase.PointsEqual(f.pt,h)?f:B.ClipperBase.PointsEqual(j.pt,h)?j:this.InsertPolyPtBetween(f,j,h),c.Value=B.ClipperBase.PointsEqual(f.pt,i)?f:B.ClipperBase.PointsEqual(j.pt,i)?j:b.Value==f||b.Value==j?this.InsertPolyPtBetween(f,j,i):this.Pt3IsBetweenPt1AndPt2(f.pt,b.Value.pt,i)?this.InsertPolyPtBetween(f,b.Value,i):this.InsertPolyPtBetween(b.Value,j,i),j=g.prev,f=B.ClipperBase.PointsEqual(g.pt,h)?g:B.ClipperBase.PointsEqual(j.pt,h)?j:this.InsertPolyPtBetween(g,j,h),g=B.ClipperBase.PointsEqual(g.pt,i)?g:B.ClipperBase.PointsEqual(j.pt,i)?j:f==g||f==j?this.InsertPolyPtBetween(g,j,i):this.Pt3IsBetweenPt1AndPt2(g.pt,f.pt,i)?this.InsertPolyPtBetween(g,f,i):this.InsertPolyPtBetween(f,j,i),b.Value.next==c.Value&&f.prev==g?(b.Value.next=f,f.prev=b.Value,c.Value.prev=g,g.next=c.Value,!0):b.Value.prev==c.Value&&f.next==g?(b.Value.prev=f,f.next=b.Value,c.Value.next=g,g.prev=c.Value,!0):!1):!1},B.Clipper.prototype.FixupJoinRecs=function(a,b,c){for(;c<this.m_Joins.length;c++){var d=this.m_Joins[c];d.poly1Idx==a.poly1Idx&&this.PointIsVertex(d.pt1a,b)&&(d.poly1Idx=a.poly2Idx),d.poly2Idx==a.poly1Idx&&this.PointIsVertex(d.pt2a,b)&&(d.poly2Idx=a.poly2Idx)}},B.Clipper.prototype.JoinCommonEdges=function(){for(var a,b,c=0;c<this.m_Joins.length;c++){a=this.m_Joins[c];var d,e;d={Value:d},e={Value:e};var f=this.JoinPoints(a,d,e);if(d=d.Value,e=e.Value,f){var f=this.m_PolyOuts[a.poly1Idx],g=this.m_PolyOuts[a.poly2Idx];if(f==g){if(f.pts=this.GetBottomPt(d),f.bottomPt=f.pts,f.bottomPt.idx=f.idx,g=this.CreateOutRec(),this.m_PolyOuts.push(g),g.idx=this.m_PolyOuts.length-1,a.poly2Idx=g.idx,g.pts=this.GetBottomPt(e),g.bottomPt=g.pts,g.bottomPt.idx=g.idx,this.PointInPolygon(g.pts.pt,f.pts,this.m_UseFullRange))g.isHole=!f.isHole,g.FirstLeft=f,this.FixupJoinRecs(a,e,c+1),this.FixupOutPolygon(f),this.FixupOutPolygon(g),(g.isHole^this.m_ReverseOutput)==0<this.Area(g,this.m_UseFullRange)&&this.ReversePolyPtLinks(g.pts);else if(this.PointInPolygon(f.pts.pt,g.pts,this.m_UseFullRange)){if(g.isHole=f.isHole,f.isHole=!g.isHole,g.FirstLeft=f.FirstLeft,f.FirstLeft=g,this.FixupJoinRecs(a,e,c+1),this.FixupOutPolygon(f),this.FixupOutPolygon(g),(f.isHole^this.m_ReverseOutput)==0<this.Area(f,this.m_UseFullRange)&&this.ReversePolyPtLinks(f.pts),this.m_UsingExPolygons&&f.isHole)for(a=0;a<this.m_PolyOuts.length;++a)b=this.m_PolyOuts[a],b.isHole&&null!=b.bottomPt&&b.FirstLeft==f&&(b.FirstLeft=g)}else if(g.isHole=f.isHole,g.FirstLeft=f.FirstLeft,this.FixupJoinRecs(a,e,c+1),this.FixupOutPolygon(f),this.FixupOutPolygon(g),this.m_UsingExPolygons&&null!=g.pts)for(a=0;a<this.m_PolyOuts.length;++a)b=this.m_PolyOuts[a],b.isHole&&null!=b.bottomPt&&b.FirstLeft==f&&this.PointInPolygon(b.bottomPt.pt,g.pts,this.m_UseFullRange)&&(b.FirstLeft=g)}else{if(this.m_UsingExPolygons)for(a=0;a<this.m_PolyOuts.length;++a)this.m_PolyOuts[a].isHole&&null!=this.m_PolyOuts[a].bottomPt&&this.m_PolyOuts[a].FirstLeft==g&&(this.m_PolyOuts[a].FirstLeft=f);this.FixupOutPolygon(f),null!=f.pts&&(f.isHole=0>this.Area(f,this.m_UseFullRange),f.isHole&&null==f.FirstLeft&&(f.FirstLeft=g.FirstLeft)),b=f.idx;var h=g.idx;for(g.pts=null,g.bottomPt=null,g.AppendLink=f,a=c+1;a<this.m_Joins.length;a++)f=this.m_Joins[a],f.poly1Idx==h&&(f.poly1Idx=b),f.poly2Idx==h&&(f.poly2Idx=b)}}}},B.Clipper.FullRangeNeeded=function(a){for(var b=!1,c=0;c<a.length;c++)B.Math_Abs_Int64(a[c].X)>B.ClipperBase.hiRange||B.Math_Abs_Int64(a[c].Y)>B.ClipperBase.hiRange?B.Error("Coordinate exceeds range bounds in FullRangeNeeded()."):(B.Math_Abs_Int64(a[c].X)>B.ClipperBase.loRange||B.Math_Abs_Int64(a[c].Y)>B.ClipperBase.loRange)&&(b=!0);return b},B.Clipper.prototype.Area=B.Clipper.Area=function(){var a,c=arguments;if(1==c.length){var d=c[0],e=d.length-1;if(2>e)return 0;if(B.Clipper.FullRangeNeeded(d)){for(c=new b(d[e].X+d[0].X).multiply(new b(d[0].Y-d[e].Y)),a=1;e>=a;++a)c=c.add(new b(d[a-1].X+d[a].X).multiply(new b(d[a].Y-d[a-1].Y)));return parseFloat(c.toString())/2}for(c=(d[e].X+d[0].X)*(d[0].Y-d[e].Y),a=1;e>=a;++a)c+=(d[a-1].X+d[a].X)*(d[a].Y-d[a-1].Y);return c/2}if(2==c.length){if(a=c[0],d=a.pts,null==d)return 0;if(c[1]){c=new b(b.ZERO);do c=c.add(new b(d.pt.X+d.prev.pt.X).multiply(new b(d.prev.pt.Y-d.pt.Y))),d=d.next;while(d!=a.pts);return parseFloat(c.toString())/2}c=0;do c+=(d.pt.X+d.prev.pt.X)*(d.prev.pt.Y-d.pt.Y),d=d.next;while(d!=a.pts);return c/2}},B.Clipper.BuildArc=function(a,b,c,d){var e=Math.sqrt(B.Math_Abs_Double(d))*B.Math_Abs_Double(c-b),e=e/4;6>e&&(e=6),e>64&&(e=B.MaxSteps);var e=B.Cast_Int32(e),f=new B.Polygon;c=(c-b)/(e-1);for(var g=0;e>g;++g)f.push(new B.IntPoint(a.X+B.Clipper.Round(Math.cos(b)*d),a.Y+B.Clipper.Round(Math.sin(b)*d))),b+=c;return f},B.Clipper.GetUnitNormal=function(a,b){var c=b.X-a.X,d=b.Y-a.Y;if(0==c&&0==d)return new B.Clipper.DoublePoint(0,0);var e=1/Math.sqrt(c*c+d*d);return new B.Clipper.DoublePoint(d*e,-(c*e))},B.Clipper.prototype.OffsetPolygons=function(a,b,c,d,e){var f=arguments;return 4==f.length?e=!0:3==f.length?(d=2,e=!0):2==f.length&&(c=B.JoinType.jtSquare,d=2,e=!0),isNaN(b)?B.Error("Delta is not a number"):isNaN(d)&&B.Error("MiterLimit is not a number"),f={},new B.Clipper.PolyOffsetBuilder(a,f,b,c,d,e),f=f.Value?f.Value:[[]]},B.Clipper.prototype.SimplifyPolygon=function(a,b){var c=new B.Polygons,d=new B.Clipper;return d.AddPolygon(a,B.PolyType.ptSubject)&&d.Execute(B.ClipType.ctUnion,c,b,b),c},B.Clipper.prototype.SimplifyPolygons=function(a,b){var c=new B.Polygons,d=new B.Clipper;return d.AddPolygons(a,B.PolyType.ptSubject)&&d.Execute(B.ClipType.ctUnion,c,b,b),c},t=B.Clipper,u=B.ClipperBase;var G;if("undefined"==typeof Object.getOwnPropertyNames)for(G in u.prototype)("undefined"==typeof t.prototype[G]||t.prototype[G]==Object.prototype[G])&&(t.prototype[G]=u.prototype[G]);else for(z=Object.getOwnPropertyNames(u.prototype),s=0;s<z.length;s++)"undefined"==typeof Object.getOwnPropertyDescriptor(t.prototype,z[s])&&Object.defineProperty(t.prototype,z[s],Object.getOwnPropertyDescriptor(u.prototype,z[s]));for(G in u)"undefined"==typeof t[G]&&(t[G]=u[G]);t.$baseCtor=u,B.Clipper.DoublePoint=function(a,b){this.X=a,this.Y=b},B.Clipper.PolyOffsetBuilder=function(a,b,c,d,e,f){if(this.normals=this.currentPoly=this.pts=null,this.m_k=this.m_j=this.m_i=this.m_R=this.delta=0,this.botPt=null,0==c)b.Value=a;else{if(this.pts=a,this.delta=c,f){for(var g=this.pts.length,h=0;g>h&&0==this.pts[h].length;)h++;if(h==g)return;for(this.botPt=this.pts[h][0],f=h;g>f;++f)for(this.UpdateBotPt(this.pts[f][0])&&(h=f),a=this.pts[f].length-1;a>0;a--)B.ClipperBase.PointsEqual(this.pts[f][a],this.pts[f][a-1])?this.pts[f].splice(a,1):this.UpdateBotPt(this.pts[f][a])&&(h=f);B.Clipper.Orientation(this.pts[h])||B.Clipper.ReversePolygons(this.pts)}for(1>=e&&(e=1),f=2/(e*e),this.normals=[],b.Value=new B.Polygons,B.Clear(b.Value),this.m_i=0;this.m_i<this.pts.length;this.m_i++)if(g=this.pts[this.m_i].length,g>1&&this.pts[this.m_i][0].X==this.pts[this.m_i][g-1].X&&this.pts[this.m_i][0].Y==this.pts[this.m_i][g-1].Y&&g--,!(0==g||3>g&&0>=c))if(1==g)a=B.Clipper.BuildArc(this.pts[this.m_i][g-1],0,B.PI2,c),b.Value.push(a);else{for(B.Clear(this.normals),a=0;g-1>a;++a)this.normals.push(B.Clipper.GetUnitNormal(this.pts[this.m_i][a],this.pts[this.m_i][a+1]));for(this.normals.push(B.Clipper.GetUnitNormal(this.pts[this.m_i][g-1],this.pts[this.m_i][0])),this.currentPoly=new B.Polygon,this.m_k=g-1,this.m_j=0;this.m_j<g;++this.m_j){switch(d){case B.JoinType.jtMiter:this.m_R=1+(this.normals[this.m_j].X*this.normals[this.m_k].X+this.normals[this.m_j].Y*this.normals[this.m_k].Y),this.m_R>=f?this.DoMiter():this.DoSquare(e);break;case B.JoinType.jtRound:this.DoRound();break;case B.JoinType.jtSquare:this.DoSquare(1)}this.m_k=this.m_j}b.Value.push(this.currentPoly)}if(d=new B.Clipper,d.AddPolygons(b.Value,B.PolyType.ptSubject),c>0)d.Execute(B.ClipType.ctUnion,b.Value,B.PolyFillType.pftPositive,B.PolyFillType.pftPositive);else if(c=d.GetBounds(),e=new B.Polygon,e.push(new B.IntPoint(c.left-10,c.bottom+10)),e.push(new B.IntPoint(c.right+10,c.bottom+10)),e.push(new B.IntPoint(c.right+10,c.top-10)),e.push(new B.IntPoint(c.left-10,c.top-10)),d.AddPolygon(e,B.PolyType.ptSubject),d.Execute(B.ClipType.ctUnion,b.Value,B.PolyFillType.pftNegative,B.PolyFillType.pftNegative),0<b.Value.length)for(b.Value.splice(0,1),f=0;f<b.Value.length;f++)b.Value[f].reverse()}},B.Clipper.PolyOffsetBuilder.prototype.UpdateBotPt=function(a){return a.Y>this.botPt.Y||a.Y==this.botPt.Y&&a.X<this.botPt.X?(this.botPt=a,!0):!1},B.Clipper.PolyOffsetBuilder.prototype.AddPoint=function(a){this.currentPoly.push(a)},B.Clipper.PolyOffsetBuilder.prototype.DoSquare=function(a){var b=new B.IntPoint(B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_k].X*this.delta)),B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_k].Y*this.delta))),c=new B.IntPoint(B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_j].X*this.delta)),B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_j].Y*this.delta)));if(0<=(this.normals[this.m_k].X*this.normals[this.m_j].Y-this.normals[this.m_j].X*this.normals[this.m_k].Y)*this.delta){var d=Math.atan2(this.normals[this.m_k].Y,this.normals[this.m_k].X),e=Math.atan2(-this.normals[this.m_j].Y,-this.normals[this.m_j].X),d=Math.abs(e-d);d>B.PI&&(d=B.PI2-d),a=Math.tan((B.PI-d)/4)*Math.abs(this.delta*a),b=new B.IntPoint(B.Cast_Int64(b.X-this.normals[this.m_k].Y*a),B.Cast_Int64(b.Y+this.normals[this.m_k].X*a)),this.AddPoint(b),c=new B.IntPoint(B.Cast_Int64(c.X+this.normals[this.m_j].Y*a),B.Cast_Int64(c.Y-this.normals[this.m_j].X*a))}else this.AddPoint(b),this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(c)},B.Clipper.PolyOffsetBuilder.prototype.DoMiter=function(){if(0<=(this.normals[this.m_k].X*this.normals[this.m_j].Y-this.normals[this.m_j].X*this.normals[this.m_k].Y)*this.delta){var a=this.delta/this.m_R;this.AddPoint(new B.IntPoint(B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].X+(this.normals[this.m_k].X+this.normals[this.m_j].X)*a)),B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].Y+(this.normals[this.m_k].Y+this.normals[this.m_j].Y)*a))))}else{var a=new B.IntPoint(B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_k].X*this.delta)),B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_k].Y*this.delta))),b=new B.IntPoint(B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_j].X*this.delta)),B.Cast_Int64(B.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_j].Y*this.delta)));this.AddPoint(a),this.AddPoint(this.pts[this.m_i][this.m_j]),this.AddPoint(b)}},B.Clipper.PolyOffsetBuilder.prototype.DoRound=function(){var a=new B.IntPoint(B.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_k].X*this.delta),B.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_k].Y*this.delta)),b=new B.IntPoint(B.Clipper.Round(this.pts[this.m_i][this.m_j].X+this.normals[this.m_j].X*this.delta),B.Clipper.Round(this.pts[this.m_i][this.m_j].Y+this.normals[this.m_j].Y*this.delta));if(this.AddPoint(a),0<=(this.normals[this.m_k].X*this.normals[this.m_j].Y-this.normals[this.m_j].X*this.normals[this.m_k].Y)*this.delta){if(.985>this.normals[this.m_j].X*this.normals[this.m_k].X+this.normals[this.m_j].Y*this.normals[this.m_k].Y){var a=Math.atan2(this.normals[this.m_k].Y,this.normals[this.m_k].X),c=Math.atan2(this.normals[this.m_j].Y,this.normals[this.m_j].X);for(0<this.delta&&a>c?c+=B.PI2:0>this.delta&&c>a&&(c-=B.PI2),a=B.Clipper.BuildArc(this.pts[this.m_i][this.m_j],a,c,this.delta),c=0;c<a.length;c++)this.AddPoint(a[c])}}else this.AddPoint(this.pts[this.m_i][this.m_j]);this.AddPoint(b)},B.Error=function(a){try{throw Error(a)}catch(b){alert(b.message)}},B.Clone=function(a){if(!(a instanceof Array)||0==a.length)return[];if(1==a.length&&0==a[0].length)return[[]];var b=a[0]instanceof Array;b||(a=[a]);var c,d,e,f,g=a.length,h=[];for(d=0;g>d;d++){for(c=a[d].length,f=[],e=0;c>e;e++)f.push({X:a[d][e].X,Y:a[d][e].Y});h.push(f)}return b||(h=h[0]),h},B.Clean=function(a,b){if(!(a instanceof Array))return[];var c=a[0]instanceof Array;if(a=B.Clone(a),"number"!=typeof b||null===b)return B.Error("Delta is not a number in Clean()."),a;if(0==a.length||1==a.length&&0==a[0].length||0>b)return a;c||(a=[a]);for(var d,e,f,g,h,i,j,k=a.length,l=[],m=0;k>m;m++)if(e=a[m],d=e.length,0!=d)if(3>d)f=e,l.push(f);else{for(f=e,g=b*b,h=e[0],j=i=1;d>j;j++)(e[j].X-h.X)*(e[j].X-h.X)+(e[j].Y-h.Y)*(e[j].Y-h.Y)<=g||(f[i]=e[j],h=e[j],i++);h=e[i-1],(e[0].X-h.X)*(e[0].X-h.X)+(e[0].Y-h.Y)*(e[0].Y-h.Y)<=g&&i--,d>i&&f.splice(i,d-i),f.length&&l.push(f)}return!c&&l.length?l=l[0]:c||0!=l.length?c&&0==l.length&&(l=[[]]):l=[],l},B.Lighten=function(a,b){if(!(a instanceof Array))return[];if("number"!=typeof b||null===b)return B.Error("Tolerance is not a number in Lighten()."),B.Clone(a);if(0===a.length||1==a.length&&0===a[0].length||0>b)return B.Clone(a);a[0]instanceof Array||(a=[a]);var c,d,e,f,g,h,i,j,k,l,m,n,o,p=a.length,q=[];for(c=0;p>c;c++){for(e=a[c],f=0;1e6>f;f++){for(g=[],h=e.length,e[h-1].X!=e[0].X||e[h-1].Y!=e[0].Y?(n=1,e.push({X:e[0].X,Y:e[0].Y}),h=e.length):n=0,m=[],d=0;h-2>d;d++)i=e[d],k=e[d+1],j=e[d+2],o=j.X-i.X,j=j.Y-i.Y,l=0,(0!==o||0!==j)&&(l=Math.sqrt(o*o+j*j),l=Math.abs((k.X-i.X)*j-(k.Y-i.Y)*o)/l),b>=l&&(m[d+1]=1,d++);for(g.push({X:e[0].X,Y:e[0].Y}),d=1;h-1>d;d++)m[d]||g.push({X:e[d].X,Y:e[d].Y});if(g.push({X:e[h-1].X,Y:e[h-1].Y}),n&&e.pop(),!m.length)break;e=g}h=g.length,g[h-1].X==g[0].X&&g[h-1].Y==g[0].Y&&g.pop(),2<g.length&&q.push(g)}return!a[0]instanceof Array&&(q=q[0]),"undefined"==typeof q&&(q=[[]]),q},a.ClipperLib=B}(window),function(a,b){function c(a){return J.isWindow(a)?a:9===a.nodeType?a.defaultView||a.parentWindow:!1}function d(a){if(!sb[a]){var b=G.body,c=J("<"+a+">").appendTo(b),d=c.css("display");c.remove(),("none"===d||""===d)&&(ob||(ob=G.createElement("iframe"),ob.frameBorder=ob.width=ob.height=0),b.appendChild(ob),pb&&ob.createElement||(pb=(ob.contentWindow||ob.contentDocument).document,pb.write((J.support.boxModel?"<!doctype html>":"")+"<html><body>"),pb.close()),c=pb.createElement(a),pb.body.appendChild(c),d=J.css(c,"display"),b.removeChild(ob)),sb[a]=d}return sb[a]}function e(a,b){var c={};return J.each(vb.concat.apply([],vb.slice(0,b)),function(){c[this]=a}),c}function f(){rb=b}function g(){return setTimeout(f,0),rb=J.now()}function h(){try{return new a.ActiveXObject("Microsoft.XMLHTTP")}catch(b){}}function i(){try{return new a.XMLHttpRequest}catch(b){}}function j(a,c){a.dataFilter&&(c=a.dataFilter(c,a.dataType));var d,e,f,g,h,i,j,k,l=a.dataTypes,m={},n=l.length,o=l[0];for(d=1;n>d;d++){if(1===d)for(e in a.converters)"string"==typeof e&&(m[e.toLowerCase()]=a.converters[e]);if(g=o,o=l[d],"*"===o)o=g;else if("*"!==g&&g!==o){if(h=g+" "+o,i=m[h]||m["* "+o],!i){k=b;for(j in m)if(f=j.split(" "),(f[0]===g||"*"===f[0])&&(k=m[f[1]+" "+o])){j=m[j],j===!0?i=k:k===!0&&(i=j);break}}!i&&!k&&J.error("No conversion from "+h.replace(" "," to ")),i!==!0&&(c=i?i(c):k(j(c)))}}return c}function k(a,c,d){var e,f,g,h,i=a.contents,j=a.dataTypes,k=a.responseFields;for(f in k)f in d&&(c[k[f]]=d[f]);for(;"*"===j[0];)j.shift(),e===b&&(e=a.mimeType||c.getResponseHeader("content-type"));if(e)for(f in i)if(i[f]&&i[f].test(e)){j.unshift(f);break}if(j[0]in d)g=j[0];else{for(f in d){if(!j[0]||a.converters[f+" "+j[0]]){g=f;break}h||(h=f)}g=g||h}return g?(g!==j[0]&&j.unshift(g),d[g]):void 0}function l(a,b,c,d){if(J.isArray(b))J.each(b,function(b,e){c||Sa.test(a)?d(a,e):l(a+"["+("object"==typeof e?b:"")+"]",e,c,d)});else if(c||"object"!==J.type(b))d(a,b);else for(var e in b)l(a+"["+e+"]",b[e],c,d)}function m(a,c){var d,e,f=J.ajaxSettings.flatOptions||{};for(d in c)c[d]!==b&&((f[d]?a:e||(e={}))[d]=c[d]);e&&J.extend(!0,a,e)}function n(a,c,d,e,f,g){f=f||c.dataTypes[0],g=g||{},g[f]=!0;for(var h,i=a[f],j=0,k=i?i.length:0,l=a===fb;k>j&&(l||!h);j++)h=i[j](c,d,e),"string"==typeof h&&(!l||g[h]?h=b:(c.dataTypes.unshift(h),h=n(a,c,d,e,h,g)));return(l||!h)&&!g["*"]&&(h=n(a,c,d,e,"*",g)),h}function o(a){return function(b,c){if("string"!=typeof b&&(c=b,b="*"),J.isFunction(c))for(var d,e,f,g=b.toLowerCase().split(bb),h=0,i=g.length;i>h;h++)d=g[h],f=/^\+/.test(d),f&&(d=d.substr(1)||"*"),e=a[d]=a[d]||[],e[f?"unshift":"push"](c)}}function p(a,b,c){var d="width"===b?a.offsetWidth:a.offsetHeight,e="width"===b?1:0,f=4;if(d>0){if("border"!==c)for(;f>e;e+=2)c||(d-=parseFloat(J.css(a,"padding"+Oa[e]))||0),"margin"===c?d+=parseFloat(J.css(a,c+Oa[e]))||0:d-=parseFloat(J.css(a,"border"+Oa[e]+"Width"))||0;return d+"px"}if(d=Da(a,b),(0>d||null==d)&&(d=a.style[b]),Ka.test(d))return d;if(d=parseFloat(d)||0,c)for(;f>e;e+=2)d+=parseFloat(J.css(a,"padding"+Oa[e]))||0,"padding"!==c&&(d+=parseFloat(J.css(a,"border"+Oa[e]+"Width"))||0),"margin"===c&&(d+=parseFloat(J.css(a,c+Oa[e]))||0);return d+"px"}function q(a){var b=G.createElement("div");return Ca.appendChild(b),b.innerHTML=a.outerHTML,b.firstChild}function r(a){var b=(a.nodeName||"").toLowerCase();"input"===b?s(a):"script"!==b&&"undefined"!=typeof a.getElementsByTagName&&J.grep(a.getElementsByTagName("input"),s)}function s(a){("checkbox"===a.type||"radio"===a.type)&&(a.defaultChecked=a.checked)}function t(a){return"undefined"!=typeof a.getElementsByTagName?a.getElementsByTagName("*"):"undefined"!=typeof a.querySelectorAll?a.querySelectorAll("*"):[]}function u(a,b){var c;1===b.nodeType&&(b.clearAttributes&&b.clearAttributes(),b.mergeAttributes&&b.mergeAttributes(a),
c=b.nodeName.toLowerCase(),"object"===c?b.outerHTML=a.outerHTML:"input"!==c||"checkbox"!==a.type&&"radio"!==a.type?"option"===c?b.selected=a.defaultSelected:"input"===c||"textarea"===c?b.defaultValue=a.defaultValue:"script"===c&&b.text!==a.text&&(b.text=a.text):(a.checked&&(b.defaultChecked=b.checked=a.checked),b.value!==a.value&&(b.value=a.value)),b.removeAttribute(J.expando),b.removeAttribute("_submit_attached"),b.removeAttribute("_change_attached"))}function v(a,b){if(1===b.nodeType&&J.hasData(a)){var c,d,e,f=J._data(a),g=J._data(b,f),h=f.events;if(h){delete g.handle,g.events={};for(c in h)for(d=0,e=h[c].length;e>d;d++)J.event.add(b,c,h[c][d])}g.data&&(g.data=J.extend({},g.data))}}function w(a,b){return J.nodeName(a,"table")?a.getElementsByTagName("tbody")[0]||a.appendChild(a.ownerDocument.createElement("tbody")):a}function x(a){var b=oa.split("|"),c=a.createDocumentFragment();if(c.createElement)for(;b.length;)c.createElement(b.pop());return c}function y(a,b,c){if(b=b||0,J.isFunction(b))return J.grep(a,function(a,d){var e=!!b.call(a,d,a);return e===c});if(b.nodeType)return J.grep(a,function(a,d){return a===b===c});if("string"==typeof b){var d=J.grep(a,function(a){return 1===a.nodeType});if(ka.test(b))return J.filter(b,d,!c);b=J.filter(b,d)}return J.grep(a,function(a,d){return J.inArray(a,b)>=0===c})}function z(a){return!a||!a.parentNode||11===a.parentNode.nodeType}function A(){return!0}function B(){return!1}function C(a,b,c){var d=b+"defer",e=b+"queue",f=b+"mark",g=J._data(a,d);!(!g||"queue"!==c&&J._data(a,e)||"mark"!==c&&J._data(a,f)||!setTimeout(function(){!J._data(a,e)&&!J._data(a,f)&&(J.removeData(a,d,!0),g.fire())},0))}function D(a){for(var b in a)if(("data"!==b||!J.isEmptyObject(a[b]))&&"toJSON"!==b)return!1;return!0}function E(a,c,d){if(d===b&&1===a.nodeType){var e="data-"+c.replace(N,"-$1").toLowerCase();if(d=a.getAttribute(e),"string"==typeof d){try{d="true"===d?!0:"false"===d?!1:"null"===d?null:J.isNumeric(d)?+d:M.test(d)?J.parseJSON(d):d}catch(f){}J.data(a,c,d)}else d=b}return d}function F(a){var b,c,d=K[a]={};for(a=a.split(/\s+/),b=0,c=a.length;c>b;b++)d[a[b]]=!0;return d}var G=a.document,H=a.navigator,I=a.location,J=function(){function c(){if(!h.isReady){try{G.documentElement.doScroll("left")}catch(a){return void setTimeout(c,1)}h.ready()}}var d,e,f,g,h=function(a,b){return new h.fn.init(a,b,d)},i=a.jQuery,j=a.$,k=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,l=/\S/,m=/^\s+/,n=/\s+$/,o=/^<(\w+)\s*\/?>(?:<\/\1>)?$/,p=/^[\],:{}\s]*$/,q=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,s=/(?:^|:|,)(?:\s*\[)+/g,t=/(webkit)[ \/]([\w.]+)/,u=/(opera)(?:.*version)?[ \/]([\w.]+)/,v=/(msie) ([\w.]+)/,w=/(mozilla)(?:.*? rv:([\w.]+))?/,x=/-([a-z]|[0-9])/gi,y=/^-ms-/,z=function(a,b){return(b+"").toUpperCase()},A=H.userAgent,B=Object.prototype.toString,C=Object.prototype.hasOwnProperty,D=Array.prototype.push,E=Array.prototype.slice,F=String.prototype.trim,I=Array.prototype.indexOf,J={};return h.fn=h.prototype={constructor:h,init:function(a,c,d){var e,f,g,i;if(!a)return this;if(a.nodeType)return this.context=this[0]=a,this.length=1,this;if("body"===a&&!c&&G.body)return this.context=G,this[0]=G.body,this.selector=a,this.length=1,this;if("string"==typeof a){if(e="<"!==a.charAt(0)||">"!==a.charAt(a.length-1)||a.length<3?k.exec(a):[null,a,null],e&&(e[1]||!c)){if(e[1])return c=c instanceof h?c[0]:c,i=c?c.ownerDocument||c:G,g=o.exec(a),g?h.isPlainObject(c)?(a=[G.createElement(g[1])],h.fn.attr.call(a,c,!0)):a=[i.createElement(g[1])]:(g=h.buildFragment([e[1]],[i]),a=(g.cacheable?h.clone(g.fragment):g.fragment).childNodes),h.merge(this,a);if(f=G.getElementById(e[2]),f&&f.parentNode){if(f.id!==e[2])return d.find(a);this.length=1,this[0]=f}return this.context=G,this.selector=a,this}return!c||c.jquery?(c||d).find(a):this.constructor(c).find(a)}return h.isFunction(a)?d.ready(a):(a.selector!==b&&(this.selector=a.selector,this.context=a.context),h.makeArray(a,this))},selector:"",jquery:"1.7.2",length:0,size:function(){return this.length},toArray:function(){return E.call(this,0)},get:function(a){return null==a?this.toArray():0>a?this[this.length+a]:this[a]},pushStack:function(a,b,c){var d=this.constructor();return h.isArray(a)?D.apply(d,a):h.merge(d,a),d.prevObject=this,d.context=this.context,"find"===b?d.selector=this.selector+(this.selector?" ":"")+c:b&&(d.selector=this.selector+"."+b+"("+c+")"),d},each:function(a,b){return h.each(this,a,b)},ready:function(a){return h.bindReady(),f.add(a),this},eq:function(a){return a=+a,-1===a?this.slice(a):this.slice(a,a+1)},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},slice:function(){return this.pushStack(E.apply(this,arguments),"slice",E.call(arguments).join(","))},map:function(a){return this.pushStack(h.map(this,function(b,c){return a.call(b,c,b)}))},end:function(){return this.prevObject||this.constructor(null)},push:D,sort:[].sort,splice:[].splice},h.fn.init.prototype=h.fn,h.extend=h.fn.extend=function(){var a,c,d,e,f,g,i=arguments[0]||{},j=1,k=arguments.length,l=!1;for("boolean"==typeof i&&(l=i,i=arguments[1]||{},j=2),"object"!=typeof i&&!h.isFunction(i)&&(i={}),k===j&&(i=this,--j);k>j;j++)if(null!=(a=arguments[j]))for(c in a)d=i[c],e=a[c],i!==e&&(l&&e&&(h.isPlainObject(e)||(f=h.isArray(e)))?(f?(f=!1,g=d&&h.isArray(d)?d:[]):g=d&&h.isPlainObject(d)?d:{},i[c]=h.extend(l,g,e)):e!==b&&(i[c]=e));return i},h.extend({noConflict:function(b){return a.$===h&&(a.$=j),b&&a.jQuery===h&&(a.jQuery=i),h},isReady:!1,readyWait:1,holdReady:function(a){a?h.readyWait++:h.ready(!0)},ready:function(a){if(a===!0&&!--h.readyWait||a!==!0&&!h.isReady){if(!G.body)return setTimeout(h.ready,1);if(h.isReady=!0,a!==!0&&--h.readyWait>0)return;f.fireWith(G,[h]),h.fn.trigger&&h(G).trigger("ready").off("ready")}},bindReady:function(){if(!f){if(f=h.Callbacks("once memory"),"complete"===G.readyState)return setTimeout(h.ready,1);if(G.addEventListener)G.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",h.ready,!1);else if(G.attachEvent){G.attachEvent("onreadystatechange",g),a.attachEvent("onload",h.ready);var b=!1;try{b=null==a.frameElement}catch(d){}G.documentElement.doScroll&&b&&c()}}},isFunction:function(a){return"function"===h.type(a)},isArray:Array.isArray||function(a){return"array"===h.type(a)},isWindow:function(a){return null!=a&&a==a.window},isNumeric:function(a){return!isNaN(parseFloat(a))&&isFinite(a)},type:function(a){return null==a?String(a):J[B.call(a)]||"object"},isPlainObject:function(a){if(!a||"object"!==h.type(a)||a.nodeType||h.isWindow(a))return!1;try{if(a.constructor&&!C.call(a,"constructor")&&!C.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(c){return!1}var d;for(d in a);return d===b||C.call(a,d)},isEmptyObject:function(a){for(var b in a)return!1;return!0},error:function(a){throw new Error(a)},parseJSON:function(b){return"string"==typeof b&&b?(b=h.trim(b),a.JSON&&a.JSON.parse?a.JSON.parse(b):p.test(b.replace(q,"@").replace(r,"]").replace(s,""))?new Function("return "+b)():void h.error("Invalid JSON: "+b)):null},parseXML:function(c){if("string"!=typeof c||!c)return null;var d,e;try{a.DOMParser?(e=new DOMParser,d=e.parseFromString(c,"text/xml")):(d=new ActiveXObject("Microsoft.XMLDOM"),d.async="false",d.loadXML(c))}catch(f){d=b}return(!d||!d.documentElement||d.getElementsByTagName("parsererror").length)&&h.error("Invalid XML: "+c),d},noop:function(){},globalEval:function(b){b&&l.test(b)&&(a.execScript||function(b){a.eval.call(a,b)})(b)},camelCase:function(a){return a.replace(y,"ms-").replace(x,z)},nodeName:function(a,b){return a.nodeName&&a.nodeName.toUpperCase()===b.toUpperCase()},each:function(a,c,d){var e,f=0,g=a.length,i=g===b||h.isFunction(a);if(d)if(i){for(e in a)if(c.apply(a[e],d)===!1)break}else for(;g>f&&c.apply(a[f++],d)!==!1;);else if(i){for(e in a)if(c.call(a[e],e,a[e])===!1)break}else for(;g>f&&c.call(a[f],f,a[f++])!==!1;);return a},trim:F?function(a){return null==a?"":F.call(a)}:function(a){return null==a?"":(a+"").replace(m,"").replace(n,"")},makeArray:function(a,b){var c=b||[];if(null!=a){var d=h.type(a);null==a.length||"string"===d||"function"===d||"regexp"===d||h.isWindow(a)?D.call(c,a):h.merge(c,a)}return c},inArray:function(a,b,c){var d;if(b){if(I)return I.call(b,a,c);for(d=b.length,c=c?0>c?Math.max(0,d+c):c:0;d>c;c++)if(c in b&&b[c]===a)return c}return-1},merge:function(a,c){var d=a.length,e=0;if("number"==typeof c.length)for(var f=c.length;f>e;e++)a[d++]=c[e];else for(;c[e]!==b;)a[d++]=c[e++];return a.length=d,a},grep:function(a,b,c){var d,e=[];c=!!c;for(var f=0,g=a.length;g>f;f++)d=!!b(a[f],f),c!==d&&e.push(a[f]);return e},map:function(a,c,d){var e,f,g=[],i=0,j=a.length,k=a instanceof h||j!==b&&"number"==typeof j&&(j>0&&a[0]&&a[j-1]||0===j||h.isArray(a));if(k)for(;j>i;i++)e=c(a[i],i,d),null!=e&&(g[g.length]=e);else for(f in a)e=c(a[f],f,d),null!=e&&(g[g.length]=e);return g.concat.apply([],g)},guid:1,proxy:function(a,c){if("string"==typeof c){var d=a[c];c=a,a=d}if(!h.isFunction(a))return b;var e=E.call(arguments,2),f=function(){return a.apply(c,e.concat(E.call(arguments)))};return f.guid=a.guid=a.guid||f.guid||h.guid++,f},access:function(a,c,d,e,f,g,i){var j,k=null==d,l=0,m=a.length;if(d&&"object"==typeof d){for(l in d)h.access(a,c,l,d[l],1,g,e);f=1}else if(e!==b){if(j=i===b&&h.isFunction(e),k&&(j?(j=c,c=function(a,b,c){return j.call(h(a),c)}):(c.call(a,e),c=null)),c)for(;m>l;l++)c(a[l],d,j?e.call(a[l],l,c(a[l],d)):e,i);f=1}return f?a:k?c.call(a):m?c(a[0],d):g},now:function(){return(new Date).getTime()},uaMatch:function(a){a=a.toLowerCase();var b=t.exec(a)||u.exec(a)||v.exec(a)||a.indexOf("compatible")<0&&w.exec(a)||[];return{browser:b[1]||"",version:b[2]||"0"}},sub:function(){function a(b,c){return new a.fn.init(b,c)}h.extend(!0,a,this),a.superclass=this,a.fn=a.prototype=this(),a.fn.constructor=a,a.sub=this.sub,a.fn.init=function(c,d){return d&&d instanceof h&&!(d instanceof a)&&(d=a(d)),h.fn.init.call(this,c,d,b)},a.fn.init.prototype=a.fn;var b=a(G);return a},browser:{}}),h.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(a,b){J["[object "+b+"]"]=b.toLowerCase()}),e=h.uaMatch(A),e.browser&&(h.browser[e.browser]=!0,h.browser.version=e.version),h.browser.webkit&&(h.browser.safari=!0),l.test("")&&(m=/^[\s\xA0]+/,n=/[\s\xA0]+$/),d=h(G),G.addEventListener?g=function(){G.removeEventListener("DOMContentLoaded",g,!1),h.ready()}:G.attachEvent&&(g=function(){"complete"===G.readyState&&(G.detachEvent("onreadystatechange",g),h.ready())}),h}(),K={};J.Callbacks=function(a){a=a?K[a]||F(a):{};var c,d,e,f,g,h,i=[],j=[],k=function(b){var c,d,e,f;for(c=0,d=b.length;d>c;c++)e=b[c],f=J.type(e),"array"===f?k(e):"function"===f&&(!a.unique||!m.has(e))&&i.push(e)},l=function(b,k){for(k=k||[],c=!a.memory||[b,k],d=!0,e=!0,h=f||0,f=0,g=i.length;i&&g>h;h++)if(i[h].apply(b,k)===!1&&a.stopOnFalse){c=!0;break}e=!1,i&&(a.once?c===!0?m.disable():i=[]:j&&j.length&&(c=j.shift(),m.fireWith(c[0],c[1])))},m={add:function(){if(i){var a=i.length;k(arguments),e?g=i.length:c&&c!==!0&&(f=a,l(c[0],c[1]))}return this},remove:function(){if(i)for(var b=arguments,c=0,d=b.length;d>c;c++)for(var f=0;f<i.length&&(b[c]!==i[f]||(e&&g>=f&&(g--,h>=f&&h--),i.splice(f--,1),!a.unique));f++);return this},has:function(a){if(i)for(var b=0,c=i.length;c>b;b++)if(a===i[b])return!0;return!1},empty:function(){return i=[],this},disable:function(){return i=j=c=b,this},disabled:function(){return!i},lock:function(){return j=b,(!c||c===!0)&&m.disable(),this},locked:function(){return!j},fireWith:function(b,d){return j&&(e?a.once||j.push([b,d]):(!a.once||!c)&&l(b,d)),this},fire:function(){return m.fireWith(this,arguments),this},fired:function(){return!!d}};return m};var L=[].slice;J.extend({Deferred:function(a){var b,c=J.Callbacks("once memory"),d=J.Callbacks("once memory"),e=J.Callbacks("memory"),f="pending",g={resolve:c,reject:d,notify:e},h={done:c.add,fail:d.add,progress:e.add,state:function(){return f},isResolved:c.fired,isRejected:d.fired,then:function(a,b,c){return i.done(a).fail(b).progress(c),this},always:function(){return i.done.apply(i,arguments).fail.apply(i,arguments),this},pipe:function(a,b,c){return J.Deferred(function(d){J.each({done:[a,"resolve"],fail:[b,"reject"],progress:[c,"notify"]},function(a,b){var c,e=b[0],f=b[1];J.isFunction(e)?i[a](function(){c=e.apply(this,arguments),c&&J.isFunction(c.promise)?c.promise().then(d.resolve,d.reject,d.notify):d[f+"With"](this===i?d:this,[c])}):i[a](d[f])})}).promise()},promise:function(a){if(null==a)a=h;else for(var b in h)a[b]=h[b];return a}},i=h.promise({});for(b in g)i[b]=g[b].fire,i[b+"With"]=g[b].fireWith;return i.done(function(){f="resolved"},d.disable,e.lock).fail(function(){f="rejected"},c.disable,e.lock),a&&a.call(i,i),i},when:function(a){function b(a){return function(b){g[a]=arguments.length>1?L.call(arguments,0):b,i.notifyWith(j,g)}}function c(a){return function(b){d[a]=arguments.length>1?L.call(arguments,0):b,--h||i.resolveWith(i,d)}}var d=L.call(arguments,0),e=0,f=d.length,g=Array(f),h=f,i=1>=f&&a&&J.isFunction(a.promise)?a:J.Deferred(),j=i.promise();if(f>1){for(;f>e;e++)d[e]&&d[e].promise&&J.isFunction(d[e].promise)?d[e].promise().then(c(e),i.reject,b(e)):--h;h||i.resolveWith(i,d)}else i!==a&&i.resolveWith(i,f?[a]:[]);return j}}),J.support=function(){var b,c,d,e,f,g,h,i,j,k,l,m=G.createElement("div");G.documentElement;if(m.setAttribute("className","t"),m.innerHTML="   <link/><table></table><a href='/a' style='top:1px;float:left;opacity:.55;'>a</a><input type='checkbox'/>",c=m.getElementsByTagName("*"),d=m.getElementsByTagName("a")[0],!c||!c.length||!d)return{};e=G.createElement("select"),f=e.appendChild(G.createElement("option")),g=m.getElementsByTagName("input")[0],b={leadingWhitespace:3===m.firstChild.nodeType,tbody:!m.getElementsByTagName("tbody").length,htmlSerialize:!!m.getElementsByTagName("link").length,style:/top/.test(d.getAttribute("style")),hrefNormalized:"/a"===d.getAttribute("href"),opacity:/^0.55/.test(d.style.opacity),cssFloat:!!d.style.cssFloat,checkOn:"on"===g.value,optSelected:f.selected,getSetAttribute:"t"!==m.className,enctype:!!G.createElement("form").enctype,html5Clone:"<:nav></:nav>"!==G.createElement("nav").cloneNode(!0).outerHTML,submitBubbles:!0,changeBubbles:!0,focusinBubbles:!1,deleteExpando:!0,noCloneEvent:!0,inlineBlockNeedsLayout:!1,shrinkWrapBlocks:!1,reliableMarginRight:!0,pixelMargin:!0},J.boxModel=b.boxModel="CSS1Compat"===G.compatMode,g.checked=!0,b.noCloneChecked=g.cloneNode(!0).checked,e.disabled=!0,b.optDisabled=!f.disabled;try{delete m.test}catch(n){b.deleteExpando=!1}if(!m.addEventListener&&m.attachEvent&&m.fireEvent&&(m.attachEvent("onclick",function(){b.noCloneEvent=!1}),m.cloneNode(!0).fireEvent("onclick")),g=G.createElement("input"),g.value="t",g.setAttribute("type","radio"),b.radioValue="t"===g.value,g.setAttribute("checked","checked"),g.setAttribute("name","t"),m.appendChild(g),h=G.createDocumentFragment(),h.appendChild(m.lastChild),b.checkClone=h.cloneNode(!0).cloneNode(!0).lastChild.checked,b.appendChecked=g.checked,h.removeChild(g),h.appendChild(m),m.attachEvent)for(k in{submit:1,change:1,focusin:1})j="on"+k,l=j in m,l||(m.setAttribute(j,"return;"),l="function"==typeof m[j]),b[k+"Bubbles"]=l;return h.removeChild(m),h=e=f=m=g=null,J(function(){var c,d,e,f,g,h,j,k,n,o,p,q,r=G.getElementsByTagName("body")[0];!r||(j=1,q="padding:0;margin:0;border:",o="position:absolute;top:0;left:0;width:1px;height:1px;",p=q+"0;visibility:hidden;",k="style='"+o+q+"5px solid #000;",n="<div "+k+"display:block;'><div style='"+q+"0;display:block;overflow:hidden;'></div></div><table "+k+"' cellpadding='0' cellspacing='0'><tr><td></td></tr></table>",c=G.createElement("div"),c.style.cssText=p+"width:0;height:0;position:static;top:0;margin-top:"+j+"px",r.insertBefore(c,r.firstChild),m=G.createElement("div"),c.appendChild(m),m.innerHTML="<table><tr><td style='"+q+"0;display:none'></td><td>t</td></tr></table>",i=m.getElementsByTagName("td"),l=0===i[0].offsetHeight,i[0].style.display="",i[1].style.display="none",b.reliableHiddenOffsets=l&&0===i[0].offsetHeight,a.getComputedStyle&&(m.innerHTML="",h=G.createElement("div"),h.style.width="0",h.style.marginRight="0",m.style.width="2px",m.appendChild(h),b.reliableMarginRight=0===(parseInt((a.getComputedStyle(h,null)||{marginRight:0}).marginRight,10)||0)),"undefined"!=typeof m.style.zoom&&(m.innerHTML="",m.style.width=m.style.padding="1px",m.style.border=0,m.style.overflow="hidden",m.style.display="inline",m.style.zoom=1,b.inlineBlockNeedsLayout=3===m.offsetWidth,m.style.display="block",m.style.overflow="visible",m.innerHTML="<div style='width:5px;'></div>",b.shrinkWrapBlocks=3!==m.offsetWidth),m.style.cssText=o+p,m.innerHTML=n,d=m.firstChild,e=d.firstChild,f=d.nextSibling.firstChild.firstChild,g={doesNotAddBorder:5!==e.offsetTop,doesAddBorderForTableAndCells:5===f.offsetTop},e.style.position="fixed",e.style.top="20px",g.fixedPosition=20===e.offsetTop||15===e.offsetTop,e.style.position=e.style.top="",d.style.overflow="hidden",d.style.position="relative",g.subtractsBorderForOverflowNotVisible=-5===e.offsetTop,g.doesNotIncludeMarginInBodyOffset=r.offsetTop!==j,a.getComputedStyle&&(m.style.marginTop="1%",b.pixelMargin="1%"!==(a.getComputedStyle(m,null)||{marginTop:0}).marginTop),"undefined"!=typeof c.style.zoom&&(c.style.zoom=1),r.removeChild(c),h=m=c=null,J.extend(b,g))}),b}();var M=/^(?:\{.*\}|\[.*\])$/,N=/([A-Z])/g;J.extend({cache:{},uuid:0,expando:"jQuery"+(J.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:!0},hasData:function(a){return a=a.nodeType?J.cache[a[J.expando]]:a[J.expando],!!a&&!D(a)},data:function(a,c,d,e){if(J.acceptData(a)){var f,g,h,i=J.expando,j="string"==typeof c,k=a.nodeType,l=k?J.cache:a,m=k?a[i]:a[i]&&i,n="events"===c;if(!(m&&l[m]&&(n||e||l[m].data)||!j||d!==b))return;return m||(k?a[i]=m=++J.uuid:m=i),l[m]||(l[m]={},k||(l[m].toJSON=J.noop)),("object"==typeof c||"function"==typeof c)&&(e?l[m]=J.extend(l[m],c):l[m].data=J.extend(l[m].data,c)),f=g=l[m],e||(g.data||(g.data={}),g=g.data),d!==b&&(g[J.camelCase(c)]=d),n&&!g[c]?f.events:(j?(h=g[c],null==h&&(h=g[J.camelCase(c)])):h=g,h)}},removeData:function(a,b,c){if(J.acceptData(a)){var d,e,f,g=J.expando,h=a.nodeType,i=h?J.cache:a,j=h?a[g]:g;if(!i[j])return;if(b&&(d=c?i[j]:i[j].data)){J.isArray(b)||(b in d?b=[b]:(b=J.camelCase(b),b=b in d?[b]:b.split(" ")));for(e=0,f=b.length;f>e;e++)delete d[b[e]];if(!(c?D:J.isEmptyObject)(d))return}if(!c&&(delete i[j].data,!D(i[j])))return;J.support.deleteExpando||!i.setInterval?delete i[j]:i[j]=null,h&&(J.support.deleteExpando?delete a[g]:a.removeAttribute?a.removeAttribute(g):a[g]=null)}},_data:function(a,b,c){return J.data(a,b,c,!0)},acceptData:function(a){if(a.nodeName){var b=J.noData[a.nodeName.toLowerCase()];if(b)return b!==!0&&a.getAttribute("classid")===b}return!0}}),J.fn.extend({data:function(a,c){var d,e,f,g,h,i=this[0],j=0,k=null;if(a===b){if(this.length&&(k=J.data(i),1===i.nodeType&&!J._data(i,"parsedAttrs"))){for(f=i.attributes,h=f.length;h>j;j++)g=f[j].name,0===g.indexOf("data-")&&(g=J.camelCase(g.substring(5)),E(i,g,k[g]));J._data(i,"parsedAttrs",!0)}return k}return"object"==typeof a?this.each(function(){J.data(this,a)}):(d=a.split(".",2),d[1]=d[1]?"."+d[1]:"",e=d[1]+"!",J.access(this,function(c){return c===b?(k=this.triggerHandler("getData"+e,[d[0]]),k===b&&i&&(k=J.data(i,a),k=E(i,a,k)),k===b&&d[1]?this.data(d[0]):k):(d[1]=c,void this.each(function(){var b=J(this);b.triggerHandler("setData"+e,d),J.data(this,a,c),b.triggerHandler("changeData"+e,d)}))},null,c,arguments.length>1,null,!1))},removeData:function(a){return this.each(function(){J.removeData(this,a)})}}),J.extend({_mark:function(a,b){a&&(b=(b||"fx")+"mark",J._data(a,b,(J._data(a,b)||0)+1))},_unmark:function(a,b,c){if(a!==!0&&(c=b,b=a,a=!1),b){c=c||"fx";var d=c+"mark",e=a?0:(J._data(b,d)||1)-1;e?J._data(b,d,e):(J.removeData(b,d,!0),C(b,c,"mark"))}},queue:function(a,b,c){var d;return a?(b=(b||"fx")+"queue",d=J._data(a,b),c&&(!d||J.isArray(c)?d=J._data(a,b,J.makeArray(c)):d.push(c)),d||[]):void 0},dequeue:function(a,b){b=b||"fx";var c=J.queue(a,b),d=c.shift(),e={};"inprogress"===d&&(d=c.shift()),d&&("fx"===b&&c.unshift("inprogress"),J._data(a,b+".run",e),d.call(a,function(){J.dequeue(a,b)},e)),c.length||(J.removeData(a,b+"queue "+b+".run",!0),C(a,b,"queue"))}}),J.fn.extend({queue:function(a,c){var d=2;return"string"!=typeof a&&(c=a,a="fx",d--),arguments.length<d?J.queue(this[0],a):c===b?this:this.each(function(){var b=J.queue(this,a,c);"fx"===a&&"inprogress"!==b[0]&&J.dequeue(this,a)})},dequeue:function(a){return this.each(function(){J.dequeue(this,a)})},delay:function(a,b){return a=J.fx?J.fx.speeds[a]||a:a,b=b||"fx",this.queue(b,function(b,c){var d=setTimeout(b,a);c.stop=function(){clearTimeout(d)}})},clearQueue:function(a){return this.queue(a||"fx",[])},promise:function(a,c){function d(){--i||f.resolveWith(g,[g])}"string"!=typeof a&&(c=a,a=b),a=a||"fx";for(var e,f=J.Deferred(),g=this,h=g.length,i=1,j=a+"defer",k=a+"queue",l=a+"mark";h--;)(e=J.data(g[h],j,b,!0)||(J.data(g[h],k,b,!0)||J.data(g[h],l,b,!0))&&J.data(g[h],j,J.Callbacks("once memory"),!0))&&(i++,e.add(d));return d(),f.promise(c)}});var O,P,Q,R=/[\n\t\r]/g,S=/\s+/,T=/\r/g,U=/^(?:button|input)$/i,V=/^(?:button|input|object|select|textarea)$/i,W=/^a(?:rea)?$/i,X=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,Y=J.support.getSetAttribute;J.fn.extend({attr:function(a,b){return J.access(this,J.attr,a,b,arguments.length>1)},removeAttr:function(a){return this.each(function(){J.removeAttr(this,a)})},prop:function(a,b){return J.access(this,J.prop,a,b,arguments.length>1)},removeProp:function(a){return a=J.propFix[a]||a,this.each(function(){try{this[a]=b,delete this[a]}catch(c){}})},addClass:function(a){var b,c,d,e,f,g,h;if(J.isFunction(a))return this.each(function(b){J(this).addClass(a.call(this,b,this.className))});if(a&&"string"==typeof a)for(b=a.split(S),c=0,d=this.length;d>c;c++)if(e=this[c],1===e.nodeType)if(e.className||1!==b.length){for(f=" "+e.className+" ",g=0,h=b.length;h>g;g++)~f.indexOf(" "+b[g]+" ")||(f+=b[g]+" ");e.className=J.trim(f)}else e.className=a;return this},removeClass:function(a){var c,d,e,f,g,h,i;if(J.isFunction(a))return this.each(function(b){J(this).removeClass(a.call(this,b,this.className))});if(a&&"string"==typeof a||a===b)for(c=(a||"").split(S),d=0,e=this.length;e>d;d++)if(f=this[d],1===f.nodeType&&f.className)if(a){for(g=(" "+f.className+" ").replace(R," "),h=0,i=c.length;i>h;h++)g=g.replace(" "+c[h]+" "," ");f.className=J.trim(g)}else f.className="";return this},toggleClass:function(a,b){var c=typeof a,d="boolean"==typeof b;return J.isFunction(a)?this.each(function(c){J(this).toggleClass(a.call(this,c,this.className,b),b)}):this.each(function(){if("string"===c)for(var e,f=0,g=J(this),h=b,i=a.split(S);e=i[f++];)h=d?h:!g.hasClass(e),g[h?"addClass":"removeClass"](e);else("undefined"===c||"boolean"===c)&&(this.className&&J._data(this,"__className__",this.className),this.className=this.className||a===!1?"":J._data(this,"__className__")||"")})},hasClass:function(a){for(var b=" "+a+" ",c=0,d=this.length;d>c;c++)if(1===this[c].nodeType&&(" "+this[c].className+" ").replace(R," ").indexOf(b)>-1)return!0;return!1},val:function(a){var c,d,e,f=this[0];return arguments.length?(e=J.isFunction(a),this.each(function(d){var f,g=J(this);1===this.nodeType&&(f=e?a.call(this,d,g.val()):a,null==f?f="":"number"==typeof f?f+="":J.isArray(f)&&(f=J.map(f,function(a){return null==a?"":a+""})),c=J.valHooks[this.type]||J.valHooks[this.nodeName.toLowerCase()],c&&"set"in c&&c.set(this,f,"value")!==b||(this.value=f))})):f?(c=J.valHooks[f.type]||J.valHooks[f.nodeName.toLowerCase()],c&&"get"in c&&(d=c.get(f,"value"))!==b?d:(d=f.value,"string"==typeof d?d.replace(T,""):null==d?"":d)):void 0}}),J.extend({valHooks:{option:{get:function(a){var b=a.attributes.value;return!b||b.specified?a.value:a.text}},select:{get:function(a){var b,c,d,e,f=a.selectedIndex,g=[],h=a.options,i="select-one"===a.type;if(0>f)return null;for(c=i?f:0,d=i?f+1:h.length;d>c;c++)if(e=h[c],!(!e.selected||(J.support.optDisabled?e.disabled:null!==e.getAttribute("disabled"))||e.parentNode.disabled&&J.nodeName(e.parentNode,"optgroup"))){if(b=J(e).val(),i)return b;g.push(b)}return i&&!g.length&&h.length?J(h[f]).val():g},set:function(a,b){var c=J.makeArray(b);return J(a).find("option").each(function(){this.selected=J.inArray(J(this).val(),c)>=0}),c.length||(a.selectedIndex=-1),c}}},attrFn:{val:!0,css:!0,html:!0,text:!0,data:!0,width:!0,height:!0,offset:!0},attr:function(a,c,d,e){var f,g,h,i=a.nodeType;return a&&3!==i&&8!==i&&2!==i?e&&c in J.attrFn?J(a)[c](d):"undefined"==typeof a.getAttribute?J.prop(a,c,d):(h=1!==i||!J.isXMLDoc(a),h&&(c=c.toLowerCase(),g=J.attrHooks[c]||(X.test(c)?P:O)),d!==b?null===d?void J.removeAttr(a,c):g&&"set"in g&&h&&(f=g.set(a,d,c))!==b?f:(a.setAttribute(c,""+d),d):g&&"get"in g&&h&&null!==(f=g.get(a,c))?f:(f=a.getAttribute(c),null===f?b:f)):void 0},removeAttr:function(a,b){var c,d,e,f,g,h=0;if(b&&1===a.nodeType)for(d=b.toLowerCase().split(S),f=d.length;f>h;h++)e=d[h],e&&(c=J.propFix[e]||e,g=X.test(e),g||J.attr(a,e,""),a.removeAttribute(Y?e:c),g&&c in a&&(a[c]=!1))},attrHooks:{type:{set:function(a,b){if(U.test(a.nodeName)&&a.parentNode)J.error("type property can't be changed");else if(!J.support.radioValue&&"radio"===b&&J.nodeName(a,"input")){var c=a.value;return a.setAttribute("type",b),c&&(a.value=c),b}}},value:{get:function(a,b){return O&&J.nodeName(a,"button")?O.get(a,b):b in a?a.value:null},set:function(a,b,c){return O&&J.nodeName(a,"button")?O.set(a,b,c):void(a.value=b)}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(a,c,d){var e,f,g,h=a.nodeType;return a&&3!==h&&8!==h&&2!==h?(g=1!==h||!J.isXMLDoc(a),g&&(c=J.propFix[c]||c,f=J.propHooks[c]),d!==b?f&&"set"in f&&(e=f.set(a,d,c))!==b?e:a[c]=d:f&&"get"in f&&null!==(e=f.get(a,c))?e:a[c]):void 0},propHooks:{tabIndex:{get:function(a){var c=a.getAttributeNode("tabindex");return c&&c.specified?parseInt(c.value,10):V.test(a.nodeName)||W.test(a.nodeName)&&a.href?0:b}}}}),J.attrHooks.tabindex=J.propHooks.tabIndex,P={get:function(a,c){var d,e=J.prop(a,c);return e===!0||"boolean"!=typeof e&&(d=a.getAttributeNode(c))&&d.nodeValue!==!1?c.toLowerCase():b},set:function(a,b,c){var d;return b===!1?J.removeAttr(a,c):(d=J.propFix[c]||c,d in a&&(a[d]=!0),a.setAttribute(c,c.toLowerCase())),c}},Y||(Q={name:!0,id:!0,coords:!0},O=J.valHooks.button={get:function(a,c){var d;return d=a.getAttributeNode(c),d&&(Q[c]?""!==d.nodeValue:d.specified)?d.nodeValue:b},set:function(a,b,c){var d=a.getAttributeNode(c);return d||(d=G.createAttribute(c),a.setAttributeNode(d)),d.nodeValue=b+""}},J.attrHooks.tabindex.set=O.set,J.each(["width","height"],function(a,b){J.attrHooks[b]=J.extend(J.attrHooks[b],{set:function(a,c){return""===c?(a.setAttribute(b,"auto"),c):void 0}})}),J.attrHooks.contenteditable={get:O.get,set:function(a,b,c){""===b&&(b="false"),O.set(a,b,c)}}),J.support.hrefNormalized||J.each(["href","src","width","height"],function(a,c){J.attrHooks[c]=J.extend(J.attrHooks[c],{get:function(a){var d=a.getAttribute(c,2);return null===d?b:d}})}),J.support.style||(J.attrHooks.style={get:function(a){return a.style.cssText.toLowerCase()||b},set:function(a,b){return a.style.cssText=""+b}}),J.support.optSelected||(J.propHooks.selected=J.extend(J.propHooks.selected,{get:function(a){var b=a.parentNode;return b&&(b.selectedIndex,b.parentNode&&b.parentNode.selectedIndex),null}})),J.support.enctype||(J.propFix.enctype="encoding"),J.support.checkOn||J.each(["radio","checkbox"],function(){J.valHooks[this]={get:function(a){return null===a.getAttribute("value")?"on":a.value}}}),J.each(["radio","checkbox"],function(){J.valHooks[this]=J.extend(J.valHooks[this],{set:function(a,b){return J.isArray(b)?a.checked=J.inArray(J(a).val(),b)>=0:void 0}})});var Z=/^(?:textarea|input|select)$/i,$=/^([^\.]*)?(?:\.(.+))?$/,_=/(?:^|\s)hover(\.\S+)?\b/,aa=/^key/,ba=/^(?:mouse|contextmenu)|click/,ca=/^(?:focusinfocus|focusoutblur)$/,da=/^(\w*)(?:#([\w\-]+))?(?:\.([\w\-]+))?$/,ea=function(a){var b=da.exec(a);return b&&(b[1]=(b[1]||"").toLowerCase(),b[3]=b[3]&&new RegExp("(?:^|\\s)"+b[3]+"(?:\\s|$)")),b},fa=function(a,b){var c=a.attributes||{};return!(b[1]&&a.nodeName.toLowerCase()!==b[1]||b[2]&&(c.id||{}).value!==b[2]||b[3]&&!b[3].test((c["class"]||{}).value))},ga=function(a){return J.event.special.hover?a:a.replace(_,"mouseenter$1 mouseleave$1")};J.event={add:function(a,c,d,e,f){var g,h,i,j,k,l,m,n,o,p,q;if(3!==a.nodeType&&8!==a.nodeType&&c&&d&&(g=J._data(a))){for(d.handler&&(o=d,d=o.handler,f=o.selector),d.guid||(d.guid=J.guid++),i=g.events,i||(g.events=i={}),h=g.handle,h||(g.handle=h=function(a){return"undefined"==typeof J||a&&J.event.triggered===a.type?b:J.event.dispatch.apply(h.elem,arguments)},h.elem=a),c=J.trim(ga(c)).split(" "),j=0;j<c.length;j++)k=$.exec(c[j])||[],l=k[1],m=(k[2]||"").split(".").sort(),q=J.event.special[l]||{},l=(f?q.delegateType:q.bindType)||l,q=J.event.special[l]||{},n=J.extend({type:l,origType:k[1],data:e,handler:d,guid:d.guid,selector:f,quick:f&&ea(f),namespace:m.join(".")},o),p=i[l],p||(p=i[l]=[],p.delegateCount=0,q.setup&&q.setup.call(a,e,m,h)!==!1||(a.addEventListener?a.addEventListener(l,h,!1):a.attachEvent&&a.attachEvent("on"+l,h))),q.add&&(q.add.call(a,n),n.handler.guid||(n.handler.guid=d.guid)),f?p.splice(p.delegateCount++,0,n):p.push(n),J.event.global[l]=!0;a=null}},global:{},remove:function(a,b,c,d,e){var f,g,h,i,j,k,l,m,n,o,p,q,r=J.hasData(a)&&J._data(a);if(r&&(m=r.events)){for(b=J.trim(ga(b||"")).split(" "),f=0;f<b.length;f++)if(g=$.exec(b[f])||[],h=i=g[1],j=g[2],h){for(n=J.event.special[h]||{},h=(d?n.delegateType:n.bindType)||h,p=m[h]||[],k=p.length,j=j?new RegExp("(^|\\.)"+j.split(".").sort().join("\\.(?:.*\\.)?")+"(\\.|$)"):null,l=0;l<p.length;l++)q=p[l],!(!e&&i!==q.origType||c&&c.guid!==q.guid||j&&!j.test(q.namespace)||d&&d!==q.selector&&("**"!==d||!q.selector)||(p.splice(l--,1),q.selector&&p.delegateCount--,!n.remove||!n.remove.call(a,q)));0===p.length&&k!==p.length&&((!n.teardown||n.teardown.call(a,j)===!1)&&J.removeEvent(a,h,r.handle),delete m[h])}else for(h in m)J.event.remove(a,h+b[f],c,d,!0);J.isEmptyObject(m)&&(o=r.handle,o&&(o.elem=null),J.removeData(a,["events","handle"],!0))}},customEvent:{getData:!0,setData:!0,changeData:!0},trigger:function(c,d,e,f){if(!e||3!==e.nodeType&&8!==e.nodeType){var g,h,i,j,k,l,m,n,o,p,q=c.type||c,r=[];if(ca.test(q+J.event.triggered))return;if(q.indexOf("!")>=0&&(q=q.slice(0,-1),h=!0),q.indexOf(".")>=0&&(r=q.split("."),q=r.shift(),r.sort()),(!e||J.event.customEvent[q])&&!J.event.global[q])return;if(c="object"==typeof c?c[J.expando]?c:new J.Event(q,c):new J.Event(q),c.type=q,c.isTrigger=!0,c.exclusive=h,c.namespace=r.join("."),c.namespace_re=c.namespace?new RegExp("(^|\\.)"+r.join("\\.(?:.*\\.)?")+"(\\.|$)"):null,l=q.indexOf(":")<0?"on"+q:"",!e){g=J.cache;for(i in g)g[i].events&&g[i].events[q]&&J.event.trigger(c,d,g[i].handle.elem,!0);return}if(c.result=b,c.target||(c.target=e),d=null!=d?J.makeArray(d):[],d.unshift(c),m=J.event.special[q]||{},m.trigger&&m.trigger.apply(e,d)===!1)return;if(o=[[e,m.bindType||q]],!f&&!m.noBubble&&!J.isWindow(e)){for(p=m.delegateType||q,j=ca.test(p+q)?e:e.parentNode,k=null;j;j=j.parentNode)o.push([j,p]),k=j;k&&k===e.ownerDocument&&o.push([k.defaultView||k.parentWindow||a,p])}for(i=0;i<o.length&&!c.isPropagationStopped();i++)j=o[i][0],c.type=o[i][1],n=(J._data(j,"events")||{})[c.type]&&J._data(j,"handle"),n&&n.apply(j,d),n=l&&j[l],n&&J.acceptData(j)&&n.apply(j,d)===!1&&c.preventDefault();return c.type=q,!(f||c.isDefaultPrevented()||m._default&&m._default.apply(e.ownerDocument,d)!==!1||"click"===q&&J.nodeName(e,"a")||!J.acceptData(e)||!l||!e[q]||("focus"===q||"blur"===q)&&0===c.target.offsetWidth||J.isWindow(e)||(k=e[l],
k&&(e[l]=null),J.event.triggered=q,e[q](),J.event.triggered=b,!k||!(e[l]=k))),c.result}},dispatch:function(c){c=J.event.fix(c||a.event);var d,e,f,g,h,i,j,k,l,m,n=(J._data(this,"events")||{})[c.type]||[],o=n.delegateCount,p=[].slice.call(arguments,0),q=!c.exclusive&&!c.namespace,r=J.event.special[c.type]||{},s=[];if(p[0]=c,c.delegateTarget=this,!r.preDispatch||r.preDispatch.call(this,c)!==!1){if(o&&(!c.button||"click"!==c.type))for(g=J(this),g.context=this.ownerDocument||this,f=c.target;f!=this;f=f.parentNode||this)if(f.disabled!==!0){for(i={},k=[],g[0]=f,d=0;o>d;d++)l=n[d],m=l.selector,i[m]===b&&(i[m]=l.quick?fa(f,l.quick):g.is(m)),i[m]&&k.push(l);k.length&&s.push({elem:f,matches:k})}for(n.length>o&&s.push({elem:this,matches:n.slice(o)}),d=0;d<s.length&&!c.isPropagationStopped();d++)for(j=s[d],c.currentTarget=j.elem,e=0;e<j.matches.length&&!c.isImmediatePropagationStopped();e++)l=j.matches[e],(q||!c.namespace&&!l.namespace||c.namespace_re&&c.namespace_re.test(l.namespace))&&(c.data=l.data,c.handleObj=l,h=((J.event.special[l.origType]||{}).handle||l.handler).apply(j.elem,p),h!==b&&(c.result=h,h===!1&&(c.preventDefault(),c.stopPropagation())));return r.postDispatch&&r.postDispatch.call(this,c),c.result}},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(a,b){return null==a.which&&(a.which=null!=b.charCode?b.charCode:b.keyCode),a}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(a,c){var d,e,f,g=c.button,h=c.fromElement;return null==a.pageX&&null!=c.clientX&&(d=a.target.ownerDocument||G,e=d.documentElement,f=d.body,a.pageX=c.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&f.clientLeft||0),a.pageY=c.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)),!a.relatedTarget&&h&&(a.relatedTarget=h===a.target?c.toElement:h),!a.which&&g!==b&&(a.which=1&g?1:2&g?3:4&g?2:0),a}},fix:function(a){if(a[J.expando])return a;var c,d,e=a,f=J.event.fixHooks[a.type]||{},g=f.props?this.props.concat(f.props):this.props;for(a=J.Event(e),c=g.length;c;)d=g[--c],a[d]=e[d];return a.target||(a.target=e.srcElement||G),3===a.target.nodeType&&(a.target=a.target.parentNode),a.metaKey===b&&(a.metaKey=a.ctrlKey),f.filter?f.filter(a,e):a},special:{ready:{setup:J.bindReady},load:{noBubble:!0},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(a,b,c){J.isWindow(this)&&(this.onbeforeunload=c)},teardown:function(a,b){this.onbeforeunload===b&&(this.onbeforeunload=null)}}},simulate:function(a,b,c,d){var e=J.extend(new J.Event,c,{type:a,isSimulated:!0,originalEvent:{}});d?J.event.trigger(e,null,b):J.event.dispatch.call(b,e),e.isDefaultPrevented()&&c.preventDefault()}},J.event.handle=J.event.dispatch,J.removeEvent=G.removeEventListener?function(a,b,c){a.removeEventListener&&a.removeEventListener(b,c,!1)}:function(a,b,c){a.detachEvent&&a.detachEvent("on"+b,c)},J.Event=function(a,b){return this instanceof J.Event?(a&&a.type?(this.originalEvent=a,this.type=a.type,this.isDefaultPrevented=a.defaultPrevented||a.returnValue===!1||a.getPreventDefault&&a.getPreventDefault()?A:B):this.type=a,b&&J.extend(this,b),this.timeStamp=a&&a.timeStamp||J.now(),this[J.expando]=!0,void 0):new J.Event(a,b)},J.Event.prototype={preventDefault:function(){this.isDefaultPrevented=A;var a=this.originalEvent;!a||(a.preventDefault?a.preventDefault():a.returnValue=!1)},stopPropagation:function(){this.isPropagationStopped=A;var a=this.originalEvent;!a||(a.stopPropagation&&a.stopPropagation(),a.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=A,this.stopPropagation()},isDefaultPrevented:B,isPropagationStopped:B,isImmediatePropagationStopped:B},J.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(a,b){J.event.special[a]={delegateType:b,bindType:b,handle:function(a){var c,d=this,e=a.relatedTarget,f=a.handleObj;f.selector;return(!e||e!==d&&!J.contains(d,e))&&(a.type=f.origType,c=f.handler.apply(this,arguments),a.type=b),c}}}),J.support.submitBubbles||(J.event.special.submit={setup:function(){return J.nodeName(this,"form")?!1:void J.event.add(this,"click._submit keypress._submit",function(a){var c=a.target,d=J.nodeName(c,"input")||J.nodeName(c,"button")?c.form:b;d&&!d._submit_attached&&(J.event.add(d,"submit._submit",function(a){a._submit_bubble=!0}),d._submit_attached=!0)})},postDispatch:function(a){a._submit_bubble&&(delete a._submit_bubble,this.parentNode&&!a.isTrigger&&J.event.simulate("submit",this.parentNode,a,!0))},teardown:function(){return J.nodeName(this,"form")?!1:void J.event.remove(this,"._submit")}}),J.support.changeBubbles||(J.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(J.event.add(this,"propertychange._change",function(a){"checked"===a.originalEvent.propertyName&&(this._just_changed=!0)}),J.event.add(this,"click._change",function(a){this._just_changed&&!a.isTrigger&&(this._just_changed=!1,J.event.simulate("change",this,a,!0))})),!1):void J.event.add(this,"beforeactivate._change",function(a){var b=a.target;Z.test(b.nodeName)&&!b._change_attached&&(J.event.add(b,"change._change",function(a){this.parentNode&&!a.isSimulated&&!a.isTrigger&&J.event.simulate("change",this.parentNode,a,!0)}),b._change_attached=!0)})},handle:function(a){var b=a.target;return this!==b||a.isSimulated||a.isTrigger||"radio"!==b.type&&"checkbox"!==b.type?a.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return J.event.remove(this,"._change"),Z.test(this.nodeName)}}),J.support.focusinBubbles||J.each({focus:"focusin",blur:"focusout"},function(a,b){var c=0,d=function(a){J.event.simulate(b,a.target,J.event.fix(a),!0)};J.event.special[b]={setup:function(){0===c++&&G.addEventListener(a,d,!0)},teardown:function(){0===--c&&G.removeEventListener(a,d,!0)}}}),J.fn.extend({on:function(a,c,d,e,f){var g,h;if("object"==typeof a){"string"!=typeof c&&(d=d||c,c=b);for(h in a)this.on(h,c,d,a[h],f);return this}if(null==d&&null==e?(e=c,d=c=b):null==e&&("string"==typeof c?(e=d,d=b):(e=d,d=c,c=b)),e===!1)e=B;else if(!e)return this;return 1===f&&(g=e,e=function(a){return J().off(a),g.apply(this,arguments)},e.guid=g.guid||(g.guid=J.guid++)),this.each(function(){J.event.add(this,a,e,d,c)})},one:function(a,b,c,d){return this.on(a,b,c,d,1)},off:function(a,c,d){if(a&&a.preventDefault&&a.handleObj){var e=a.handleObj;return J(a.delegateTarget).off(e.namespace?e.origType+"."+e.namespace:e.origType,e.selector,e.handler),this}if("object"==typeof a){for(var f in a)this.off(f,c,a[f]);return this}return(c===!1||"function"==typeof c)&&(d=c,c=b),d===!1&&(d=B),this.each(function(){J.event.remove(this,a,d,c)})},bind:function(a,b,c){return this.on(a,null,b,c)},unbind:function(a,b){return this.off(a,null,b)},live:function(a,b,c){return J(this.context).on(a,this.selector,b,c),this},die:function(a,b){return J(this.context).off(a,this.selector||"**",b),this},delegate:function(a,b,c,d){return this.on(b,a,c,d)},undelegate:function(a,b,c){return 1==arguments.length?this.off(a,"**"):this.off(b,a,c)},trigger:function(a,b){return this.each(function(){J.event.trigger(a,b,this)})},triggerHandler:function(a,b){return this[0]?J.event.trigger(a,b,this[0],!0):void 0},toggle:function(a){var b=arguments,c=a.guid||J.guid++,d=0,e=function(c){var e=(J._data(this,"lastToggle"+a.guid)||0)%d;return J._data(this,"lastToggle"+a.guid,e+1),c.preventDefault(),b[e].apply(this,arguments)||!1};for(e.guid=c;d<b.length;)b[d++].guid=c;return this.click(e)},hover:function(a,b){return this.mouseenter(a).mouseleave(b||a)}}),J.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(a,b){J.fn[b]=function(a,c){return null==c&&(c=a,a=null),arguments.length>0?this.on(b,null,a,c):this.trigger(b)},J.attrFn&&(J.attrFn[b]=!0),aa.test(b)&&(J.event.fixHooks[b]=J.event.keyHooks),ba.test(b)&&(J.event.fixHooks[b]=J.event.mouseHooks)}),function(){function a(a,b,c,d,f,g){for(var h=0,i=d.length;i>h;h++){var j=d[h];if(j){var k=!1;for(j=j[a];j;){if(j[e]===c){k=d[j.sizset];break}if(1===j.nodeType)if(g||(j[e]=c,j.sizset=h),"string"!=typeof b){if(j===b){k=!0;break}}else if(m.filter(b,[j]).length>0){k=j;break}j=j[a]}d[h]=k}}}function c(a,b,c,d,f,g){for(var h=0,i=d.length;i>h;h++){var j=d[h];if(j){var k=!1;for(j=j[a];j;){if(j[e]===c){k=d[j.sizset];break}if(1===j.nodeType&&!g&&(j[e]=c,j.sizset=h),j.nodeName.toLowerCase()===b){k=j;break}j=j[a]}d[h]=k}}}var d=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,e="sizcache"+(Math.random()+"").replace(".",""),f=0,g=Object.prototype.toString,h=!1,i=!0,j=/\\/g,k=/\r\n/g,l=/\W/;[0,0].sort(function(){return i=!1,0});var m=function(a,b,c,e){c=c||[],b=b||G;var f=b;if(1!==b.nodeType&&9!==b.nodeType)return[];if(!a||"string"!=typeof a)return c;var h,i,j,k,l,n,q,r,t=!0,u=m.isXML(b),v=[],x=a;do if(d.exec(""),h=d.exec(x),h&&(x=h[3],v.push(h[1]),h[2])){k=h[3];break}while(h);if(v.length>1&&p.exec(a))if(2===v.length&&o.relative[v[0]])i=w(v[0]+v[1],b,e);else for(i=o.relative[v[0]]?[b]:m(v.shift(),b);v.length;)a=v.shift(),o.relative[a]&&(a+=v.shift()),i=w(a,i,e);else if(!e&&v.length>1&&9===b.nodeType&&!u&&o.match.ID.test(v[0])&&!o.match.ID.test(v[v.length-1])&&(l=m.find(v.shift(),b,u),b=l.expr?m.filter(l.expr,l.set)[0]:l.set[0]),b)for(l=e?{expr:v.pop(),set:s(e)}:m.find(v.pop(),1!==v.length||"~"!==v[0]&&"+"!==v[0]||!b.parentNode?b:b.parentNode,u),i=l.expr?m.filter(l.expr,l.set):l.set,v.length>0?j=s(i):t=!1;v.length;)n=v.pop(),q=n,o.relative[n]?q=v.pop():n="",null==q&&(q=b),o.relative[n](j,q,u);else j=v=[];if(j||(j=i),j||m.error(n||a),"[object Array]"===g.call(j))if(t)if(b&&1===b.nodeType)for(r=0;null!=j[r];r++)j[r]&&(j[r]===!0||1===j[r].nodeType&&m.contains(b,j[r]))&&c.push(i[r]);else for(r=0;null!=j[r];r++)j[r]&&1===j[r].nodeType&&c.push(i[r]);else c.push.apply(c,j);else s(j,c);return k&&(m(k,f,c,e),m.uniqueSort(c)),c};m.uniqueSort=function(a){if(u&&(h=i,a.sort(u),h))for(var b=1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a},m.matches=function(a,b){return m(a,null,null,b)},m.matchesSelector=function(a,b){return m(b,null,null,[a]).length>0},m.find=function(a,b,c){var d,e,f,g,h,i;if(!a)return[];for(e=0,f=o.order.length;f>e;e++)if(h=o.order[e],(g=o.leftMatch[h].exec(a))&&(i=g[1],g.splice(1,1),"\\"!==i.substr(i.length-1)&&(g[1]=(g[1]||"").replace(j,""),d=o.find[h](g,b,c),null!=d))){a=a.replace(o.match[h],"");break}return d||(d="undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName("*"):[]),{set:d,expr:a}},m.filter=function(a,c,d,e){for(var f,g,h,i,j,k,l,n,p,q=a,r=[],s=c,t=c&&c[0]&&m.isXML(c[0]);a&&c.length;){for(h in o.filter)if(null!=(f=o.leftMatch[h].exec(a))&&f[2]){if(k=o.filter[h],l=f[1],g=!1,f.splice(1,1),"\\"===l.substr(l.length-1))continue;if(s===r&&(r=[]),o.preFilter[h])if(f=o.preFilter[h](f,s,d,r,e,t)){if(f===!0)continue}else g=i=!0;if(f)for(n=0;null!=(j=s[n]);n++)j&&(i=k(j,f,n,s),p=e^i,d&&null!=i?p?g=!0:s[n]=!1:p&&(r.push(j),g=!0));if(i!==b){if(d||(s=r),a=a.replace(o.match[h],""),!g)return[];break}}if(a===q){if(null!=g)break;m.error(a)}q=a}return s},m.error=function(a){throw new Error("Syntax error, unrecognized expression: "+a)};var n=m.getText=function(a){var b,c,d=a.nodeType,e="";if(d){if(1===d||9===d||11===d){if("string"==typeof a.textContent)return a.textContent;if("string"==typeof a.innerText)return a.innerText.replace(k,"");for(a=a.firstChild;a;a=a.nextSibling)e+=n(a)}else if(3===d||4===d)return a.nodeValue}else for(b=0;c=a[b];b++)8!==c.nodeType&&(e+=n(c));return e},o=m.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(?:(['"])(.*?)\3|(#?(?:[\w\u00c0-\uFFFF\-]|\\.)*)|)|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\(\s*(even|odd|(?:[+\-]?\d+|(?:[+\-]?\d*)?n\s*(?:[+\-]\s*\d+)?))\s*\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")},type:function(a){return a.getAttribute("type")}},relative:{"+":function(a,b){var c="string"==typeof b,d=c&&!l.test(b),e=c&&!d;d&&(b=b.toLowerCase());for(var f,g=0,h=a.length;h>g;g++)if(f=a[g]){for(;(f=f.previousSibling)&&1!==f.nodeType;);a[g]=e||f&&f.nodeName.toLowerCase()===b?f||!1:f===b}e&&m.filter(b,a,!0)},">":function(a,b){var c,d="string"==typeof b,e=0,f=a.length;if(d&&!l.test(b)){for(b=b.toLowerCase();f>e;e++)if(c=a[e]){var g=c.parentNode;a[e]=g.nodeName.toLowerCase()===b?g:!1}}else{for(;f>e;e++)c=a[e],c&&(a[e]=d?c.parentNode:c.parentNode===b);d&&m.filter(b,a,!0)}},"":function(b,d,e){var g,h=f++,i=a;"string"==typeof d&&!l.test(d)&&(d=d.toLowerCase(),g=d,i=c),i("parentNode",d,h,b,g,e)},"~":function(b,d,e){var g,h=f++,i=a;"string"==typeof d&&!l.test(d)&&(d=d.toLowerCase(),g=d,i=c),i("previousSibling",d,h,b,g,e)}},find:{ID:function(a,b,c){if("undefined"!=typeof b.getElementById&&!c){var d=b.getElementById(a[1]);return d&&d.parentNode?[d]:[]}},NAME:function(a,b){if("undefined"!=typeof b.getElementsByName){for(var c=[],d=b.getElementsByName(a[1]),e=0,f=d.length;f>e;e++)d[e].getAttribute("name")===a[1]&&c.push(d[e]);return 0===c.length?null:c}},TAG:function(a,b){return"undefined"!=typeof b.getElementsByTagName?b.getElementsByTagName(a[1]):void 0}},preFilter:{CLASS:function(a,b,c,d,e,f){if(a=" "+a[1].replace(j,"")+" ",f)return a;for(var g,h=0;null!=(g=b[h]);h++)g&&(e^(g.className&&(" "+g.className+" ").replace(/[\t\n\r]/g," ").indexOf(a)>=0)?c||d.push(g):c&&(b[h]=!1));return!1},ID:function(a){return a[1].replace(j,"")},TAG:function(a,b){return a[1].replace(j,"").toLowerCase()},CHILD:function(a){if("nth"===a[1]){a[2]||m.error(a[0]),a[2]=a[2].replace(/^\+|\s*/g,"");var b=/(-?)(\d*)(?:n([+\-]?\d*))?/.exec("even"===a[2]&&"2n"||"odd"===a[2]&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0,a[3]=b[3]-0}else a[2]&&m.error(a[0]);return a[0]=f++,a},ATTR:function(a,b,c,d,e,f){var g=a[1]=a[1].replace(j,"");return!f&&o.attrMap[g]&&(a[1]=o.attrMap[g]),a[4]=(a[4]||a[5]||"").replace(j,""),"~="===a[2]&&(a[4]=" "+a[4]+" "),a},PSEUDO:function(a,b,c,e,f){if("not"===a[1]){if(!((d.exec(a[3])||"").length>1||/^\w/.test(a[3]))){var g=m.filter(a[3],b,c,!0^f);return c||e.push.apply(e,g),!1}a[3]=m(a[3],null,null,b)}else if(o.match.POS.test(a[0])||o.match.CHILD.test(a[0]))return!0;return a},POS:function(a){return a.unshift(!0),a}},filters:{enabled:function(a){return a.disabled===!1&&"hidden"!==a.type},disabled:function(a){return a.disabled===!0},checked:function(a){return a.checked===!0},selected:function(a){return a.parentNode&&a.parentNode.selectedIndex,a.selected===!0},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!m(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){var b=a.getAttribute("type"),c=a.type;return"input"===a.nodeName.toLowerCase()&&"text"===c&&(b===c||null===b)},radio:function(a){return"input"===a.nodeName.toLowerCase()&&"radio"===a.type},checkbox:function(a){return"input"===a.nodeName.toLowerCase()&&"checkbox"===a.type},file:function(a){return"input"===a.nodeName.toLowerCase()&&"file"===a.type},password:function(a){return"input"===a.nodeName.toLowerCase()&&"password"===a.type},submit:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"submit"===a.type},image:function(a){return"input"===a.nodeName.toLowerCase()&&"image"===a.type},reset:function(a){var b=a.nodeName.toLowerCase();return("input"===b||"button"===b)&&"reset"===a.type},button:function(a){var b=a.nodeName.toLowerCase();return"input"===b&&"button"===a.type||"button"===b},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)},focus:function(a){return a===a.ownerDocument.activeElement}},setFilters:{first:function(a,b){return 0===b},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return b%2===0},odd:function(a,b){return b%2===1},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,b,c,d){var e=b[1],f=o.filters[e];if(f)return f(a,c,b,d);if("contains"===e)return(a.textContent||a.innerText||n([a])||"").indexOf(b[3])>=0;if("not"===e){for(var g=b[3],h=0,i=g.length;i>h;h++)if(g[h]===a)return!1;return!0}m.error(e)},CHILD:function(a,b){var c,d,f,g,h,i,j=b[1],k=a;switch(j){case"only":case"first":for(;k=k.previousSibling;)if(1===k.nodeType)return!1;if("first"===j)return!0;k=a;case"last":for(;k=k.nextSibling;)if(1===k.nodeType)return!1;return!0;case"nth":if(c=b[2],d=b[3],1===c&&0===d)return!0;if(f=b[0],g=a.parentNode,g&&(g[e]!==f||!a.nodeIndex)){for(h=0,k=g.firstChild;k;k=k.nextSibling)1===k.nodeType&&(k.nodeIndex=++h);g[e]=f}return i=a.nodeIndex-d,0===c?0===i:i%c===0&&i/c>=0}},ID:function(a,b){return 1===a.nodeType&&a.getAttribute("id")===b},TAG:function(a,b){return"*"===b&&1===a.nodeType||!!a.nodeName&&a.nodeName.toLowerCase()===b},CLASS:function(a,b){return(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)>-1},ATTR:function(a,b){var c=b[1],d=m.attr?m.attr(a,c):o.attrHandle[c]?o.attrHandle[c](a):null!=a[c]?a[c]:a.getAttribute(c),e=d+"",f=b[2],g=b[4];return null==d?"!="===f:!f&&m.attr?null!=d:"="===f?e===g:"*="===f?e.indexOf(g)>=0:"~="===f?(" "+e+" ").indexOf(g)>=0:g?"!="===f?e!==g:"^="===f?0===e.indexOf(g):"$="===f?e.substr(e.length-g.length)===g:"|="===f?e===g||e.substr(0,g.length+1)===g+"-":!1:e&&d!==!1},POS:function(a,b,c,d){var e=b[2],f=o.setFilters[e];return f?f(a,c,b,d):void 0}}},p=o.match.POS,q=function(a,b){return"\\"+(b-0+1)};for(var r in o.match)o.match[r]=new RegExp(o.match[r].source+/(?![^\[]*\])(?![^\(]*\))/.source),o.leftMatch[r]=new RegExp(/(^(?:.|\r|\n)*?)/.source+o.match[r].source.replace(/\\(\d+)/g,q));o.match.globalPOS=p;var s=function(a,b){return a=Array.prototype.slice.call(a,0),b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(G.documentElement.childNodes,0)[0].nodeType}catch(t){s=function(a,b){var c=0,d=b||[];if("[object Array]"===g.call(a))Array.prototype.push.apply(d,a);else if("number"==typeof a.length)for(var e=a.length;e>c;c++)d.push(a[c]);else for(;a[c];c++)d.push(a[c]);return d}}var u,v;G.documentElement.compareDocumentPosition?u=function(a,b){return a===b?(h=!0,0):a.compareDocumentPosition&&b.compareDocumentPosition?4&a.compareDocumentPosition(b)?-1:1:a.compareDocumentPosition?-1:1}:(u=function(a,b){if(a===b)return h=!0,0;if(a.sourceIndex&&b.sourceIndex)return a.sourceIndex-b.sourceIndex;var c,d,e=[],f=[],g=a.parentNode,i=b.parentNode,j=g;if(g===i)return v(a,b);if(!g)return-1;if(!i)return 1;for(;j;)e.unshift(j),j=j.parentNode;for(j=i;j;)f.unshift(j),j=j.parentNode;c=e.length,d=f.length;for(var k=0;c>k&&d>k;k++)if(e[k]!==f[k])return v(e[k],f[k]);return k===c?v(a,f[k],-1):v(e[k],b,1)},v=function(a,b,c){if(a===b)return c;for(var d=a.nextSibling;d;){if(d===b)return-1;d=d.nextSibling}return 1}),function(){var a=G.createElement("div"),c="script"+(new Date).getTime(),d=G.documentElement;a.innerHTML="<a name='"+c+"'/>",d.insertBefore(a,d.firstChild),G.getElementById(c)&&(o.find.ID=function(a,c,d){if("undefined"!=typeof c.getElementById&&!d){var e=c.getElementById(a[1]);return e?e.id===a[1]||"undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id").nodeValue===a[1]?[e]:b:[]}},o.filter.ID=function(a,b){var c="undefined"!=typeof a.getAttributeNode&&a.getAttributeNode("id");return 1===a.nodeType&&c&&c.nodeValue===b}),d.removeChild(a),d=a=null}(),function(){var a=G.createElement("div");a.appendChild(G.createComment("")),a.getElementsByTagName("*").length>0&&(o.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if("*"===a[1]){for(var d=[],e=0;c[e];e++)1===c[e].nodeType&&d.push(c[e]);c=d}return c}),a.innerHTML="<a href='#'></a>",a.firstChild&&"undefined"!=typeof a.firstChild.getAttribute&&"#"!==a.firstChild.getAttribute("href")&&(o.attrHandle.href=function(a){return a.getAttribute("href",2)}),a=null}(),G.querySelectorAll&&function(){var a=m,b=G.createElement("div"),c="__sizzle__";if(b.innerHTML="<p class='TEST'></p>",!b.querySelectorAll||0!==b.querySelectorAll(".TEST").length){m=function(b,d,e,f){if(d=d||G,!f&&!m.isXML(d)){var g=/^(\w+$)|^\.([\w\-]+$)|^#([\w\-]+$)/.exec(b);if(g&&(1===d.nodeType||9===d.nodeType)){if(g[1])return s(d.getElementsByTagName(b),e);if(g[2]&&o.find.CLASS&&d.getElementsByClassName)return s(d.getElementsByClassName(g[2]),e)}if(9===d.nodeType){if("body"===b&&d.body)return s([d.body],e);if(g&&g[3]){var h=d.getElementById(g[3]);if(!h||!h.parentNode)return s([],e);if(h.id===g[3])return s([h],e)}try{return s(d.querySelectorAll(b),e)}catch(i){}}else if(1===d.nodeType&&"object"!==d.nodeName.toLowerCase()){var j=d,k=d.getAttribute("id"),l=k||c,n=d.parentNode,p=/^\s*[+~]/.test(b);k?l=l.replace(/'/g,"\\$&"):d.setAttribute("id",l),p&&n&&(d=d.parentNode);try{if(!p||n)return s(d.querySelectorAll("[id='"+l+"'] "+b),e)}catch(q){}finally{k||j.removeAttribute("id")}}}return a(b,d,e,f)};for(var d in a)m[d]=a[d];b=null}}(),function(){var a=G.documentElement,b=a.matchesSelector||a.mozMatchesSelector||a.webkitMatchesSelector||a.msMatchesSelector;if(b){var c=!b.call(G.createElement("div"),"div"),d=!1;try{b.call(G.documentElement,"[Tests!='']:sizzle")}catch(e){d=!0}m.matchesSelector=function(a,e){if(e=e.replace(/\=\s*([^'"\]]*)\s*\]/g,"='$1']"),!m.isXML(a))try{if(d||!o.match.PSEUDO.test(e)&&!/!=/.test(e)){var f=b.call(a,e);if(f||!c||a.document&&11!==a.document.nodeType)return f}}catch(g){}return m(e,null,null,[a]).length>0}}}(),function(){var a=G.createElement("div");if(a.innerHTML="<div class='Tests e'></div><div class='Tests'></div>",a.getElementsByClassName&&0!==a.getElementsByClassName("e").length){if(a.lastChild.className="e",1===a.getElementsByClassName("e").length)return;o.order.splice(1,0,"CLASS"),o.find.CLASS=function(a,b,c){return"undefined"==typeof b.getElementsByClassName||c?void 0:b.getElementsByClassName(a[1])},a=null}}(),G.documentElement.contains?m.contains=function(a,b){return a!==b&&(a.contains?a.contains(b):!0)}:G.documentElement.compareDocumentPosition?m.contains=function(a,b){return!!(16&a.compareDocumentPosition(b))}:m.contains=function(){return!1},m.isXML=function(a){var b=(a?a.ownerDocument||a:0).documentElement;return b?"HTML"!==b.nodeName:!1};var w=function(a,b,c){for(var d,e=[],f="",g=b.nodeType?[b]:b;d=o.match.PSEUDO.exec(a);)f+=d[0],a=a.replace(o.match.PSEUDO,"");a=o.relative[a]?a+"*":a;for(var h=0,i=g.length;i>h;h++)m(a,g[h],e,c);return m.filter(f,e)};m.attr=J.attr,m.selectors.attrMap={},J.find=m,J.expr=m.selectors,J.expr[":"]=J.expr.filters,J.unique=m.uniqueSort,J.text=m.getText,J.isXMLDoc=m.isXML,J.contains=m.contains}();var ha=/Until$/,ia=/^(?:parents|prevUntil|prevAll)/,ja=/,/,ka=/^.[^:#\[\.,]*$/,la=Array.prototype.slice,ma=J.expr.match.globalPOS,na={children:!0,contents:!0,next:!0,prev:!0};J.fn.extend({find:function(a){var b,c,d=this;if("string"!=typeof a)return J(a).filter(function(){for(b=0,c=d.length;c>b;b++)if(J.contains(d[b],this))return!0});var e,f,g,h=this.pushStack("","find",a);for(b=0,c=this.length;c>b;b++)if(e=h.length,J.find(a,this[b],h),b>0)for(f=e;f<h.length;f++)for(g=0;e>g;g++)if(h[g]===h[f]){h.splice(f--,1);break}return h},has:function(a){var b=J(a);return this.filter(function(){for(var a=0,c=b.length;c>a;a++)if(J.contains(this,b[a]))return!0})},not:function(a){return this.pushStack(y(this,a,!1),"not",a)},filter:function(a){return this.pushStack(y(this,a,!0),"filter",a)},is:function(a){return!!a&&("string"==typeof a?ma.test(a)?J(a,this.context).index(this[0])>=0:J.filter(a,this).length>0:this.filter(a).length>0)},closest:function(a,b){var c,d,e=[],f=this[0];if(J.isArray(a)){for(var g=1;f&&f.ownerDocument&&f!==b;){for(c=0;c<a.length;c++)J(f).is(a[c])&&e.push({selector:a[c],elem:f,level:g});f=f.parentNode,g++}return e}var h=ma.test(a)||"string"!=typeof a?J(a,b||this.context):0;for(c=0,d=this.length;d>c;c++)for(f=this[c];f;){if(h?h.index(f)>-1:J.find.matchesSelector(f,a)){e.push(f);break}if(f=f.parentNode,!f||!f.ownerDocument||f===b||11===f.nodeType)break}return e=e.length>1?J.unique(e):e,this.pushStack(e,"closest",a)},index:function(a){return a?"string"==typeof a?J.inArray(this[0],J(a)):J.inArray(a.jquery?a[0]:a,this):this[0]&&this[0].parentNode?this.prevAll().length:-1},add:function(a,b){var c="string"==typeof a?J(a,b):J.makeArray(a&&a.nodeType?[a]:a),d=J.merge(this.get(),c);return this.pushStack(z(c[0])||z(d[0])?d:J.unique(d))},andSelf:function(){return this.add(this.prevObject)}}),J.each({parent:function(a){var b=a.parentNode;return b&&11!==b.nodeType?b:null},parents:function(a){return J.dir(a,"parentNode")},parentsUntil:function(a,b,c){return J.dir(a,"parentNode",c)},next:function(a){return J.nth(a,2,"nextSibling")},prev:function(a){return J.nth(a,2,"previousSibling")},nextAll:function(a){return J.dir(a,"nextSibling")},prevAll:function(a){return J.dir(a,"previousSibling")},nextUntil:function(a,b,c){return J.dir(a,"nextSibling",c)},prevUntil:function(a,b,c){return J.dir(a,"previousSibling",c)},siblings:function(a){return J.sibling((a.parentNode||{}).firstChild,a)},children:function(a){return J.sibling(a.firstChild)},contents:function(a){return J.nodeName(a,"iframe")?a.contentDocument||a.contentWindow.document:J.makeArray(a.childNodes)}},function(a,b){J.fn[a]=function(c,d){var e=J.map(this,b,c);return ha.test(a)||(d=c),d&&"string"==typeof d&&(e=J.filter(d,e)),e=this.length>1&&!na[a]?J.unique(e):e,(this.length>1||ja.test(d))&&ia.test(a)&&(e=e.reverse()),this.pushStack(e,a,la.call(arguments).join(","))}}),J.extend({filter:function(a,b,c){return c&&(a=":not("+a+")"),1===b.length?J.find.matchesSelector(b[0],a)?[b[0]]:[]:J.find.matches(a,b)},dir:function(a,c,d){for(var e=[],f=a[c];f&&9!==f.nodeType&&(d===b||1!==f.nodeType||!J(f).is(d));)1===f.nodeType&&e.push(f),f=f[c];return e},nth:function(a,b,c,d){b=b||1;for(var e=0;a&&(1!==a.nodeType||++e!==b);a=a[c]);return a},sibling:function(a,b){for(var c=[];a;a=a.nextSibling)1===a.nodeType&&a!==b&&c.push(a);return c}});var oa="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",pa=/ jQuery\d+="(?:\d+|null)"/g,qa=/^\s+/,ra=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,sa=/<([\w:]+)/,ta=/<tbody/i,ua=/<|&#?\w+;/,va=/<(?:script|style)/i,wa=/<(?:script|object|embed|option|style)/i,xa=new RegExp("<(?:"+oa+")[\\s/>]","i"),ya=/checked\s*(?:[^=]|=\s*.checked.)/i,za=/\/(java|ecma)script/i,Aa=/^\s*<!(?:\[CDATA\[|\-\-)/,Ba={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},Ca=x(G);Ba.optgroup=Ba.option,Ba.tbody=Ba.tfoot=Ba.colgroup=Ba.caption=Ba.thead,Ba.th=Ba.td,J.support.htmlSerialize||(Ba._default=[1,"div<div>","</div>"]),J.fn.extend({text:function(a){return J.access(this,function(a){return a===b?J.text(this):this.empty().append((this[0]&&this[0].ownerDocument||G).createTextNode(a))},null,a,arguments.length)},wrapAll:function(a){if(J.isFunction(a))return this.each(function(b){J(this).wrapAll(a.call(this,b))});if(this[0]){var b=J(a,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&b.insertBefore(this[0]),b.map(function(){for(var a=this;a.firstChild&&1===a.firstChild.nodeType;)a=a.firstChild;return a}).append(this)}return this},wrapInner:function(a){return J.isFunction(a)?this.each(function(b){J(this).wrapInner(a.call(this,b))}):this.each(function(){var b=J(this),c=b.contents();c.length?c.wrapAll(a):b.append(a)})},wrap:function(a){var b=J.isFunction(a);return this.each(function(c){J(this).wrapAll(b?a.call(this,c):a)})},unwrap:function(){return this.parent().each(function(){J.nodeName(this,"body")||J(this).replaceWith(this.childNodes)}).end()},append:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.appendChild(a)})},prepend:function(){return this.domManip(arguments,!0,function(a){1===this.nodeType&&this.insertBefore(a,this.firstChild)})},before:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this)});if(arguments.length){var a=J.clean(arguments);return a.push.apply(a,this.toArray()),this.pushStack(a,"before",arguments)}},after:function(){if(this[0]&&this[0].parentNode)return this.domManip(arguments,!1,function(a){this.parentNode.insertBefore(a,this.nextSibling)});if(arguments.length){var a=this.pushStack(this,"after",arguments);return a.push.apply(a,J.clean(arguments)),a}},remove:function(a,b){for(var c,d=0;null!=(c=this[d]);d++)(!a||J.filter(a,[c]).length)&&(!b&&1===c.nodeType&&(J.cleanData(c.getElementsByTagName("*")),J.cleanData([c])),c.parentNode&&c.parentNode.removeChild(c));return this},empty:function(){for(var a,b=0;null!=(a=this[b]);b++)for(1===a.nodeType&&J.cleanData(a.getElementsByTagName("*"));a.firstChild;)a.removeChild(a.firstChild);return this},clone:function(a,b){return a=null==a?!1:a,b=null==b?a:b,this.map(function(){return J.clone(this,a,b)})},html:function(a){return J.access(this,function(a){var c=this[0]||{},d=0,e=this.length;if(a===b)return 1===c.nodeType?c.innerHTML.replace(pa,""):null;if(!("string"!=typeof a||va.test(a)||!J.support.leadingWhitespace&&qa.test(a)||Ba[(sa.exec(a)||["",""])[1].toLowerCase()])){a=a.replace(ra,"<$1></$2>");try{for(;e>d;d++)c=this[d]||{},1===c.nodeType&&(J.cleanData(c.getElementsByTagName("*")),c.innerHTML=a);c=0}catch(f){}}c&&this.empty().append(a)},null,a,arguments.length)},replaceWith:function(a){return this[0]&&this[0].parentNode?J.isFunction(a)?this.each(function(b){var c=J(this),d=c.html();c.replaceWith(a.call(this,b,d))}):("string"!=typeof a&&(a=J(a).detach()),this.each(function(){var b=this.nextSibling,c=this.parentNode;J(this).remove(),b?J(b).before(a):J(c).append(a)})):this.length?this.pushStack(J(J.isFunction(a)?a():a),"replaceWith",a):this},detach:function(a){return this.remove(a,!0)},domManip:function(a,c,d){var e,f,g,h,i=a[0],j=[];if(!J.support.checkClone&&3===arguments.length&&"string"==typeof i&&ya.test(i))return this.each(function(){J(this).domManip(a,c,d,!0)});if(J.isFunction(i))return this.each(function(e){var f=J(this);a[0]=i.call(this,e,c?f.html():b),f.domManip(a,c,d)});if(this[0]){if(h=i&&i.parentNode,e=J.support.parentNode&&h&&11===h.nodeType&&h.childNodes.length===this.length?{fragment:h}:J.buildFragment(a,this,j),g=e.fragment,f=1===g.childNodes.length?g=g.firstChild:g.firstChild,f){c=c&&J.nodeName(f,"tr");for(var k=0,l=this.length,m=l-1;l>k;k++)d.call(c?w(this[k],f):this[k],e.cacheable||l>1&&m>k?J.clone(g,!0,!0):g)}j.length&&J.each(j,function(a,b){b.src?J.ajax({type:"GET",global:!1,url:b.src,async:!1,dataType:"script"}):J.globalEval((b.text||b.textContent||b.innerHTML||"").replace(Aa,"/*$0*/")),b.parentNode&&b.parentNode.removeChild(b)})}return this}}),J.buildFragment=function(a,b,c){var d,e,f,g,h=a[0];return b&&b[0]&&(g=b[0].ownerDocument||b[0]),g.createDocumentFragment||(g=G),1===a.length&&"string"==typeof h&&h.length<512&&g===G&&"<"===h.charAt(0)&&!wa.test(h)&&(J.support.checkClone||!ya.test(h))&&(J.support.html5Clone||!xa.test(h))&&(e=!0,f=J.fragments[h],f&&1!==f&&(d=f)),d||(d=g.createDocumentFragment(),J.clean(a,g,d,c)),e&&(J.fragments[h]=f?d:1),
{fragment:d,cacheable:e}},J.fragments={},J.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(a,b){J.fn[a]=function(c){var d=[],e=J(c),f=1===this.length&&this[0].parentNode;if(f&&11===f.nodeType&&1===f.childNodes.length&&1===e.length)return e[b](this[0]),this;for(var g=0,h=e.length;h>g;g++){var i=(g>0?this.clone(!0):this).get();J(e[g])[b](i),d=d.concat(i)}return this.pushStack(d,a,e.selector)}}),J.extend({clone:function(a,b,c){var d,e,f,g=J.support.html5Clone||J.isXMLDoc(a)||!xa.test("<"+a.nodeName+">")?a.cloneNode(!0):q(a);if(!(J.support.noCloneEvent&&J.support.noCloneChecked||1!==a.nodeType&&11!==a.nodeType||J.isXMLDoc(a)))for(u(a,g),d=t(a),e=t(g),f=0;d[f];++f)e[f]&&u(d[f],e[f]);if(b&&(v(a,g),c))for(d=t(a),e=t(g),f=0;d[f];++f)v(d[f],e[f]);return d=e=null,g},clean:function(a,b,c,d){var e,f,g,h=[];b=b||G,"undefined"==typeof b.createElement&&(b=b.ownerDocument||b[0]&&b[0].ownerDocument||G);for(var i,j=0;null!=(i=a[j]);j++)if("number"==typeof i&&(i+=""),i){if("string"==typeof i)if(ua.test(i)){i=i.replace(ra,"<$1></$2>");var k,l=(sa.exec(i)||["",""])[1].toLowerCase(),m=Ba[l]||Ba._default,n=m[0],o=b.createElement("div"),p=Ca.childNodes;for(b===G?Ca.appendChild(o):x(b).appendChild(o),o.innerHTML=m[1]+i+m[2];n--;)o=o.lastChild;if(!J.support.tbody){var q=ta.test(i),s="table"!==l||q?"<table>"!==m[1]||q?[]:o.childNodes:o.firstChild&&o.firstChild.childNodes;for(g=s.length-1;g>=0;--g)J.nodeName(s[g],"tbody")&&!s[g].childNodes.length&&s[g].parentNode.removeChild(s[g])}!J.support.leadingWhitespace&&qa.test(i)&&o.insertBefore(b.createTextNode(qa.exec(i)[0]),o.firstChild),i=o.childNodes,o&&(o.parentNode.removeChild(o),p.length>0&&(k=p[p.length-1],k&&k.parentNode&&k.parentNode.removeChild(k)))}else i=b.createTextNode(i);var t;if(!J.support.appendChecked)if(i[0]&&"number"==typeof(t=i.length))for(g=0;t>g;g++)r(i[g]);else r(i);i.nodeType?h.push(i):h=J.merge(h,i)}if(c)for(e=function(a){return!a.type||za.test(a.type)},j=0;h[j];j++)if(f=h[j],d&&J.nodeName(f,"script")&&(!f.type||za.test(f.type)))d.push(f.parentNode?f.parentNode.removeChild(f):f);else{if(1===f.nodeType){var u=J.grep(f.getElementsByTagName("script"),e);h.splice.apply(h,[j+1,0].concat(u))}c.appendChild(f)}return h},cleanData:function(a){for(var b,c,d,e=J.cache,f=J.event.special,g=J.support.deleteExpando,h=0;null!=(d=a[h]);h++)if((!d.nodeName||!J.noData[d.nodeName.toLowerCase()])&&(c=d[J.expando])){if(b=e[c],b&&b.events){for(var i in b.events)f[i]?J.event.remove(d,i):J.removeEvent(d,i,b.handle);b.handle&&(b.handle.elem=null)}g?delete d[J.expando]:d.removeAttribute&&d.removeAttribute(J.expando),delete e[c]}}});var Da,Ea,Fa,Ga=/alpha\([^)]*\)/i,Ha=/opacity=([^)]*)/,Ia=/([A-Z]|^ms)/g,Ja=/^[\-+]?(?:\d*\.)?\d+$/i,Ka=/^-?(?:\d*\.)?\d+(?!px)[^\d\s]+$/i,La=/^([\-+])=([\-+.\de]+)/,Ma=/^margin/,Na={position:"absolute",visibility:"hidden",display:"block"},Oa=["Top","Right","Bottom","Left"];J.fn.css=function(a,c){return J.access(this,function(a,c,d){return d!==b?J.style(a,c,d):J.css(a,c)},a,c,arguments.length>1)},J.extend({cssHooks:{opacity:{get:function(a,b){if(b){var c=Da(a,"opacity");return""===c?"1":c}return a.style.opacity}}},cssNumber:{fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":J.support.cssFloat?"cssFloat":"styleFloat"},style:function(a,c,d,e){if(a&&3!==a.nodeType&&8!==a.nodeType&&a.style){var f,g,h=J.camelCase(c),i=a.style,j=J.cssHooks[h];if(c=J.cssProps[h]||h,d===b)return j&&"get"in j&&(f=j.get(a,!1,e))!==b?f:i[c];if(g=typeof d,"string"===g&&(f=La.exec(d))&&(d=+(f[1]+1)*+f[2]+parseFloat(J.css(a,c)),g="number"),null==d||"number"===g&&isNaN(d))return;if("number"===g&&!J.cssNumber[h]&&(d+="px"),!(j&&"set"in j&&(d=j.set(a,d))===b))try{i[c]=d}catch(k){}}},css:function(a,c,d){var e,f;return c=J.camelCase(c),f=J.cssHooks[c],c=J.cssProps[c]||c,"cssFloat"===c&&(c="float"),f&&"get"in f&&(e=f.get(a,!0,d))!==b?e:Da?Da(a,c):void 0},swap:function(a,b,c){var d,e,f={};for(e in b)f[e]=a.style[e],a.style[e]=b[e];d=c.call(a);for(e in b)a.style[e]=f[e];return d}}),J.curCSS=J.css,G.defaultView&&G.defaultView.getComputedStyle&&(Ea=function(a,b){var c,d,e,f,g=a.style;return b=b.replace(Ia,"-$1").toLowerCase(),(d=a.ownerDocument.defaultView)&&(e=d.getComputedStyle(a,null))&&(c=e.getPropertyValue(b),""===c&&!J.contains(a.ownerDocument.documentElement,a)&&(c=J.style(a,b))),!J.support.pixelMargin&&e&&Ma.test(b)&&Ka.test(c)&&(f=g.width,g.width=c,c=e.width,g.width=f),c}),G.documentElement.currentStyle&&(Fa=function(a,b){var c,d,e,f=a.currentStyle&&a.currentStyle[b],g=a.style;return null==f&&g&&(e=g[b])&&(f=e),Ka.test(f)&&(c=g.left,d=a.runtimeStyle&&a.runtimeStyle.left,d&&(a.runtimeStyle.left=a.currentStyle.left),g.left="fontSize"===b?"1em":f,f=g.pixelLeft+"px",g.left=c,d&&(a.runtimeStyle.left=d)),""===f?"auto":f}),Da=Ea||Fa,J.each(["height","width"],function(a,b){J.cssHooks[b]={get:function(a,c,d){return c?0!==a.offsetWidth?p(a,b,d):J.swap(a,Na,function(){return p(a,b,d)}):void 0},set:function(a,b){return Ja.test(b)?b+"px":b}}}),J.support.opacity||(J.cssHooks.opacity={get:function(a,b){return Ha.test((b&&a.currentStyle?a.currentStyle.filter:a.style.filter)||"")?parseFloat(RegExp.$1)/100+"":b?"1":""},set:function(a,b){var c=a.style,d=a.currentStyle,e=J.isNumeric(b)?"alpha(opacity="+100*b+")":"",f=d&&d.filter||c.filter||"";c.zoom=1,b>=1&&""===J.trim(f.replace(Ga,""))&&(c.removeAttribute("filter"),d&&!d.filter)||(c.filter=Ga.test(f)?f.replace(Ga,e):f+" "+e)}}),J(function(){J.support.reliableMarginRight||(J.cssHooks.marginRight={get:function(a,b){return J.swap(a,{display:"inline-block"},function(){return b?Da(a,"margin-right"):a.style.marginRight})}})}),J.expr&&J.expr.filters&&(J.expr.filters.hidden=function(a){var b=a.offsetWidth,c=a.offsetHeight;return 0===b&&0===c||!J.support.reliableHiddenOffsets&&"none"===(a.style&&a.style.display||J.css(a,"display"))},J.expr.filters.visible=function(a){return!J.expr.filters.hidden(a)}),J.each({margin:"",padding:"",border:"Width"},function(a,b){J.cssHooks[a+b]={expand:function(c){var d,e="string"==typeof c?c.split(" "):[c],f={};for(d=0;4>d;d++)f[a+Oa[d]+b]=e[d]||e[d-2]||e[0];return f}}});var Pa,Qa,Ra=/%20/g,Sa=/\[\]$/,Ta=/\r?\n/g,Ua=/#.*$/,Va=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Wa=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,Xa=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,Ya=/^(?:GET|HEAD)$/,Za=/^\/\//,$a=/\?/,_a=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,ab=/^(?:select|textarea)/i,bb=/\s+/,cb=/([?&])_=[^&]*/,db=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/,eb=J.fn.load,fb={},gb={},hb=["*/"]+["*"];try{Pa=I.href}catch(ib){Pa=G.createElement("a"),Pa.href="",Pa=Pa.href}Qa=db.exec(Pa.toLowerCase())||[],J.fn.extend({load:function(a,c,d){if("string"!=typeof a&&eb)return eb.apply(this,arguments);if(!this.length)return this;var e=a.indexOf(" ");if(e>=0){var f=a.slice(e,a.length);a=a.slice(0,e)}var g="GET";c&&(J.isFunction(c)?(d=c,c=b):"object"==typeof c&&(c=J.param(c,J.ajaxSettings.traditional),g="POST"));var h=this;return J.ajax({url:a,type:g,dataType:"html",data:c,complete:function(a,b,c){c=a.responseText,a.isResolved()&&(a.done(function(a){c=a}),h.html(f?J("<div>").append(c.replace(_a,"")).find(f):c)),d&&h.each(d,[c,b,a])}}),this},serialize:function(){return J.param(this.serializeArray())},serializeArray:function(){return this.map(function(){return this.elements?J.makeArray(this.elements):this}).filter(function(){return this.name&&!this.disabled&&(this.checked||ab.test(this.nodeName)||Wa.test(this.type))}).map(function(a,b){var c=J(this).val();return null==c?null:J.isArray(c)?J.map(c,function(a,c){return{name:b.name,value:a.replace(Ta,"\r\n")}}):{name:b.name,value:c.replace(Ta,"\r\n")}}).get()}}),J.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(a,b){J.fn[b]=function(a){return this.on(b,a)}}),J.each(["get","post"],function(a,c){J[c]=function(a,d,e,f){return J.isFunction(d)&&(f=f||e,e=d,d=b),J.ajax({type:c,url:a,data:d,success:e,dataType:f})}}),J.extend({getScript:function(a,c){return J.get(a,b,c,"script")},getJSON:function(a,b,c){return J.get(a,b,c,"json")},ajaxSetup:function(a,b){return b?m(a,J.ajaxSettings):(b=a,a=J.ajaxSettings),m(a,b),a},ajaxSettings:{url:Pa,isLocal:Xa.test(Qa[1]),global:!0,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:!0,async:!0,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":hb},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a.String,"text html":!0,"text json":J.parseJSON,"text xml":J.parseXML},flatOptions:{context:!0,url:!0}},ajaxPrefilter:o(fb),ajaxTransport:o(gb),ajax:function(a,c){function d(a,c,d,g){if(2!==x){x=2,i&&clearTimeout(i),h=b,f=g||"",y.readyState=a>0?4:0;var l,n,o,v,w,z=c,A=d?k(p,y,d):b;if(a>=200&&300>a||304===a)if(p.ifModified&&((v=y.getResponseHeader("Last-Modified"))&&(J.lastModified[e]=v),(w=y.getResponseHeader("Etag"))&&(J.etag[e]=w)),304===a)z="notmodified",l=!0;else try{n=j(p,A),z="success",l=!0}catch(B){z="parsererror",o=B}else o=z,(!z||a)&&(z="error",0>a&&(a=0));y.status=a,y.statusText=""+(c||z),l?s.resolveWith(q,[n,z,y]):s.rejectWith(q,[y,z,o]),y.statusCode(u),u=b,m&&r.trigger("ajax"+(l?"Success":"Error"),[y,p,l?n:o]),t.fireWith(q,[y,z]),m&&(r.trigger("ajaxComplete",[y,p]),--J.active||J.event.trigger("ajaxStop"))}}"object"==typeof a&&(c=a,a=b),c=c||{};var e,f,g,h,i,l,m,o,p=J.ajaxSetup({},c),q=p.context||p,r=q!==p&&(q.nodeType||q instanceof J)?J(q):J.event,s=J.Deferred(),t=J.Callbacks("once memory"),u=p.statusCode||{},v={},w={},x=0,y={readyState:0,setRequestHeader:function(a,b){if(!x){var c=a.toLowerCase();a=w[c]=w[c]||a,v[a]=b}return this},getAllResponseHeaders:function(){return 2===x?f:null},getResponseHeader:function(a){var c;if(2===x){if(!g)for(g={};c=Va.exec(f);)g[c[1].toLowerCase()]=c[2];c=g[a.toLowerCase()]}return c===b?null:c},overrideMimeType:function(a){return x||(p.mimeType=a),this},abort:function(a){return a=a||"abort",h&&h.abort(a),d(0,a),this}};if(s.promise(y),y.success=y.done,y.error=y.fail,y.complete=t.add,y.statusCode=function(a){if(a){var b;if(2>x)for(b in a)u[b]=[u[b],a[b]];else b=a[y.status],y.then(b,b)}return this},p.url=((a||p.url)+"").replace(Ua,"").replace(Za,Qa[1]+"//"),p.dataTypes=J.trim(p.dataType||"*").toLowerCase().split(bb),null==p.crossDomain&&(l=db.exec(p.url.toLowerCase()),p.crossDomain=!(!l||l[1]==Qa[1]&&l[2]==Qa[2]&&(l[3]||("http:"===l[1]?80:443))==(Qa[3]||("http:"===Qa[1]?80:443)))),p.data&&p.processData&&"string"!=typeof p.data&&(p.data=J.param(p.data,p.traditional)),n(fb,p,c,y),2===x)return!1;if(m=p.global,p.type=p.type.toUpperCase(),p.hasContent=!Ya.test(p.type),m&&0===J.active++&&J.event.trigger("ajaxStart"),!p.hasContent&&(p.data&&(p.url+=($a.test(p.url)?"&":"?")+p.data,delete p.data),e=p.url,p.cache===!1)){var z=J.now(),A=p.url.replace(cb,"$1_="+z);p.url=A+(A===p.url?($a.test(p.url)?"&":"?")+"_="+z:"")}(p.data&&p.hasContent&&p.contentType!==!1||c.contentType)&&y.setRequestHeader("Content-Type",p.contentType),p.ifModified&&(e=e||p.url,J.lastModified[e]&&y.setRequestHeader("If-Modified-Since",J.lastModified[e]),J.etag[e]&&y.setRequestHeader("If-None-Match",J.etag[e])),y.setRequestHeader("Accept",p.dataTypes[0]&&p.accepts[p.dataTypes[0]]?p.accepts[p.dataTypes[0]]+("*"!==p.dataTypes[0]?", "+hb+"; q=0.01":""):p.accepts["*"]);for(o in p.headers)y.setRequestHeader(o,p.headers[o]);if(p.beforeSend&&(p.beforeSend.call(q,y,p)===!1||2===x))return y.abort(),!1;for(o in{success:1,error:1,complete:1})y[o](p[o]);if(h=n(gb,p,c,y)){y.readyState=1,m&&r.trigger("ajaxSend",[y,p]),p.async&&p.timeout>0&&(i=setTimeout(function(){y.abort("timeout")},p.timeout));try{x=1,h.send(v,d)}catch(B){if(!(2>x))throw B;d(-1,B)}}else d(-1,"No Transport");return y},param:function(a,c){var d=[],e=function(a,b){b=J.isFunction(b)?b():b,d[d.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};if(c===b&&(c=J.ajaxSettings.traditional),J.isArray(a)||a.jquery&&!J.isPlainObject(a))J.each(a,function(){e(this.name,this.value)});else for(var f in a)l(f,a[f],c,e);return d.join("&").replace(Ra,"+")}}),J.extend({active:0,lastModified:{},etag:{}});var jb=J.now(),kb=/(\=)\?(&|$)|\?\?/i;J.ajaxSetup({jsonp:"callback",jsonpCallback:function(){return J.expando+"_"+jb++}}),J.ajaxPrefilter("json jsonp",function(b,c,d){var e="string"==typeof b.data&&/^application\/x\-www\-form\-urlencoded/.test(b.contentType);if("jsonp"===b.dataTypes[0]||b.jsonp!==!1&&(kb.test(b.url)||e&&kb.test(b.data))){var f,g=b.jsonpCallback=J.isFunction(b.jsonpCallback)?b.jsonpCallback():b.jsonpCallback,h=a[g],i=b.url,j=b.data,k="$1"+g+"$2";return b.jsonp!==!1&&(i=i.replace(kb,k),b.url===i&&(e&&(j=j.replace(kb,k)),b.data===j&&(i+=(/\?/.test(i)?"&":"?")+b.jsonp+"="+g))),b.url=i,b.data=j,a[g]=function(a){f=[a]},d.always(function(){a[g]=h,f&&J.isFunction(h)&&a[g](f[0])}),b.converters["script json"]=function(){return f||J.error(g+" was not called"),f[0]},b.dataTypes[0]="json","script"}}),J.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(a){return J.globalEval(a),a}}}),J.ajaxPrefilter("script",function(a){a.cache===b&&(a.cache=!1),a.crossDomain&&(a.type="GET",a.global=!1)}),J.ajaxTransport("script",function(a){if(a.crossDomain){var c,d=G.head||G.getElementsByTagName("head")[0]||G.documentElement;return{send:function(e,f){c=G.createElement("script"),c.async="async",a.scriptCharset&&(c.charset=a.scriptCharset),c.src=a.url,c.onload=c.onreadystatechange=function(a,e){(e||!c.readyState||/loaded|complete/.test(c.readyState))&&(c.onload=c.onreadystatechange=null,d&&c.parentNode&&d.removeChild(c),c=b,e||f(200,"success"))},d.insertBefore(c,d.firstChild)},abort:function(){c&&c.onload(0,1)}}}});var lb,mb=a.ActiveXObject?function(){for(var a in lb)lb[a](0,1)}:!1,nb=0;J.ajaxSettings.xhr=a.ActiveXObject?function(){return!this.isLocal&&i()||h()}:i,function(a){J.extend(J.support,{ajax:!!a,cors:!!a&&"withCredentials"in a})}(J.ajaxSettings.xhr()),J.support.ajax&&J.ajaxTransport(function(c){if(!c.crossDomain||J.support.cors){var d;return{send:function(e,f){var g,h,i=c.xhr();if(c.username?i.open(c.type,c.url,c.async,c.username,c.password):i.open(c.type,c.url,c.async),c.xhrFields)for(h in c.xhrFields)i[h]=c.xhrFields[h];c.mimeType&&i.overrideMimeType&&i.overrideMimeType(c.mimeType),!c.crossDomain&&!e["X-Requested-With"]&&(e["X-Requested-With"]="XMLHttpRequest");try{for(h in e)i.setRequestHeader(h,e[h])}catch(j){}i.send(c.hasContent&&c.data||null),d=function(a,e){var h,j,k,l,m;try{if(d&&(e||4===i.readyState))if(d=b,g&&(i.onreadystatechange=J.noop,mb&&delete lb[g]),e)4!==i.readyState&&i.abort();else{h=i.status,k=i.getAllResponseHeaders(),l={},m=i.responseXML,m&&m.documentElement&&(l.xml=m);try{l.text=i.responseText}catch(a){}try{j=i.statusText}catch(n){j=""}h||!c.isLocal||c.crossDomain?1223===h&&(h=204):h=l.text?200:404}}catch(o){e||f(-1,o)}l&&f(h,j,l,k)},c.async&&4!==i.readyState?(g=++nb,mb&&(lb||(lb={},J(a).unload(mb)),lb[g]=d),i.onreadystatechange=d):d()},abort:function(){d&&d(0,1)}}}});var ob,pb,qb,rb,sb={},tb=/^(?:toggle|show|hide)$/,ub=/^([+\-]=)?([\d+.\-]+)([a-z%]*)$/i,vb=[["height","marginTop","marginBottom","paddingTop","paddingBottom"],["width","marginLeft","marginRight","paddingLeft","paddingRight"],["opacity"]];J.fn.extend({show:function(a,b,c){var f,g;if(a||0===a)return this.animate(e("show",3),a,b,c);for(var h=0,i=this.length;i>h;h++)f=this[h],f.style&&(g=f.style.display,!J._data(f,"olddisplay")&&"none"===g&&(g=f.style.display=""),(""===g&&"none"===J.css(f,"display")||!J.contains(f.ownerDocument.documentElement,f))&&J._data(f,"olddisplay",d(f.nodeName)));for(h=0;i>h;h++)f=this[h],f.style&&(g=f.style.display,(""===g||"none"===g)&&(f.style.display=J._data(f,"olddisplay")||""));return this},hide:function(a,b,c){if(a||0===a)return this.animate(e("hide",3),a,b,c);for(var d,f,g=0,h=this.length;h>g;g++)d=this[g],d.style&&(f=J.css(d,"display"),"none"!==f&&!J._data(d,"olddisplay")&&J._data(d,"olddisplay",f));for(g=0;h>g;g++)this[g].style&&(this[g].style.display="none");return this},_toggle:J.fn.toggle,toggle:function(a,b,c){var d="boolean"==typeof a;return J.isFunction(a)&&J.isFunction(b)?this._toggle.apply(this,arguments):null==a||d?this.each(function(){var b=d?a:J(this).is(":hidden");J(this)[b?"show":"hide"]()}):this.animate(e("toggle",3),a,b,c),this},fadeTo:function(a,b,c,d){return this.filter(":hidden").css("opacity",0).show().end().animate({opacity:b},a,c,d)},animate:function(a,b,c,e){function f(){g.queue===!1&&J._mark(this);var b,c,e,f,h,i,j,k,l,m,n,o=J.extend({},g),p=1===this.nodeType,q=p&&J(this).is(":hidden");o.animatedProperties={};for(e in a)if(b=J.camelCase(e),e!==b&&(a[b]=a[e],delete a[e]),(h=J.cssHooks[b])&&"expand"in h){i=h.expand(a[b]),delete a[b];for(e in i)e in a||(a[e]=i[e])}for(b in a){if(c=a[b],J.isArray(c)?(o.animatedProperties[b]=c[1],c=a[b]=c[0]):o.animatedProperties[b]=o.specialEasing&&o.specialEasing[b]||o.easing||"swing","hide"===c&&q||"show"===c&&!q)return o.complete.call(this);p&&("height"===b||"width"===b)&&(o.overflow=[this.style.overflow,this.style.overflowX,this.style.overflowY],"inline"===J.css(this,"display")&&"none"===J.css(this,"float")&&(J.support.inlineBlockNeedsLayout&&"inline"!==d(this.nodeName)?this.style.zoom=1:this.style.display="inline-block"))}null!=o.overflow&&(this.style.overflow="hidden");for(e in a)f=new J.fx(this,o,e),c=a[e],tb.test(c)?(n=J._data(this,"toggle"+e)||("toggle"===c?q?"show":"hide":0),n?(J._data(this,"toggle"+e,"show"===n?"hide":"show"),f[n]()):f[c]()):(j=ub.exec(c),k=f.cur(),j?(l=parseFloat(j[2]),m=j[3]||(J.cssNumber[e]?"":"px"),"px"!==m&&(J.style(this,e,(l||1)+m),k=(l||1)/f.cur()*k,J.style(this,e,k+m)),j[1]&&(l=("-="===j[1]?-1:1)*l+k),f.custom(k,l,m)):f.custom(k,c,""));return!0}var g=J.speed(b,c,e);return J.isEmptyObject(a)?this.each(g.complete,[!1]):(a=J.extend({},a),g.queue===!1?this.each(f):this.queue(g.queue,f))},stop:function(a,c,d){return"string"!=typeof a&&(d=c,c=a,a=b),c&&a!==!1&&this.queue(a||"fx",[]),this.each(function(){function b(a,b,c){var e=b[c];J.removeData(a,c,!0),e.stop(d)}var c,e=!1,f=J.timers,g=J._data(this);if(d||J._unmark(!0,this),null==a)for(c in g)g[c]&&g[c].stop&&c.indexOf(".run")===c.length-4&&b(this,g,c);else g[c=a+".run"]&&g[c].stop&&b(this,g,c);for(c=f.length;c--;)f[c].elem===this&&(null==a||f[c].queue===a)&&(d?f[c](!0):f[c].saveState(),e=!0,f.splice(c,1));(!d||!e)&&J.dequeue(this,a)})}}),J.each({slideDown:e("show",1),slideUp:e("hide",1),slideToggle:e("toggle",1),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(a,b){J.fn[a]=function(a,c,d){return this.animate(b,a,c,d)}}),J.extend({speed:function(a,b,c){var d=a&&"object"==typeof a?J.extend({},a):{complete:c||!c&&b||J.isFunction(a)&&a,duration:a,easing:c&&b||b&&!J.isFunction(b)&&b};return d.duration=J.fx.off?0:"number"==typeof d.duration?d.duration:d.duration in J.fx.speeds?J.fx.speeds[d.duration]:J.fx.speeds._default,(null==d.queue||d.queue===!0)&&(d.queue="fx"),d.old=d.complete,d.complete=function(a){J.isFunction(d.old)&&d.old.call(this),d.queue?J.dequeue(this,d.queue):a!==!1&&J._unmark(this)},d},easing:{linear:function(a){return a},swing:function(a){return-Math.cos(a*Math.PI)/2+.5}},timers:[],fx:function(a,b,c){this.options=b,this.elem=a,this.prop=c,b.orig=b.orig||{}}}),J.fx.prototype={update:function(){this.options.step&&this.options.step.call(this.elem,this.now,this),(J.fx.step[this.prop]||J.fx.step._default)(this)},cur:function(){if(null!=this.elem[this.prop]&&(!this.elem.style||null==this.elem.style[this.prop]))return this.elem[this.prop];var a,b=J.css(this.elem,this.prop);return isNaN(a=parseFloat(b))?b&&"auto"!==b?b:0:a},custom:function(a,c,d){function e(a){return f.step(a)}var f=this,h=J.fx;this.startTime=rb||g(),this.end=c,this.now=this.start=a,this.pos=this.state=0,this.unit=d||this.unit||(J.cssNumber[this.prop]?"":"px"),e.queue=this.options.queue,e.elem=this.elem,e.saveState=function(){J._data(f.elem,"fxshow"+f.prop)===b&&(f.options.hide?J._data(f.elem,"fxshow"+f.prop,f.start):f.options.show&&J._data(f.elem,"fxshow"+f.prop,f.end))},e()&&J.timers.push(e)&&!qb&&(qb=setInterval(h.tick,h.interval))},show:function(){var a=J._data(this.elem,"fxshow"+this.prop);this.options.orig[this.prop]=a||J.style(this.elem,this.prop),this.options.show=!0,a!==b?this.custom(this.cur(),a):this.custom("width"===this.prop||"height"===this.prop?1:0,this.cur()),J(this.elem).show()},hide:function(){this.options.orig[this.prop]=J._data(this.elem,"fxshow"+this.prop)||J.style(this.elem,this.prop),this.options.hide=!0,this.custom(this.cur(),0)},step:function(a){var b,c,d,e=rb||g(),f=!0,h=this.elem,i=this.options;if(a||e>=i.duration+this.startTime){this.now=this.end,this.pos=this.state=1,this.update(),i.animatedProperties[this.prop]=!0;for(b in i.animatedProperties)i.animatedProperties[b]!==!0&&(f=!1);if(f){if(null!=i.overflow&&!J.support.shrinkWrapBlocks&&J.each(["","X","Y"],function(a,b){h.style["overflow"+b]=i.overflow[a]}),i.hide&&J(h).hide(),i.hide||i.show)for(b in i.animatedProperties)J.style(h,b,i.orig[b]),J.removeData(h,"fxshow"+b,!0),J.removeData(h,"toggle"+b,!0);d=i.complete,d&&(i.complete=!1,d.call(h))}return!1}return i.duration==1/0?this.now=e:(c=e-this.startTime,this.state=c/i.duration,this.pos=J.easing[i.animatedProperties[this.prop]](this.state,c,0,1,i.duration),this.now=this.start+(this.end-this.start)*this.pos),this.update(),!0}},J.extend(J.fx,{tick:function(){for(var a,b=J.timers,c=0;c<b.length;c++)a=b[c],!a()&&b[c]===a&&b.splice(c--,1);b.length||J.fx.stop()},interval:13,stop:function(){clearInterval(qb),qb=null},speeds:{slow:600,fast:200,_default:400},step:{opacity:function(a){J.style(a.elem,"opacity",a.now)},_default:function(a){a.elem.style&&null!=a.elem.style[a.prop]?a.elem.style[a.prop]=a.now+a.unit:a.elem[a.prop]=a.now}}}),J.each(vb.concat.apply([],vb),function(a,b){b.indexOf("margin")&&(J.fx.step[b]=function(a){J.style(a.elem,b,Math.max(0,a.now)+a.unit)})}),J.expr&&J.expr.filters&&(J.expr.filters.animated=function(a){return J.grep(J.timers,function(b){return a===b.elem}).length});var wb,xb=/^t(?:able|d|h)$/i,yb=/^(?:body|html)$/i;wb="getBoundingClientRect"in G.documentElement?function(a,b,d,e){try{e=a.getBoundingClientRect()}catch(f){}if(!e||!J.contains(d,a))return e?{top:e.top,left:e.left}:{top:0,left:0};var g=b.body,h=c(b),i=d.clientTop||g.clientTop||0,j=d.clientLeft||g.clientLeft||0,k=h.pageYOffset||J.support.boxModel&&d.scrollTop||g.scrollTop,l=h.pageXOffset||J.support.boxModel&&d.scrollLeft||g.scrollLeft,m=e.top+k-i,n=e.left+l-j;return{top:m,left:n}}:function(a,b,c){for(var d,e=a.offsetParent,f=a,g=b.body,h=b.defaultView,i=h?h.getComputedStyle(a,null):a.currentStyle,j=a.offsetTop,k=a.offsetLeft;(a=a.parentNode)&&a!==g&&a!==c&&(!J.support.fixedPosition||"fixed"!==i.position);)d=h?h.getComputedStyle(a,null):a.currentStyle,j-=a.scrollTop,k-=a.scrollLeft,a===e&&(j+=a.offsetTop,k+=a.offsetLeft,J.support.doesNotAddBorder&&(!J.support.doesAddBorderForTableAndCells||!xb.test(a.nodeName))&&(j+=parseFloat(d.borderTopWidth)||0,k+=parseFloat(d.borderLeftWidth)||0),f=e,e=a.offsetParent),J.support.subtractsBorderForOverflowNotVisible&&"visible"!==d.overflow&&(j+=parseFloat(d.borderTopWidth)||0,k+=parseFloat(d.borderLeftWidth)||0),i=d;return("relative"===i.position||"static"===i.position)&&(j+=g.offsetTop,k+=g.offsetLeft),J.support.fixedPosition&&"fixed"===i.position&&(j+=Math.max(c.scrollTop,g.scrollTop),k+=Math.max(c.scrollLeft,g.scrollLeft)),{top:j,left:k}},J.fn.offset=function(a){if(arguments.length)return a===b?this:this.each(function(b){J.offset.setOffset(this,a,b)});var c=this[0],d=c&&c.ownerDocument;return d?c===d.body?J.offset.bodyOffset(c):wb(c,d,d.documentElement):null},J.offset={bodyOffset:function(a){var b=a.offsetTop,c=a.offsetLeft;return J.support.doesNotIncludeMarginInBodyOffset&&(b+=parseFloat(J.css(a,"marginTop"))||0,c+=parseFloat(J.css(a,"marginLeft"))||0),{top:b,left:c}},setOffset:function(a,b,c){var d=J.css(a,"position");"static"===d&&(a.style.position="relative");var e,f,g=J(a),h=g.offset(),i=J.css(a,"top"),j=J.css(a,"left"),k=("absolute"===d||"fixed"===d)&&J.inArray("auto",[i,j])>-1,l={},m={};k?(m=g.position(),e=m.top,f=m.left):(e=parseFloat(i)||0,f=parseFloat(j)||0),J.isFunction(b)&&(b=b.call(a,c,h)),null!=b.top&&(l.top=b.top-h.top+e),null!=b.left&&(l.left=b.left-h.left+f),"using"in b?b.using.call(a,l):g.css(l)}},J.fn.extend({position:function(){if(!this[0])return null;var a=this[0],b=this.offsetParent(),c=this.offset(),d=yb.test(b[0].nodeName)?{top:0,left:0}:b.offset();return c.top-=parseFloat(J.css(a,"marginTop"))||0,c.left-=parseFloat(J.css(a,"marginLeft"))||0,d.top+=parseFloat(J.css(b[0],"borderTopWidth"))||0,d.left+=parseFloat(J.css(b[0],"borderLeftWidth"))||0,{top:c.top-d.top,left:c.left-d.left}},offsetParent:function(){return this.map(function(){for(var a=this.offsetParent||G.body;a&&!yb.test(a.nodeName)&&"static"===J.css(a,"position");)a=a.offsetParent;return a})}}),J.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(a,d){var e=/Y/.test(d);J.fn[a]=function(f){return J.access(this,function(a,f,g){var h=c(a);return g===b?h?d in h?h[d]:J.support.boxModel&&h.document.documentElement[f]||h.document.body[f]:a[f]:void(h?h.scrollTo(e?J(h).scrollLeft():g,e?g:J(h).scrollTop()):a[f]=g)},a,f,arguments.length,null)}}),J.each({Height:"height",Width:"width"},function(a,c){var d="client"+a,e="scroll"+a,f="offset"+a;J.fn["inner"+a]=function(){var a=this[0];return a?a.style?parseFloat(J.css(a,c,"padding")):this[c]():null},J.fn["outer"+a]=function(a){var b=this[0];return b?b.style?parseFloat(J.css(b,c,a?"margin":"border")):this[c]():null},J.fn[c]=function(a){return J.access(this,function(a,c,g){var h,i,j,k;return J.isWindow(a)?(h=a.document,i=h.documentElement[d],J.support.boxModel&&i||h.body&&h.body[d]||i):9===a.nodeType?(h=a.documentElement,h[d]>=h[e]?h[d]:Math.max(a.body[e],h[e],a.body[f],h[f])):g===b?(j=J.css(a,c),k=parseFloat(j),J.isNumeric(k)?k:j):void J(a).css(c,g)},c,a,arguments.length,null)}}),a.jQuery=a.$=J,"function"==typeof define&&define.amd&&define.amd.jQuery&&define("jquery",[],function(){return J})}(window);var jaaulde=window.jaaulde||{};jaaulde.utils=jaaulde.utils||{},jaaulde.utils.cookies=function(){var a,b,c,d,e={expiresAt:null,path:"/",domain:null,secure:!1};return a=function(a){var b,c;return"object"!=typeof a||null===a?b=e:(b={expiresAt:e.expiresAt,path:e.path,domain:e.domain,secure:e.secure},"object"==typeof a.expiresAt&&a.expiresAt instanceof Date?b.expiresAt=a.expiresAt:"number"==typeof a.hoursToLive&&0!==a.hoursToLive&&(c=new Date,c.setTime(c.getTime()+60*a.hoursToLive*60*1e3),b.expiresAt=c),"string"==typeof a.path&&""!==a.path&&(b.path=a.path),"string"==typeof a.domain&&""!==a.domain&&(b.domain=a.domain),a.secure===!0&&(b.secure=a.secure)),b},b=function(b){return b=a(b),("object"==typeof b.expiresAt&&b.expiresAt instanceof Date?"; expires="+b.expiresAt.toGMTString():"")+"; path="+b.path+("string"==typeof b.domain?"; domain="+b.domain:"")+(b.secure===!0?"; secure":"")},c=function(){var a,b,c,d,e,f={},g=document.cookie.split(";");for(a=0;a<g.length;a+=1){b=g[a].split("="),c=b[0].replace(/^\s*/,"").replace(/\s*$/,"");try{d=decodeURIComponent(b[1])}catch(h){d=b[1]}if("object"==typeof JSON&&null!==JSON&&"function"==typeof JSON.parse)try{e=d,d=JSON.parse(d)}catch(i){d=e}f[c]=d}return f},d=function(){},d.prototype.get=function(a){var b,d,e=c();if("string"==typeof a)b="undefined"!=typeof e[a]?e[a]:null;else if("object"==typeof a&&null!==a){b={};for(d in a)"undefined"!=typeof e[a[d]]?b[a[d]]=e[a[d]]:b[a[d]]=null}else b=e;return b},d.prototype.filter=function(a){var b,d={},e=c();"string"==typeof a&&(a=new RegExp(a));for(b in e)b.match(a)&&(d[b]=e[b]);return d},d.prototype.set=function(a,c,d){if(("object"!=typeof d||null===d)&&(d={}),"undefined"==typeof c||null===c)c="",d.hoursToLive=-8760;else if("string"!=typeof c){if("object"!=typeof JSON||null===JSON||"function"!=typeof JSON.stringify)throw new Error("cookies.set() received non-string value and could not serialize.");c=JSON.stringify(c)}var e=b(d);document.cookie=a+"="+encodeURIComponent(c)+e},d.prototype.del=function(a,b){var c,d={};("object"!=typeof b||null===b)&&(b={}),"boolean"==typeof a&&a===!0?d=this.get():"string"==typeof a&&(d[a]=!0);for(c in d)"string"==typeof c&&""!==c&&this.set(c,null,b)},d.prototype.test=function(){var a=!1,b="cT",c="data";return this.set(b,c),this.get(b)===c&&(this.del(b),a=!0),a},d.prototype.setOptions=function(b){"object"!=typeof b&&(b=null),e=a(b)},new d}(),function(){window.jQuery&&!function(a){a.cookies=jaaulde.utils.cookies;var b={cookify:function(b){return this.each(function(){var c,d,e,f=["name","id"],g=a(this);for(c in f)if(!isNaN(c)&&(d=g.attr(f[c]),"string"==typeof d&&""!==d)){g.is(":checkbox, :radio")?g.attr("checked")&&(e=g.val()):e=g.is(":input")?g.val():g.html(),("string"!=typeof e||""===e)&&(e=null),a.cookies.set(d,e,b);break}})},cookieFill:function(){return this.each(function(){var b,c,d,e,f=["name","id"],g=a(this);for(c=function(){return b=f.pop(),!!b};c();)if(d=g.attr(b),"string"==typeof d&&""!==d){e=a.cookies.get(d),null!==e&&(g.is(":checkbox, :radio")?g.val()===e?g.attr("checked","checked"):g.removeAttr("checked"):g.is(":input")?g.val(e):g.html(e));break}})},cookieBind:function(b){return this.each(function(){var c=a(this);c.cookieFill().change(function(){c.cookify(b)})})}};a.each(b,function(b){a.fn[b]=this})}(window.jQuery)}(),function(a){a.fn.hoverIntent=function(b,c,d){var e={interval:100,sensitivity:7,timeout:0};e="object"==typeof b?a.extend(e,b):a.isFunction(c)?a.extend(e,{over:b,out:c,selector:d}):a.extend(e,{over:b,out:b,selector:c});var f,g,h,i,j=function(a){f=a.pageX,g=a.pageY},k=function(b,c){return c.hoverIntent_t=clearTimeout(c.hoverIntent_t),Math.abs(h-f)+Math.abs(i-g)<e.sensitivity?(a(c).off("mousemove.hoverIntent",j),c.hoverIntent_s=1,e.over.apply(c,[b])):(h=f,i=g,c.hoverIntent_t=setTimeout(function(){k(b,c)},e.interval),void 0)},l=function(a,b){return b.hoverIntent_t=clearTimeout(b.hoverIntent_t),b.hoverIntent_s=0,e.out.apply(b,[a])},m=function(b){var c=jQuery.extend({},b),d=this;d.hoverIntent_t&&(d.hoverIntent_t=clearTimeout(d.hoverIntent_t)),"mouseenter"==b.type?(h=c.pageX,i=c.pageY,a(d).on("mousemove.hoverIntent",j),1!=d.hoverIntent_s&&(d.hoverIntent_t=setTimeout(function(){k(c,d)},e.interval))):(a(d).off("mousemove.hoverIntent",j),1==d.hoverIntent_s&&(d.hoverIntent_t=setTimeout(function(){l(c,d)},e.timeout)))};return this.on({"mouseenter.hoverIntent":m,"mouseleave.hoverIntent":m},e.selector)}}(jQuery);var Kinetic={};!function(){Kinetic.version="4.3.3",Kinetic.Filters={},Kinetic.Plugins={},Kinetic.Global={stages:[],idCounter:0,ids:{},names:{},shapes:{},warn:function(a){window.console&&console.warn&&console.warn("Kinetic warning: "+a)},extend:function(a,b){for(var c in b.prototype)c in a.prototype||(a.prototype[c]=b.prototype[c])},_addId:function(a,b){void 0!==b&&(this.ids[b]=a)},_removeId:function(a){void 0!==a&&delete this.ids[a]},_addName:function(a,b){void 0!==b&&(void 0===this.names[b]&&(this.names[b]=[]),this.names[b].push(a))},_removeName:function(a,b){if(void 0!==a){var c=this.names[a];if(void 0!==c){for(var d=0;d<c.length;d++){var e=c[d];e._id===b&&c.splice(d,1)}0===c.length&&delete this.names[a]}}}}}(),function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.returnExports=b()}(this,function(){return Kinetic}),function(){Kinetic.Type={_isElement:function(a){return!!a&&1==a.nodeType},_isFunction:function(a){return!!(a&&a.constructor&&a.call&&a.apply)},_isObject:function(a){return!!a&&a.constructor==Object},_isArray:function(a){return"[object Array]"==Object.prototype.toString.call(a)},_isNumber:function(a){return"[object Number]"==Object.prototype.toString.call(a);
},_isString:function(a){return"[object String]"==Object.prototype.toString.call(a)},_hasMethods:function(a){var b=[];for(var c in a)this._isFunction(a[c])&&b.push(c);return b.length>0},_isInDocument:function(a){for(;a=a.parentNode;)if(a==document)return!0;return!1},_getXY:function(a){if(this._isNumber(a))return{x:a,y:a};if(this._isArray(a)){if(1===a.length){var b=a[0];if(this._isNumber(b))return{x:b,y:b};if(this._isArray(b))return{x:b[0],y:b[1]};if(this._isObject(b))return b}else if(a.length>=2)return{x:a[0],y:a[1]}}else if(this._isObject(a))return a;return null},_getSize:function(a){if(this._isNumber(a))return{width:a,height:a};if(this._isArray(a))if(1===a.length){var b=a[0];if(this._isNumber(b))return{width:b,height:b};if(this._isArray(b)){if(b.length>=4)return{width:b[2],height:b[3]};if(b.length>=2)return{width:b[0],height:b[1]}}else if(this._isObject(b))return b}else{if(a.length>=4)return{width:a[2],height:a[3]};if(a.length>=2)return{width:a[0],height:a[1]}}else if(this._isObject(a))return a;return null},_getPoints:function(a){if(void 0===a)return[];if(this._isArray(a[0])){for(var b=[],c=0;c<a.length;c++)b.push({x:a[c][0],y:a[c][1]});return b}if(this._isObject(a[0]))return a;for(var b=[],c=0;c<a.length;c+=2)b.push({x:a[c],y:a[c+1]});return b},_getImage:function(a,b){if(a)if(this._isElement(a))b(a);else if(this._isString(a)){var c=new Image;c.onload=function(){b(c)},c.src=a}else if(a.data){var d=document.createElement("canvas");d.width=a.width,d.height=a.height;var e=d.getContext("2d");e.putImageData(a,0,0);var f=d.toDataURL(),c=new Image;c.onload=function(){b(c)},c.src=f}else b(null);else b(null)},_rgbToHex:function(a,b,c){return((1<<24)+(a<<16)+(b<<8)+c).toString(16).slice(1)},_hexToRgb:function(a){var b=parseInt(a,16);return{r:b>>16&255,g:b>>8&255,b:255&b}},_getRandomColorKey:function(){var a=Math.round(255*Math.random()),b=Math.round(255*Math.random()),c=Math.round(255*Math.random());return this._rgbToHex(a,b,c)},_merge:function(a,b){var c=this._clone(b);for(var d in a)this._isObject(a[d])?c[d]=this._merge(a[d],c[d]):c[d]=a[d];return c},_clone:function(a){var b={};for(var c in a)this._isObject(a[c])?b[c]=this._clone(a[c]):b[c]=a[c];return b},_degToRad:function(a){return a*Math.PI/180},_radToDeg:function(a){return 180*a/Math.PI}}}(),function(){var a=document.createElement("canvas"),b=a.getContext("2d"),c=window.devicePixelRatio||1,d=b.webkitBackingStorePixelRatio||b.mozBackingStorePixelRatio||b.msBackingStorePixelRatio||b.oBackingStorePixelRatio||b.backingStorePixelRatio||1,e=c/d;Kinetic.Canvas=function(a,b,c){this.pixelRatio=c||e,this.width=a,this.height=b,this.element=document.createElement("canvas"),this.context=this.element.getContext("2d"),this.setSize(a||0,b||0)},Kinetic.Canvas.prototype={clear:function(){var a=this.getContext(),b=this.getElement();a.clearRect(0,0,b.width,b.height)},getElement:function(){return this.element},getContext:function(){return this.context},setWidth:function(a){this.width=a,this.element.width=a*this.pixelRatio,this.element.style.width=a+"px"},setHeight:function(a){this.height=a,this.element.height=a*this.pixelRatio,this.element.style.height=a+"px"},getWidth:function(){return this.width},getHeight:function(){return this.height},setSize:function(a,b){this.setWidth(a),this.setHeight(b)},toDataURL:function(a,b){try{return this.element.toDataURL(a,b)}catch(c){try{return this.element.toDataURL()}catch(c){return Kinetic.Global.warn("Unable to get data URL. "+c.message),""}}},fill:function(a){a.getFillEnabled()&&this._fill(a)},stroke:function(a){a.getStrokeEnabled()&&this._stroke(a)},fillStroke:function(a){var b=a.getFillEnabled();b&&this._fill(a),a.getStrokeEnabled()&&this._stroke(a,a.hasShadow()&&a.hasFill()&&b)},applyShadow:function(a,b){var c=this.context;c.save(),this._applyShadow(a),b(),c.restore(),b()},_applyLineCap:function(a){var b=a.getLineCap();b&&(this.context.lineCap=b)},_applyOpacity:function(a){var b=a.getAbsoluteOpacity();1!==b&&(this.context.globalAlpha=b)},_applyLineJoin:function(a){var b=a.getLineJoin();b&&(this.context.lineJoin=b)},_applyAncestorTransforms:function(a){var b=this.context;a._eachAncestorReverse(function(a){var c=a.getTransform(),d=c.getMatrix();b.transform(d[0],d[1],d[2],d[3],d[4],d[5])},!0)}},Kinetic.SceneCanvas=function(a,b,c){Kinetic.Canvas.call(this,a,b,c)},Kinetic.SceneCanvas.prototype={setWidth:function(a){var b=this.pixelRatio;Kinetic.Canvas.prototype.setWidth.call(this,a),this.context.scale(b,b)},setHeight:function(a){var b=this.pixelRatio;Kinetic.Canvas.prototype.setHeight.call(this,a),this.context.scale(b,b)},_fillColor:function(a){var b=this.context,c=a.getFill();b.fillStyle=c,a._fillFunc(b)},_fillPattern:function(a){var b=this.context,c=a.getFillPatternImage(),d=a.getFillPatternX(),e=a.getFillPatternY(),f=a.getFillPatternScale(),g=a.getFillPatternRotation(),h=a.getFillPatternOffset(),i=a.getFillPatternRepeat();(d||e)&&b.translate(d||0,e||0),g&&b.rotate(g),f&&b.scale(f.x,f.y),h&&b.translate(-1*h.x,-1*h.y),b.fillStyle=b.createPattern(c,i||"repeat"),b.fill()},_fillLinearGradient:function(a){for(var b=this.context,c=a.getFillLinearGradientStartPoint(),d=a.getFillLinearGradientEndPoint(),e=a.getFillLinearGradientColorStops(),f=b.createLinearGradient(c.x,c.y,d.x,d.y),g=0;g<e.length;g+=2)f.addColorStop(e[g],e[g+1]);b.fillStyle=f,b.fill()},_fillRadialGradient:function(a){for(var b=this.context,c=a.getFillRadialGradientStartPoint(),d=a.getFillRadialGradientEndPoint(),e=a.getFillRadialGradientStartRadius(),f=a.getFillRadialGradientEndRadius(),g=a.getFillRadialGradientColorStops(),h=b.createRadialGradient(c.x,c.y,e,d.x,d.y,f),i=0;i<g.length;i+=2)h.addColorStop(g[i],g[i+1]);b.fillStyle=h,b.fill()},_fill:function(a,b){var c=this.context,d=a.getFill(),e=a.getFillPatternImage(),f=a.getFillLinearGradientStartPoint(),g=a.getFillRadialGradientStartPoint(),h=a.getFillPriority();c.save(),!b&&a.hasShadow()&&this._applyShadow(a),d&&"color"===h?this._fillColor(a):e&&"pattern"===h?this._fillPattern(a):f&&"linear-gradient"===h?this._fillLinearGradient(a):g&&"radial-gradient"===h?this._fillRadialGradient(a):d?this._fillColor(a):e?this._fillPattern(a):f?this._fillLinearGradient(a):g&&this._fillRadialGradient(a),c.restore(),!b&&a.hasShadow()&&this._fill(a,!0)},_stroke:function(a,b){var c=this.context,d=a.getStroke(),e=a.getStrokeWidth(),f=a.getDashArray();(d||e)&&(c.save(),this._applyLineCap(a),f&&a.getDashArrayEnabled()&&(c.setLineDash?c.setLineDash(f):"mozDash"in c?c.mozDash=f:"webkitLineDash"in c&&(c.webkitLineDash=f)),!b&&a.hasShadow()&&this._applyShadow(a),c.lineWidth=e||2,c.strokeStyle=d||"black",a._strokeFunc(c),c.restore(),!b&&a.hasShadow()&&this._stroke(a,!0))},_applyShadow:function(a){var b=this.context;if(a.hasShadow()&&a.getShadowEnabled()){var c=a.getAbsoluteOpacity(),d=a.getShadowColor()||"black",e=a.getShadowBlur()||5,f=a.getShadowOffset()||{x:0,y:0};a.getShadowOpacity()&&(b.globalAlpha=a.getShadowOpacity()*c),b.shadowColor=d,b.shadowBlur=e,b.shadowOffsetX=f.x,b.shadowOffsetY=f.y}}},Kinetic.Global.extend(Kinetic.SceneCanvas,Kinetic.Canvas),Kinetic.HitCanvas=function(a,b,c){Kinetic.Canvas.call(this,a,b,c)},Kinetic.HitCanvas.prototype={_fill:function(a){var b=this.context;b.save(),b.fillStyle="#"+a.colorKey,a._fillFuncHit(b),b.restore()},_stroke:function(a){var b=this.context,c=a.getStroke(),d=a.getStrokeWidth();(c||d)&&(this._applyLineCap(a),b.save(),b.lineWidth=d||2,b.strokeStyle="#"+a.colorKey,a._strokeFuncHit(b),b.restore())}},Kinetic.Global.extend(Kinetic.HitCanvas,Kinetic.Canvas)}(),function(){Kinetic.Tween=function(a,b,c,d,e,f){this._listeners=[],this.addListener(this),this.obj=a,this.propFunc=b,this.begin=d,this._pos=d,this.setDuration(f),this.isPlaying=!1,this._change=0,this.prevTime=0,this.prevPos=0,this.looping=!1,this._time=0,this._position=0,this._startTime=0,this._finish=0,this.name="",this.func=c,this.setFinish(e)},Kinetic.Tween.prototype={setTime:function(a){this.prevTime=this._time,a>this.getDuration()?this.looping?(this.rewind(a-this._duration),this.update(),this.broadcastMessage("onLooped",{target:this,type:"onLooped"})):(this._time=this._duration,this.update(),this.stop(),this.broadcastMessage("onFinished",{target:this,type:"onFinished"})):0>a?(this.rewind(),this.update()):(this._time=a,this.update())},getTime:function(){return this._time},setDuration:function(a){this._duration=null===a||0>=a?1e5:a},getDuration:function(){return this._duration},setPosition:function(a){this.prevPos=this._pos,this.propFunc(a),this._pos=a,this.broadcastMessage("onChanged",{target:this,type:"onChanged"})},getPosition:function(a){return void 0===a&&(a=this._time),this.func(a,this.begin,this._change,this._duration)},setFinish:function(a){this._change=a-this.begin},getFinish:function(){return this.begin+this._change},start:function(){this.rewind(),this.startEnterFrame(),this.broadcastMessage("onStarted",{target:this,type:"onStarted"})},rewind:function(a){this.stop(),this._time=void 0===a?0:a,this.fixTime(),this.update()},fforward:function(){this._time=this._duration,this.fixTime(),this.update()},update:function(){this.setPosition(this.getPosition(this._time))},startEnterFrame:function(){this.stopEnterFrame(),this.isPlaying=!0,this.onEnterFrame()},onEnterFrame:function(){this.isPlaying&&this.nextFrame()},nextFrame:function(){this.setTime((this.getTimer()-this._startTime)/1e3)},stop:function(){this.stopEnterFrame(),this.broadcastMessage("onStopped",{target:this,type:"onStopped"})},stopEnterFrame:function(){this.isPlaying=!1},continueTo:function(a,b){this.begin=this._pos,this.setFinish(a),void 0!==this._duration&&this.setDuration(b),this.start()},resume:function(){this.fixTime(),this.startEnterFrame(),this.broadcastMessage("onResumed",{target:this,type:"onResumed"})},yoyo:function(){this.continueTo(this.begin,this._time)},addListener:function(a){return this.removeListener(a),this._listeners.push(a)},removeListener:function(a){for(var b=this._listeners,c=b.length;c--;)if(b[c]==a)return b.splice(c,1),!0;return!1},broadcastMessage:function(){for(var a=[],b=0;b<arguments.length;b++)a.push(arguments[b]);for(var c=a.shift(),d=this._listeners,e=d.length,b=0;e>b;b++)d[b][c]&&d[b][c].apply(d[b],a)},fixTime:function(){this._startTime=this.getTimer()-1e3*this._time},getTimer:function(){return(new Date).getTime()-this._time}},Kinetic.Tweens={"back-ease-in":function(a,b,c,d,e,f){var g=1.70158;return c*(a/=d)*a*((g+1)*a-g)+b},"back-ease-out":function(a,b,c,d,e,f){var g=1.70158;return c*((a=a/d-1)*a*((g+1)*a+g)+1)+b},"back-ease-in-out":function(a,b,c,d,e,f){var g=1.70158;return(a/=d/2)<1?c/2*a*a*(((g*=1.525)+1)*a-g)+b:c/2*((a-=2)*a*(((g*=1.525)+1)*a+g)+2)+b},"elastic-ease-in":function(a,b,c,d,e,f){var g=0;return 0===a?b:1==(a/=d)?b+c:(f||(f=.3*d),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),-(e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f))+b)},"elastic-ease-out":function(a,b,c,d,e,f){var g=0;return 0===a?b:1==(a/=d)?b+c:(f||(f=.3*d),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),e*Math.pow(2,-10*a)*Math.sin(2*(a*d-g)*Math.PI/f)+c+b)},"elastic-ease-in-out":function(a,b,c,d,e,f){var g=0;return 0===a?b:2==(a/=d/2)?b+c:(f||(f=.3*d*1.5),!e||e<Math.abs(c)?(e=c,g=f/4):g=f/(2*Math.PI)*Math.asin(c/e),1>a?-.5*e*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)+b:e*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-g)*Math.PI/f)*.5+c+b)},"bounce-ease-out":function(a,b,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+b:2/2.75>a?c*(7.5625*(a-=1.5/2.75)*a+.75)+b:2.5/2.75>a?c*(7.5625*(a-=2.25/2.75)*a+.9375)+b:c*(7.5625*(a-=2.625/2.75)*a+.984375)+b},"bounce-ease-in":function(a,b,c,d){return c-Kinetic.Tweens["bounce-ease-out"](d-a,0,c,d)+b},"bounce-ease-in-out":function(a,b,c,d){return d/2>a?.5*Kinetic.Tweens["bounce-ease-in"](2*a,0,c,d)+b:.5*Kinetic.Tweens["bounce-ease-out"](2*a-d,0,c,d)+.5*c+b},"ease-in":function(a,b,c,d){return c*(a/=d)*a+b},"ease-out":function(a,b,c,d){return-c*(a/=d)*(a-2)+b},"ease-in-out":function(a,b,c,d){return(a/=d/2)<1?c/2*a*a+b:-c/2*(--a*(a-2)-1)+b},"strong-ease-in":function(a,b,c,d){return c*(a/=d)*a*a*a*a+b},"strong-ease-out":function(a,b,c,d){return c*((a=a/d-1)*a*a*a*a+1)+b},"strong-ease-in-out":function(a,b,c,d){return(a/=d/2)<1?c/2*a*a*a*a*a+b:c/2*((a-=2)*a*a*a*a+2)+b},linear:function(a,b,c,d){return c*a/d+b}}}(),function(){Kinetic.Transform=function(){this.m=[1,0,0,1,0,0]},Kinetic.Transform.prototype={translate:function(a,b){this.m[4]+=this.m[0]*a+this.m[2]*b,this.m[5]+=this.m[1]*a+this.m[3]*b},scale:function(a,b){this.m[0]*=a,this.m[1]*=a,this.m[2]*=b,this.m[3]*=b},rotate:function(a){var b=Math.cos(a),c=Math.sin(a),d=this.m[0]*b+this.m[2]*c,e=this.m[1]*b+this.m[3]*c,f=this.m[0]*-c+this.m[2]*b,g=this.m[1]*-c+this.m[3]*b;this.m[0]=d,this.m[1]=e,this.m[2]=f,this.m[3]=g},getTranslation:function(){return{x:this.m[4],y:this.m[5]}},multiply:function(a){var b=this.m[0]*a.m[0]+this.m[2]*a.m[1],c=this.m[1]*a.m[0]+this.m[3]*a.m[1],d=this.m[0]*a.m[2]+this.m[2]*a.m[3],e=this.m[1]*a.m[2]+this.m[3]*a.m[3],f=this.m[0]*a.m[4]+this.m[2]*a.m[5]+this.m[4],g=this.m[1]*a.m[4]+this.m[3]*a.m[5]+this.m[5];this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g},invert:function(){var a=1/(this.m[0]*this.m[3]-this.m[1]*this.m[2]),b=this.m[3]*a,c=-this.m[1]*a,d=-this.m[2]*a,e=this.m[0]*a,f=a*(this.m[2]*this.m[5]-this.m[3]*this.m[4]),g=a*(this.m[1]*this.m[4]-this.m[0]*this.m[5]);this.m[0]=b,this.m[1]=c,this.m[2]=d,this.m[3]=e,this.m[4]=f,this.m[5]=g},getMatrix:function(){return this.m}}}(),function(){Kinetic.Collection=function(){var a=[].slice.call(arguments),b=a.length,c=0;for(this.length=b;b>c;c++)this[c]=a[c];return this},Kinetic.Collection.prototype=new Array,Kinetic.Collection.prototype.apply=function(a){args=[].slice.call(arguments),args.shift();for(var b=0;b<this.length;b++)Kinetic.Type._isFunction(this[b][a])&&this[b][a].apply(this[b],args)},Kinetic.Collection.prototype.each=function(a){for(var b=0;b<this.length;b++)a.call(this[b],b,this[b])}}(),function(){Kinetic.Filters.Grayscale=function(a,b){for(var c=a.data,d=0;d<c.length;d+=4){var e=.34*c[d]+.5*c[d+1]+.16*c[d+2];c[d]=e,c[d+1]=e,c[d+2]=e}}}(),function(){Kinetic.Filters.Brighten=function(a,b){for(var c=b.val||0,d=a.data,e=0;e<d.length;e+=4)d[e]+=c,d[e+1]+=c,d[e+2]+=c}}(),function(){Kinetic.Filters.Invert=function(a,b){for(var c=a.data,d=0;d<c.length;d+=4)c[d]=255-c[d],c[d+1]=255-c[d+1],c[d+2]=255-c[d+2]}}(),function(){Kinetic.Node=function(a){this._nodeInit(a)},Kinetic.Node.prototype={_nodeInit:function(a){this._id=Kinetic.Global.idCounter++,this.defaultNodeAttrs={visible:!0,listening:!0,name:void 0,opacity:1,x:0,y:0,scale:{x:1,y:1},rotation:0,offset:{x:0,y:0},draggable:!1,dragOnTop:!0},this.setDefaultAttrs(this.defaultNodeAttrs),this.eventListeners={},this.setAttrs(a)},on:function(a,b){for(var c=a.split(" "),d=c.length,e=0;d>e;e++){var f=c[e],g=f,h=g.split("."),i=h[0],j=h.length>1?h[1]:"";this.eventListeners[i]||(this.eventListeners[i]=[]),this.eventListeners[i].push({name:j,handler:b})}},off:function(a){for(var b=a.split(" "),c=b.length,d=0;c>d;d++){var e=b[d],f=e,g=f.split("."),h=g[0];if(g.length>1)if(h)this.eventListeners[h]&&this._off(h,g[1]);else for(var e in this.eventListeners)this._off(e,g[1]);else delete this.eventListeners[h]}},remove:function(){var a=this.getParent();a&&a.children&&(a.children.splice(this.index,1),a._setChildrenIndices()),delete this.parent},destroy:function(){for(var a=(this.getParent(),this.getStage(),Kinetic.DD),b=Kinetic.Global;this.children&&this.children.length>0;)this.children[0].destroy();b._removeId(this.getId()),b._removeName(this.getName(),this._id),a&&a.node&&a.node._id===this._id&&node._endDrag(),this.trans&&this.trans.stop(),this.remove()},getAttrs:function(){return this.attrs},setDefaultAttrs:function(a){if(void 0===this.attrs&&(this.attrs={}),a)for(var b in a)void 0===this.attrs[b]&&(this.attrs[b]=a[b])},setAttrs:function(a){if(a)for(var b in a){var c="set"+b.charAt(0).toUpperCase()+b.slice(1);Kinetic.Type._isFunction(this[c])?this[c](a[b]):this.setAttr(b,a[b])}},getVisible:function(){var a=this.attrs.visible,b=this.getParent();return a&&b&&!b.getVisible()?!1:a},getListening:function(){var a=this.attrs.listening,b=this.getParent();return a&&b&&!b.getListening()?!1:a},show:function(){this.setVisible(!0)},hide:function(){this.setVisible(!1)},getZIndex:function(){return this.index},getAbsoluteZIndex:function(){function a(e){for(var f=[],g=e.length,h=0;g>h;h++){var i=e[h];d++,"Shape"!==i.nodeType&&(f=f.concat(i.getChildren())),i._id===c._id&&(h=g)}f.length>0&&f[0].getLevel()<=b&&a(f)}var b=this.getLevel(),c=(this.getStage(),this),d=0;return"Stage"!==c.nodeType&&a(c.getStage().getChildren()),d},getLevel:function(){for(var a=0,b=this.parent;b;)a++,b=b.parent;return a},setPosition:function(){var a=Kinetic.Type._getXY([].slice.call(arguments));this.setAttr("x",a.x),this.setAttr("y",a.y)},getPosition:function(){var a=this.attrs;return{x:a.x,y:a.y}},getAbsolutePosition:function(){var a=this.getAbsoluteTransform(),b=this.getOffset();return a.translate(b.x,b.y),a.getTranslation()},setAbsolutePosition:function(){var a=Kinetic.Type._getXY([].slice.call(arguments)),b=this._clearTransform();this.attrs.x=b.x,this.attrs.y=b.y,delete b.x,delete b.y;var c=this.getAbsoluteTransform();c.invert(),c.translate(a.x,a.y),a={x:this.attrs.x+c.getTranslation().x,y:this.attrs.y+c.getTranslation().y},this.setPosition(a.x,a.y),this._setTransform(b)},move:function(){var a=Kinetic.Type._getXY([].slice.call(arguments)),b=this.getX(),c=this.getY();void 0!==a.x&&(b+=a.x),void 0!==a.y&&(c+=a.y),this.setPosition(b,c)},_eachAncestorReverse:function(a,b){var c=[],d=this.getParent();for(b&&c.unshift(this);d;)c.unshift(d),d=d.parent;for(var e=c.length,f=0;e>f;f++)a(c[f])},rotate:function(a){this.setRotation(this.getRotation()+a)},rotateDeg:function(a){this.setRotation(this.getRotation()+Kinetic.Type._degToRad(a))},moveToTop:function(){var a=this.index;return this.parent.children.splice(a,1),this.parent.children.push(this),this.parent._setChildrenIndices(),!0},moveUp:function(){var a=this.index,b=this.parent.getChildren().length;return b-1>a?(this.parent.children.splice(a,1),this.parent.children.splice(a+1,0,this),this.parent._setChildrenIndices(),!0):void 0},moveDown:function(){var a=this.index;return a>0?(this.parent.children.splice(a,1),this.parent.children.splice(a-1,0,this),this.parent._setChildrenIndices(),!0):void 0},moveToBottom:function(){var a=this.index;return a>0?(this.parent.children.splice(a,1),this.parent.children.unshift(this),this.parent._setChildrenIndices(),!0):void 0},setZIndex:function(a){var b=this.index;this.parent.children.splice(b,1),this.parent.children.splice(a,0,this),this.parent._setChildrenIndices()},getAbsoluteOpacity:function(){var a=this.getOpacity();return this.getParent()&&(a*=this.getParent().getAbsoluteOpacity()),a},moveTo:function(a){Kinetic.Node.prototype.remove.call(this),a.add(this)},toObject:function(){var a=Kinetic.Type,b={},c=this.attrs;b.attrs={};for(var d in c){var e=c[d];!(a._isFunction(e)||a._isElement(e)||a._isObject(e)&&a._hasMethods(e)||!(b.attrs[d]=e))}return b.nodeType=this.nodeType,b.shapeType=this.shapeType,b},toJSON:function(){return JSON.stringify(this.toObject())},getParent:function(){return this.parent},getLayer:function(){return this.getParent().getLayer()},getStage:function(){return this.getParent()?this.getParent().getStage():void 0},simulate:function(a,b){this._handleEvent(a,b||{})},fire:function(a,b){this._executeHandlers(a,b||{})},getAbsoluteTransform:function(){var a=new Kinetic.Transform;return this._eachAncestorReverse(function(b){var c=b.getTransform();a.multiply(c)},!0),a},getTransform:function(){var a=new Kinetic.Transform,b=this.attrs,c=b.x,d=b.y,e=b.rotation,f=b.scale,g=f.x,h=f.y,i=b.offset,j=i.x,k=i.y;return(0!==c||0!==d)&&a.translate(c,d),0!==e&&a.rotate(e),(1!==g||1!==h)&&a.scale(g,h),(0!==j||0!==k)&&a.translate(-1*j,-1*k),a},clone:function(a){var b=this.shapeType||this.nodeType,c=new Kinetic[b](this.attrs);for(var d in this.eventListeners)for(var e=this.eventListeners[d],f=e.length,g=0;f>g;g++){var h=e[g];h.name.indexOf("kinetic")<0&&(c.eventListeners[d]||(c.eventListeners[d]=[]),c.eventListeners[d].push(h))}return c.setAttrs(a),c},toDataURL:function(a){a=a||{};var b,c,d=a.mimeType||null,e=a.quality||null,f=a.x||0,g=a.y||0;return a.width&&a.height?b=new Kinetic.SceneCanvas(a.width,a.height,1):(b=this.getStage().bufferCanvas,b.clear()),c=b.getContext(),c.save(),(f||g)&&c.translate(-1*f,-1*g),this.drawScene(b),c.restore(),b.toDataURL(d,e)},toImage:function(a){Kinetic.Type._getImage(this.toDataURL(a),function(b){a.callback(b)})},setSize:function(){var a=Kinetic.Type._getSize(Array.prototype.slice.call(arguments));this.setWidth(a.width),this.setHeight(a.height)},getSize:function(){return{width:this.getWidth(),height:this.getHeight()}},getWidth:function(){return this.attrs.width||0},getHeight:function(){return this.attrs.height||0},_get:function(a){return this.nodeType===a?[this]:[]},_off:function(a,b){for(var c=0;c<this.eventListeners[a].length;c++)if(this.eventListeners[a][c].name===b){if(this.eventListeners[a].splice(c,1),0===this.eventListeners[a].length){delete this.eventListeners[a];break}c--}},_clearTransform:function(){var a=this.attrs,b=a.scale,c=a.offset,d={x:a.x,y:a.y,rotation:a.rotation,scale:{x:b.x,y:b.y},offset:{x:c.x,y:c.y}};return this.attrs.x=0,this.attrs.y=0,this.attrs.rotation=0,this.attrs.scale={x:1,y:1},this.attrs.offset={x:0,y:0},d},_setTransform:function(a){for(var b in a)this.attrs[b]=a[b]},_fireBeforeChangeEvent:function(a,b,c){this._handleEvent("before"+a.toUpperCase()+"Change",{oldVal:b,newVal:c})},_fireChangeEvent:function(a,b,c){this._handleEvent(a+"Change",{oldVal:b,newVal:c})},setId:function(a){var b=this.getId(),c=(this.getStage(),Kinetic.Global);c._removeId(b),c._addId(this,a),this.setAttr("id",a)},setName:function(a){var b=this.getName(),c=(this.getStage(),Kinetic.Global);c._removeName(b,this._id),c._addName(this,a),this.setAttr("name",a)},setAttr:function(a,b){if(void 0!==b){var c=this.attrs[a];this._fireBeforeChangeEvent(a,c,b),this.attrs[a]=b,this._fireChangeEvent(a,c,b)}},_handleEvent:function(a,b,c){b&&"Shape"===this.nodeType&&(b.shape=this);var d=(this.getStage(),this.eventListeners),e=!0;"mouseenter"===a&&c&&this._id===c._id?e=!1:"mouseleave"===a&&c&&this._id===c._id&&(e=!1),e&&(d[a]&&this.fire(a,b),b&&!b.cancelBubble&&this.parent&&(c&&c.parent?this._handleEvent.call(this.parent,a,b,c.parent):this._handleEvent.call(this.parent,a,b)))},_executeHandlers:function(a,b){for(var c=this.eventListeners[a],d=c.length,e=0;d>e;e++)c[e].handler.apply(this,[b])}},Kinetic.Node.addSetters=function(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d];this._addSetter(a,e)}},Kinetic.Node.addPointSetters=function(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d];this._addPointSetter(a,e)}},Kinetic.Node.addRotationSetters=function(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d];this._addRotationSetter(a,e)}},Kinetic.Node.addGetters=function(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d];this._addGetter(a,e)}},Kinetic.Node.addRotationGetters=function(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d];this._addRotationGetter(a,e)}},Kinetic.Node.addGettersSetters=function(a,b){this.addSetters(a,b),this.addGetters(a,b)},Kinetic.Node.addPointGettersSetters=function(a,b){this.addPointSetters(a,b),this.addGetters(a,b)},Kinetic.Node.addRotationGettersSetters=function(a,b){this.addRotationSetters(a,b),this.addRotationGetters(a,b)},Kinetic.Node._addSetter=function(a,b){var c="set"+b.charAt(0).toUpperCase()+b.slice(1);a.prototype[c]=function(a){this.setAttr(b,a)}},Kinetic.Node._addPointSetter=function(a,b){var c="set"+b.charAt(0).toUpperCase()+b.slice(1);a.prototype[c]=function(){var a=Kinetic.Type._getXY([].slice.call(arguments));a&&void 0===a.x&&(a.x=this.attrs[b].x),a&&void 0===a.y&&(a.y=this.attrs[b].y),this.setAttr(b,a)}},Kinetic.Node._addRotationSetter=function(a,b){var c="set"+b.charAt(0).toUpperCase()+b.slice(1);a.prototype[c]=function(a){this.setAttr(b,a)},a.prototype[c+"Deg"]=function(a){this.setAttr(b,Kinetic.Type._degToRad(a))}},Kinetic.Node._addGetter=function(a,b){var c="get"+b.charAt(0).toUpperCase()+b.slice(1);a.prototype[c]=function(a){return this.attrs[b]}},Kinetic.Node._addRotationGetter=function(a,b){var c="get"+b.charAt(0).toUpperCase()+b.slice(1);a.prototype[c]=function(){return this.attrs[b]},a.prototype[c+"Deg"]=function(){return Kinetic.Type._radToDeg(this.attrs[b])}},Kinetic.Node.create=function(a,b){return this._createNode(JSON.parse(a),b)},Kinetic.Node._createNode=function(a,b){var c;c="Shape"===a.nodeType?void 0===a.shapeType?"Shape":a.shapeType:a.nodeType,b&&(a.attrs.container=b);var d=new Kinetic[c](a.attrs);if(a.children)for(var e=a.children.length,f=0;e>f;f++)d.add(this._createNode(a.children[f]));return d},Kinetic.Node.addGettersSetters(Kinetic.Node,["x","y","opacity"]),Kinetic.Node.addGetters(Kinetic.Node,["name","id"]),Kinetic.Node.addRotationGettersSetters(Kinetic.Node,["rotation"]),Kinetic.Node.addPointGettersSetters(Kinetic.Node,["scale","offset"]),Kinetic.Node.addSetters(Kinetic.Node,["width","height","listening","visible"]),Kinetic.Node.prototype.isListening=Kinetic.Node.prototype.getListening,Kinetic.Node.prototype.isVisible=Kinetic.Node.prototype.getVisible;for(var a=["on","off"],b=0;2>b;b++)(function(b){var c=a[b];Kinetic.Collection.prototype[c]=function(){var a=[].slice.call(arguments);a.unshift(c),this.apply.apply(this,a)}})(b)}(),function(){Kinetic.Animation=function(a,b){this.func=a,this.node=b,this.id=Kinetic.Animation.animIdCounter++,this.frame={time:0,timeDiff:0,lastTime:(new Date).getTime()}},Kinetic.Animation.prototype={isRunning:function(){for(var a=Kinetic.Animation,b=a.animations,c=0;c<b.length;c++)if(b[c].id===this.id)return!0;return!1},start:function(){this.stop(),this.frame.timeDiff=0,this.frame.lastTime=(new Date).getTime(),Kinetic.Animation._addAnimation(this)},stop:function(){Kinetic.Animation._removeAnimation(this)},_updateFrameObject:function(a){this.frame.timeDiff=a-this.frame.lastTime,this.frame.lastTime=a,this.frame.time+=this.frame.timeDiff,this.frame.frameRate=1e3/this.frame.timeDiff}},Kinetic.Animation.animations=[],Kinetic.Animation.animIdCounter=0,Kinetic.Animation.animRunning=!1,Kinetic.Animation.fixedRequestAnimFrame=function(a){window.setTimeout(a,1e3/60)},Kinetic.Animation._addAnimation=function(a){this.animations.push(a),this._handleAnimation()},Kinetic.Animation._removeAnimation=function(a){for(var b=a.id,c=this.animations,d=c.length,e=0;d>e;e++)if(c[e].id===b){this.animations.splice(e,1);break}},Kinetic.Animation._runFrames=function(){for(var a={},b=this.animations,c=0;c<b.length;c++){var d=b[c],e=d.node,f=d.func;d._updateFrameObject((new Date).getTime()),e&&void 0!==e._id&&(a[e._id]=e),f&&f(d.frame)}for(var g in a)a[g].draw()},Kinetic.Animation._animationLoop=function(){var a=this;this.animations.length>0?(this._runFrames(),Kinetic.Animation.requestAnimFrame(function(){a._animationLoop()})):this.animRunning=!1},Kinetic.Animation._handleAnimation=function(){var a=this;this.animRunning||(this.animRunning=!0,a._animationLoop())},RAF=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||Kinetic.Animation.fixedRequestAnimFrame}(),Kinetic.Animation.requestAnimFrame=function(a){var b=Kinetic.DD&&Kinetic.DD.moving?this.fixedRequestAnimFrame:RAF;b(a)};var a=Kinetic.Node.prototype.moveTo;Kinetic.Node.prototype.moveTo=function(b){a.call(this,b)}}(),function(){Kinetic.DD={anim:new Kinetic.Animation,moving:!1,offset:{x:0,y:0}},Kinetic.getNodeDragging=function(){return Kinetic.DD.node},Kinetic.DD._setupDragLayerAndGetContainer=function(a){var b,c,d=a.getStage();a.nodeType;return a._eachAncestorReverse(function(a){"Layer"===a.nodeType?(d.dragLayer.setAttrs(a.getAttrs()),b=d.dragLayer,d.add(d.dragLayer)):"Group"===a.nodeType&&(c=new Kinetic.Group(a.getAttrs()),b.add(c),b=c)}),b},Kinetic.DD._initDragLayer=function(a){a.dragLayer=new Kinetic.Layer,a.dragLayer.getCanvas().getElement().className="kinetic-drag-and-drop-layer"},Kinetic.DD._drag=function(a){var b=Kinetic.DD,c=b.node;if(c){var d=c.getStage().getUserPosition(),e=c.attrs.dragBoundFunc,f={x:d.x-b.offset.x,y:d.y-b.offset.y};void 0!==e&&(f=e.call(c,f,a)),c.setAbsolutePosition(f),b.moving||(b.moving=!0,c.setListening(!1),c._handleEvent("dragstart",a)),c._handleEvent("dragmove",a)}},Kinetic.DD._endDrag=function(a){var b=Kinetic.DD,c=b.node;if(c){var d=c.nodeType;c.getStage();c.setListening(!0),"Stage"===d?c.draw():(("Group"===d||"Shape"===d)&&c.getDragOnTop()&&b.prevParent&&(c.moveTo(b.prevParent),c.getStage().dragLayer.remove(),b.prevParent=null),c.getLayer().draw()),delete b.node,b.anim.stop(),b.moving&&(b.moving=!1,c._handleEvent("dragend",a))}},Kinetic.Node.prototype._startDrag=function(a){var b=Kinetic.DD,c=this,d=this.getStage(),e=d.getUserPosition();if(e){var f,g=(this.getTransform().getTranslation(),this.getAbsolutePosition()),h=this.nodeType;b.node=this,b.offset.x=e.x-g.x,b.offset.y=e.y-g.y,"Stage"===h||"Layer"===h?(b.anim.node=this,b.anim.start()):this.getDragOnTop()?(f=b._setupDragLayerAndGetContainer(this),b.anim.node=d.dragLayer,b.prevParent=this.getParent(),setTimeout(function(){b.node&&(c.moveTo(f),b.prevParent.getLayer().draw(),d.dragLayer.draw(),b.anim.start())},0)):(b.anim.node=this.getLayer(),b.anim.start())}},Kinetic.Node.prototype.setDraggable=function(a){this.setAttr("draggable",a),this._dragChange()},Kinetic.Node.prototype.getDraggable=function(){return this.attrs.draggable},Kinetic.Node.prototype.isDragging=function(){var a=Kinetic.DD;return a.node&&a.node._id===this._id&&a.moving},Kinetic.Node.prototype._listenDrag=function(){this._dragCleanup();var a=this;this.on("mousedown.kinetic touchstart.kinetic",function(b){Kinetic.getNodeDragging()||a._startDrag(b)})},Kinetic.Node.prototype._dragChange=function(){if(this.attrs.draggable)this._listenDrag();else{this._dragCleanup();var a=this.getStage(),b=Kinetic.DD;a&&b.node&&b.node._id===this._id&&b._endDrag()}},Kinetic.Node.prototype._dragCleanup=function(){this.off("mousedown.kinetic"),this.off("touchstart.kinetic")},Kinetic.Node.prototype.isDraggable=Kinetic.Node.prototype.getDraggable,Kinetic.Node.addGettersSetters(Kinetic.Node,["dragBoundFunc","dragOnTop"]);var a=document.getElementsByTagName("html")[0];a.addEventListener("mouseup",Kinetic.DD._endDrag,!0),a.addEventListener("touchend",Kinetic.DD._endDrag,!0)}(),function(){Kinetic.Transition=function(a,b){function c(a,b,e,f){for(var g in a)"duration"!==g&&"easing"!==g&&"callback"!==g&&(Kinetic.Type._isObject(a[g])?(e[g]={},c(a[g],b[g],e[g],f)):d._add(d._getTween(b,g,a[g],e,f)))}var d=this,e={};this.node=a,this.config=b,this.tweens=[],c(b,a.attrs,e,e),this.tweens[0].onStarted=function(){},this.tweens[0].onStopped=function(){a.transAnim.stop()},this.tweens[0].onResumed=function(){a.transAnim.start()},this.tweens[0].onLooped=function(){},this.tweens[0].onChanged=function(){},this.tweens[0].onFinished=function(){var c={};for(var d in b)"duration"!==d&&"easing"!==d&&"callback"!==d&&(c[d]=b[d]);a.transAnim.stop(),a.setAttrs(c),b.callback&&b.callback()}},Kinetic.Transition.prototype={start:function(){for(var a=0;a<this.tweens.length;a++)this.tweens[a].start()},stop:function(){for(var a=0;a<this.tweens.length;a++)this.tweens[a].stop()},resume:function(){for(var a=0;a<this.tweens.length;a++)this.tweens[a].resume()},_onEnterFrame:function(){for(var a=0;a<this.tweens.length;a++)this.tweens[a].onEnterFrame()},_add:function(a){this.tweens.push(a)},_getTween:function(a,b,c,d,e){var f=this.config,g=this.node,h=f.easing;void 0===h&&(h="linear");var i=new Kinetic.Tween(g,function(a){d[b]=a,g.setAttrs(e)},Kinetic.Tweens[h],a[b],c,f.duration);return i}},Kinetic.Node.prototype.transitionTo=function(a){var b=new Kinetic.Transition(this,a);return this.transAnim||(this.transAnim=new Kinetic.Animation),this.transAnim.func=function(){b._onEnterFrame()},this.transAnim.node="Stage"===this.nodeType?this:this.getLayer(),b.start(),this.transAnim.start(),
this.trans=b,b}}(),function(){Kinetic.Container=function(a){this._containerInit(a)},Kinetic.Container.prototype={_containerInit:function(a){this.children=[],Kinetic.Node.call(this,a)},getChildren:function(){return this.children},removeChildren:function(){for(;this.children.length>0;)this.children[0].remove()},add:function(a){var b=(Kinetic.Global,this.children);return a.index=b.length,a.parent=this,b.push(a),this},get:function(a){var b=new Kinetic.Collection;if("#"===a.charAt(0)){var c=this._getNodeById(a.slice(1));c&&b.push(c)}else if("."===a.charAt(0)){var d=this._getNodesByName(a.slice(1));Kinetic.Collection.apply(b,d)}else{for(var e=[],f=this.getChildren(),g=f.length,h=0;g>h;h++)e=e.concat(f[h]._get(a));Kinetic.Collection.apply(b,e)}return b},_getNodeById:function(a){var b=(this.getStage(),Kinetic.Global),c=b.ids[a];return void 0!==c&&this.isAncestorOf(c)?c:null},_getNodesByName:function(a){var b=Kinetic.Global,c=b.names[a]||[];return this._getDescendants(c)},_get:function(a){for(var b=Kinetic.Node.prototype._get.call(this,a),c=this.getChildren(),d=c.length,e=0;d>e;e++)b=b.concat(c[e]._get(a));return b},toObject:function(){var a=Kinetic.Node.prototype.toObject.call(this);a.children=[];for(var b=this.getChildren(),c=b.length,d=0;c>d;d++){var e=b[d];a.children.push(e.toObject())}return a},_getDescendants:function(a){for(var b=[],c=a.length,d=0;c>d;d++){var e=a[d];this.isAncestorOf(e)&&b.push(e)}return b},isAncestorOf:function(a){for(var b=a.getParent();b;){if(b._id===this._id)return!0;b=b.getParent()}return!1},clone:function(a){var b=Kinetic.Node.prototype.clone.call(this,a);for(var c in this.children)b.add(this.children[c].clone());return b},getIntersections:function(){for(var a=Kinetic.Type._getXY(Array.prototype.slice.call(arguments)),b=[],c=this.get("Shape"),d=c.length,e=0;d>e;e++){var f=c[e];f.isVisible()&&f.intersects(a)&&b.push(f)}return b},_setChildrenIndices:function(){for(var a=this.children,b=a.length,c=0;b>c;c++)a[c].index=c},draw:function(){this.drawScene(),this.drawHit()},drawScene:function(a){if(this.isVisible())for(var b=this.children,c=b.length,d=0;c>d;d++)b[d].drawScene(a)},drawHit:function(){if(this.isVisible()&&this.isListening())for(var a=this.children,b=a.length,c=0;b>c;c++)a[c].drawHit()}},Kinetic.Global.extend(Kinetic.Container,Kinetic.Node)}(),function(){function a(a){a.fill()}function b(a){a.stroke()}function c(a){a.fill()}function d(a){a.stroke()}Kinetic.Shape=function(a){this._initShape(a)},Kinetic.Shape.prototype={_initShape:function(e){this.setDefaultAttrs({fillEnabled:!0,strokeEnabled:!0,shadowEnabled:!0,dashArrayEnabled:!0,fillPriority:"color"}),this.nodeType="Shape",this._fillFunc=a,this._strokeFunc=b,this._fillFuncHit=c,this._strokeFuncHit=d;for(var f,g=Kinetic.Global.shapes;f=Kinetic.Type._getRandomColorKey(),!f||f in g;);this.colorKey=f,g[f]=this,Kinetic.Node.call(this,e)},getContext:function(){return this.getLayer().getContext()},getCanvas:function(){return this.getLayer().getCanvas()},hasShadow:function(){return!!(this.getShadowColor()||this.getShadowBlur()||this.getShadowOffset())},hasFill:function(){return!!(this.getFill()||this.getFillPatternImage()||this.getFillLinearGradientStartPoint()||this.getFillRadialGradientStartPoint())},_get:function(a){return this.nodeType===a||this.shapeType===a?[this]:[]},intersects:function(){var a=Kinetic.Type._getXY(Array.prototype.slice.call(arguments)),b=this.getStage(),c=b.hitCanvas;c.clear(),this.drawScene(c);var d=c.context.getImageData(Math.round(a.x),Math.round(a.y),1,1).data;return d[3]>0},enableFill:function(){this.setAttr("fillEnabled",!0)},disableFill:function(){this.setAttr("fillEnabled",!1)},enableStroke:function(){this.setAttr("strokeEnabled",!0)},disableStroke:function(){this.setAttr("strokeEnabled",!1)},enableShadow:function(){this.setAttr("shadowEnabled",!0)},disableShadow:function(){this.setAttr("shadowEnabled",!1)},enableDashArray:function(){this.setAttr("dashArrayEnabled",!0)},disableDashArray:function(){this.setAttr("dashArrayEnabled",!1)},remove:function(){Kinetic.Node.prototype.remove.call(this),delete Kinetic.Global.shapes[this.colorKey]},drawScene:function(a){var b=this.attrs,c=b.drawFunc,a=a||this.getLayer().getCanvas(),d=a.getContext();c&&this.isVisible()&&(d.save(),a._applyOpacity(this),a._applyLineJoin(this),a._applyAncestorTransforms(this),c.call(this,a),d.restore())},drawHit:function(){var a=this.attrs,b=a.drawHitFunc||a.drawFunc,c=this.getLayer().hitCanvas,d=c.getContext();b&&this.isVisible()&&this.isListening()&&(d.save(),c._applyLineJoin(this),c._applyAncestorTransforms(this),b.call(this,c),d.restore())},_setDrawFuncs:function(){!this.attrs.drawFunc&&this.drawFunc&&this.setDrawFunc(this.drawFunc),!this.attrs.drawHitFunc&&this.drawHitFunc&&this.setDrawHitFunc(this.drawHitFunc)}},Kinetic.Global.extend(Kinetic.Shape,Kinetic.Node),Kinetic.Node.addGettersSetters(Kinetic.Shape,["stroke","lineJoin","lineCap","strokeWidth","drawFunc","drawHitFunc","dashArray","shadowColor","shadowBlur","shadowOpacity","fillPatternImage","fill","fillPatternX","fillPatternY","fillLinearGradientColorStops","fillRadialGradientStartRadius","fillRadialGradientEndRadius","fillRadialGradientColorStops","fillPatternRepeat","fillEnabled","strokeEnabled","shadowEnabled","dashArrayEnabled","fillPriority"]),Kinetic.Node.addPointGettersSetters(Kinetic.Shape,["fillPatternOffset","fillPatternScale","fillLinearGradientStartPoint","fillLinearGradientEndPoint","fillRadialGradientStartPoint","fillRadialGradientEndPoint","shadowOffset"]),Kinetic.Node.addRotationGettersSetters(Kinetic.Shape,["fillPatternRotation"])}(),function(){Kinetic.Stage=function(a){this._initStage(a)},Kinetic.Stage.prototype={_initStage:function(a){var b=Kinetic.DD;this.setDefaultAttrs({width:400,height:200}),Kinetic.Container.call(this,a),this._setStageDefaultProperties(),this._id=Kinetic.Global.idCounter++,this._buildDOM(),this._bindContentEvents(),Kinetic.Global.stages.push(this),b&&b._initDragLayer(this)},setContainer:function(a){"string"==typeof a&&(a=document.getElementById(a)),this.setAttr("container",a)},setHeight:function(a){Kinetic.Node.prototype.setHeight.call(this,a),this._resizeDOM()},setWidth:function(a){Kinetic.Node.prototype.setWidth.call(this,a),this._resizeDOM()},clear:function(){for(var a=this.children,b=0;b<a.length;b++)a[b].clear()},remove:function(){var a=this.content;Kinetic.Node.prototype.remove.call(this),a&&Kinetic.Type._isInDocument(a)&&this.attrs.container.removeChild(a)},reset:function(){this.removeChildren(),this._setStageDefaultProperties(),this.setAttrs(this.defaultNodeAttrs)},getMousePosition:function(){return this.mousePos},getTouchPosition:function(){return this.touchPos},getUserPosition:function(){return this.getTouchPosition()||this.getMousePosition()},getStage:function(){return this},getContent:function(){return this.content},toDataURL:function(a){function b(e){var f=i[e],j=f.toDataURL(),k=new Image;k.onload=function(){h.drawImage(k,0,0),e<i.length-1?b(e+1):a.callback(g.toDataURL(c,d))},k.src=j}a=a||{};var c=a.mimeType||null,d=a.quality||null,e=a.x||0,f=a.y||0,g=new Kinetic.SceneCanvas(a.width||this.getWidth(),a.height||this.getHeight()),h=g.getContext(),i=this.children;(e||f)&&h.translate(-1*e,-1*f),b(0)},toImage:function(a){var b=a.callback;a.callback=function(a){Kinetic.Type._getImage(a,function(a){b(a)})},this.toDataURL(a)},getIntersection:function(a){for(var b,c=this.getChildren(),d=c.length-1;d>=0;d--){var e=c[d];if(e.isVisible()&&e.isListening()){var f=e.hitCanvas.context.getImageData(Math.round(a.x),Math.round(a.y),1,1).data;if(255===f[3]){var g=Kinetic.Type._rgbToHex(f[0],f[1],f[2]);return b=Kinetic.Global.shapes[g],{shape:b,pixel:f}}if(f[0]>0||f[1]>0||f[2]>0||f[3]>0)return{pixel:f}}}return null},_resizeDOM:function(){if(this.content){var a=this.attrs.width,b=this.attrs.height;this.content.style.width=a+"px",this.content.style.height=b+"px",this.bufferCanvas.setSize(a,b,1),this.hitCanvas.setSize(a,b);for(var c=this.children,d=0;d<c.length;d++){var e=c[d];e.getCanvas().setSize(a,b),e.hitCanvas.setSize(a,b),e.draw()}}},add:function(a){return Kinetic.Container.prototype.add.call(this,a),a.canvas.setSize(this.attrs.width,this.attrs.height),a.hitCanvas.setSize(this.attrs.width,this.attrs.height),a.draw(),this.content.appendChild(a.canvas.element),this},getDragLayer:function(){return this.dragLayer},_setUserPosition:function(a){a||(a=window.event),this._setMousePosition(a),this._setTouchPosition(a)},_bindContentEvents:function(){for(var a=(Kinetic.Global,this),b=["mousedown","mousemove","mouseup","mouseout","touchstart","touchmove","touchend"],c=0;c<b.length;c++){var d=b[c];!function(){var b=d;a.content.addEventListener(b,function(c){a["_"+b](c)},!1)}()}},_mouseout:function(a){this._setUserPosition(a);var b=Kinetic.DD,c=this.targetShape;c&&(!b||!b.moving)&&(c._handleEvent("mouseout",a),c._handleEvent("mouseleave",a),this.targetShape=null),this.mousePos=void 0},_mousemove:function(a){this._setUserPosition(a);var b=Kinetic.DD,c=this.getIntersection(this.getUserPosition());if(c){var d=c.shape;d&&(b&&b.moving||255!==c.pixel[3]||this.targetShape&&this.targetShape._id===d._id?d._handleEvent("mousemove",a):(this.targetShape&&(this.targetShape._handleEvent("mouseout",a,d),this.targetShape._handleEvent("mouseleave",a,d)),d._handleEvent("mouseover",a,this.targetShape),d._handleEvent("mouseenter",a,this.targetShape),this.targetShape=d))}else this.targetShape&&(!b||!b.moving)&&(this.targetShape._handleEvent("mouseout",a),this.targetShape._handleEvent("mouseleave",a),this.targetShape=null);b&&b._drag(a)},_mousedown:function(a){var b,c=Kinetic.DD;if(this._setUserPosition(a),b=this.getIntersection(this.getUserPosition()),b&&b.shape){var d=b.shape;this.clickStart=!0,d._handleEvent("mousedown",a)}c&&this.attrs.draggable&&!c.node&&this._startDrag(a)},_mouseup:function(a){this._setUserPosition(a);var b=this,c=Kinetic.DD,d=this.getIntersection(this.getUserPosition());if(d&&d.shape){var e=d.shape;e._handleEvent("mouseup",a),this.clickStart&&(!c||!c.moving||!c.node)&&(e._handleEvent("click",a),this.inDoubleClickWindow&&e._handleEvent("dblclick",a),this.inDoubleClickWindow=!0,setTimeout(function(){b.inDoubleClickWindow=!1},this.dblClickWindow))}this.clickStart=!1},_touchstart:function(a){var b,c=Kinetic.DD;if(this._setUserPosition(a),a.preventDefault(),b=this.getIntersection(this.getUserPosition()),b&&b.shape){var d=b.shape;this.tapStart=!0,d._handleEvent("touchstart",a)}c&&this.attrs.draggable&&!c.node&&this._startDrag(a)},_touchend:function(a){this._setUserPosition(a);var b=this,c=Kinetic.DD,d=this.getIntersection(this.getUserPosition());if(d&&d.shape){var e=d.shape;e._handleEvent("touchend",a),this.tapStart&&(!c||!c.moving||!c.node)&&(e._handleEvent("tap",a),this.inDoubleClickWindow&&e._handleEvent("dbltap",a),this.inDoubleClickWindow=!0,setTimeout(function(){b.inDoubleClickWindow=!1},this.dblClickWindow))}this.tapStart=!1},_touchmove:function(a){this._setUserPosition(a);var b=Kinetic.DD;a.preventDefault();var c=this.getIntersection(this.getUserPosition());if(c&&c.shape){var d=c.shape;d._handleEvent("touchmove",a)}b&&b._drag(a)},_setMousePosition:function(a){var b=a.clientX-this._getContentPosition().left,c=a.clientY-this._getContentPosition().top;this.mousePos={x:b,y:c}},_setTouchPosition:function(a){if(void 0!==a.touches&&1===a.touches.length){var b=a.touches[0],c=b.clientX-this._getContentPosition().left,d=b.clientY-this._getContentPosition().top;this.touchPos={x:c,y:d}}},_getContentPosition:function(){var a=this.content.getBoundingClientRect();return{top:a.top,left:a.left}},_buildDOM:function(){this.content=document.createElement("div"),this.content.style.position="relative",this.content.style.display="inline-block",this.content.className="kineticjs-content",this.attrs.container.appendChild(this.content),this.bufferCanvas=new Kinetic.SceneCanvas,this.hitCanvas=new Kinetic.HitCanvas,this._resizeDOM()},_onContent:function(a,b){for(var c=a.split(" "),d=0;d<c.length;d++){var e=c[d];this.content.addEventListener(e,b,!1)}},_setStageDefaultProperties:function(){this.nodeType="Stage",this.dblClickWindow=400,this.targetShape=null,this.mousePos=void 0,this.clickStart=!1,this.touchPos=void 0,this.tapStart=!1}},Kinetic.Global.extend(Kinetic.Stage,Kinetic.Container),Kinetic.Node.addGetters(Kinetic.Stage,["container"])}(),function(){Kinetic.Layer=function(a){this._initLayer(a)},Kinetic.Layer.prototype={_initLayer:function(a){this.setDefaultAttrs({clearBeforeDraw:!0}),this.nodeType="Layer",this.beforeDrawFunc=void 0,this.afterDrawFunc=void 0,this.canvas=new Kinetic.SceneCanvas,this.canvas.getElement().style.position="absolute",this.hitCanvas=new Kinetic.HitCanvas,Kinetic.Container.call(this,a)},draw:function(){this.getContext();void 0!==this.beforeDrawFunc&&this.beforeDrawFunc.call(this),Kinetic.Container.prototype.draw.call(this),void 0!==this.afterDrawFunc&&this.afterDrawFunc.call(this)},drawHit:function(){this.hitCanvas.clear(),Kinetic.Container.prototype.drawHit.call(this)},drawScene:function(a){a=a||this.getCanvas(),this.attrs.clearBeforeDraw&&a.clear(),Kinetic.Container.prototype.drawScene.call(this,a)},toDataURL:function(a){a=a||{};var b=a.mimeType||null,c=a.quality||null;a.x||0,a.y||0;return a.width||a.height||a.x||a.y?Kinetic.Node.prototype.toDataURL.call(this,a):this.getCanvas().toDataURL(b,c)},beforeDraw:function(a){this.beforeDrawFunc=a},afterDraw:function(a){this.afterDrawFunc=a},getCanvas:function(){return this.canvas},getContext:function(){return this.canvas.context},clear:function(){this.getCanvas().clear()},setVisible:function(a){Kinetic.Node.prototype.setVisible.call(this,a),a?(this.canvas.element.style.display="block",this.hitCanvas.element.style.display="block"):(this.canvas.element.style.display="none",this.hitCanvas.element.style.display="none")},setZIndex:function(a){Kinetic.Node.prototype.setZIndex.call(this,a);var b=this.getStage();b&&(b.content.removeChild(this.canvas.element),a<b.getChildren().length-1?b.content.insertBefore(this.canvas.element,b.getChildren()[a+1].canvas.element):b.content.appendChild(this.canvas.element))},moveToTop:function(){Kinetic.Node.prototype.moveToTop.call(this);var a=this.getStage();a&&(a.content.removeChild(this.canvas.element),a.content.appendChild(this.canvas.element))},moveUp:function(){if(Kinetic.Node.prototype.moveUp.call(this)){var a=this.getStage();a&&(a.content.removeChild(this.canvas.element),this.index<a.getChildren().length-1?a.content.insertBefore(this.canvas.element,a.getChildren()[this.index+1].canvas.element):a.content.appendChild(this.canvas.element))}},moveDown:function(){if(Kinetic.Node.prototype.moveDown.call(this)){var a=this.getStage();if(a){var b=a.getChildren();a.content.removeChild(this.canvas.element),a.content.insertBefore(this.canvas.element,b[this.index+1].canvas.element)}}},moveToBottom:function(){if(Kinetic.Node.prototype.moveToBottom.call(this)){var a=this.getStage();if(a){var b=a.getChildren();a.content.removeChild(this.canvas.element),a.content.insertBefore(this.canvas.element,b[1].canvas.element)}}},getLayer:function(){return this},remove:function(){var a=this.getStage(),b=this.canvas,c=b.element;Kinetic.Node.prototype.remove.call(this),a&&b&&Kinetic.Type._isInDocument(c)&&a.content.removeChild(c)}},Kinetic.Global.extend(Kinetic.Layer,Kinetic.Container),Kinetic.Node.addGettersSetters(Kinetic.Layer,["clearBeforeDraw"])}(),function(){Kinetic.Group=function(a){this._initGroup(a)},Kinetic.Group.prototype={_initGroup:function(a){this.nodeType="Group",Kinetic.Container.call(this,a)}},Kinetic.Global.extend(Kinetic.Group,Kinetic.Container)}(),function(){Kinetic.Rect=function(a){this._initRect(a)},Kinetic.Rect.prototype={_initRect:function(a){this.setDefaultAttrs({width:0,height:0,cornerRadius:0}),Kinetic.Shape.call(this,a),this.shapeType="Rect",this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext();b.beginPath();var c=this.getCornerRadius(),d=this.getWidth(),e=this.getHeight();0===c?b.rect(0,0,d,e):(b.moveTo(c,0),b.lineTo(d-c,0),b.arc(d-c,c,c,3*Math.PI/2,0,!1),b.lineTo(d,e-c),b.arc(d-c,e-c,c,0,Math.PI/2,!1),b.lineTo(c,e),b.arc(c,e-c,c,Math.PI/2,Math.PI,!1),b.lineTo(0,c),b.arc(c,c,c,Math.PI,3*Math.PI/2,!1)),b.closePath(),a.fillStroke(this)}},Kinetic.Global.extend(Kinetic.Rect,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.Rect,["cornerRadius"])}(),function(){Kinetic.Circle=function(a){this._initCircle(a)},Kinetic.Circle.prototype={_initCircle:function(a){this.setDefaultAttrs({radius:0}),Kinetic.Shape.call(this,a),this.shapeType="Circle",this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext();b.beginPath(),b.arc(0,0,this.getRadius(),0,2*Math.PI,!0),b.closePath(),a.fillStroke(this)},getWidth:function(){return 2*this.getRadius()},getHeight:function(){return 2*this.getRadius()},setWidth:function(a){Kinetic.Node.prototype.setWidth.call(this,a),this.setRadius(a/2)},setHeight:function(a){Kinetic.Node.prototype.setHeight.call(this,a),this.setRadius(a/2)}},Kinetic.Global.extend(Kinetic.Circle,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.Circle,["radius"])}(),function(){Kinetic.Wedge=function(a){this._initWedge(a)},Kinetic.Wedge.prototype={_initWedge:function(a){this.setDefaultAttrs({radius:0,angle:0,clockwise:!1}),Kinetic.Shape.call(this,a),this.shapeType="Wedge",this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext();b.beginPath(),b.arc(0,0,this.getRadius(),0,this.getAngle(),this.getClockwise()),b.lineTo(0,0),b.closePath(),a.fillStroke(this)},setAngleDeg:function(a){this.setAngle(Kinetic.Type._degToRad(a))},getAngleDeg:function(){return Kinetic.Type._radToDeg(this.getAngle())}},Kinetic.Global.extend(Kinetic.Wedge,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.Wedge,["radius","angle","clockwise"])}(),function(){Kinetic.Ellipse=function(a){this._initEllipse(a)},Kinetic.Ellipse.prototype={_initEllipse:function(a){this.setDefaultAttrs({radius:{x:0,y:0}}),Kinetic.Shape.call(this,a),this.shapeType="Ellipse",this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext(),c=this.getRadius();b.beginPath(),b.save(),c.x!==c.y&&b.scale(1,c.y/c.x),b.arc(0,0,c.x,0,2*Math.PI,!0),b.restore(),b.closePath(),a.fillStroke(this)},getWidth:function(){return 2*this.getRadius().x},getHeight:function(){return 2*this.getRadius().y},setWidth:function(a){Kinetic.Node.prototype.setWidth.call(this,a),this.setRadius({x:a/2})},setHeight:function(a){Kinetic.Node.prototype.setHeight.call(this,a),this.setRadius({y:a/2})}},Kinetic.Global.extend(Kinetic.Ellipse,Kinetic.Shape),Kinetic.Node.addPointGettersSetters(Kinetic.Ellipse,["radius"])}(),function(){Kinetic.Image=function(a){this._initImage(a)},Kinetic.Image.prototype={_initImage:function(a){Kinetic.Shape.call(this,a),this.shapeType="Image",this._setDrawFuncs();var b=this;this.on("imageChange",function(a){b._syncSize()}),this._syncSize()},drawFunc:function(a){var b,c=this.getWidth(),d=this.getHeight(),e=this,f=a.getContext();if(f.beginPath(),f.rect(0,0,c,d),f.closePath(),a.fillStroke(this),this.attrs.image){if(this.attrs.crop&&this.attrs.crop.width&&this.attrs.crop.height){var g=this.attrs.crop.x||0,h=this.attrs.crop.y||0,i=this.attrs.crop.width,j=this.attrs.crop.height;b=[this.attrs.image,g,h,i,j,0,0,c,d]}else b=[this.attrs.image,0,0,c,d];this.hasShadow()?a.applyShadow(this,function(){e._drawImage(f,b)}):this._drawImage(f,b)}},drawHitFunc:function(a){var b=this.getWidth(),c=this.getHeight(),d=this.imageHitRegion,e=a.getContext();d?(e.drawImage(d,0,0,b,c),e.beginPath(),e.rect(0,0,b,c),e.closePath(),a.stroke(this)):(e.beginPath(),e.rect(0,0,b,c),e.closePath(),a.fillStroke(this))},applyFilter:function(a,b,c){var d=new Kinetic.Canvas(this.attrs.image.width,this.attrs.image.height),e=d.getContext();e.drawImage(this.attrs.image,0,0);try{var f=e.getImageData(0,0,d.getWidth(),d.getHeight());a(f,b);var g=this;Kinetic.Type._getImage(f,function(a){g.setImage(a),c&&c()})}catch(h){Kinetic.Global.warn("Unable to apply filter. "+h.message)}},setCrop:function(){var a=[].slice.call(arguments),b=Kinetic.Type._getXY(a),c=Kinetic.Type._getSize(a),d=Kinetic.Type._merge(b,c);this.setAttr("crop",Kinetic.Type._merge(d,this.getCrop()))},createImageHitRegion:function(a){var b=new Kinetic.Canvas(this.attrs.width,this.attrs.height),c=b.getContext();c.drawImage(this.attrs.image,0,0);try{for(var d=c.getImageData(0,0,b.getWidth(),b.getHeight()),e=d.data,f=Kinetic.Type._hexToRgb(this.colorKey),g=0,h=e.length;h>g;g+=4)e[g]=f.r,e[g+1]=f.g,e[g+2]=f.b;var i=this;Kinetic.Type._getImage(d,function(b){i.imageHitRegion=b,a&&a()})}catch(j){Kinetic.Global.warn("Unable to create image hit region. "+j.message)}},clearImageHitRegion:function(){delete this.imageHitRegion},_syncSize:function(){this.attrs.image&&(this.attrs.width||this.setWidth(this.attrs.image.width),this.attrs.height||this.setHeight(this.attrs.image.height))},_drawImage:function(a,b){5===b.length?a.drawImage(b[0],b[1],b[2],b[3],b[4]):9===b.length&&a.drawImage(b[0],b[1],b[2],b[3],b[4],b[5],b[6],b[7],b[8])}},Kinetic.Global.extend(Kinetic.Image,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.Image,["image"]),Kinetic.Node.addGetters(Kinetic.Image,["crop"])}(),function(){Kinetic.Polygon=function(a){this._initPolygon(a)},Kinetic.Polygon.prototype={_initPolygon:function(a){this.setDefaultAttrs({points:[]}),Kinetic.Shape.call(this,a),this.shapeType="Polygon",this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext(),c=this.getPoints(),d=c.length;b.beginPath(),b.moveTo(c[0].x,c[0].y);for(var e=1;d>e;e++)b.lineTo(c[e].x,c[e].y);b.closePath(),a.fillStroke(this)},setPoints:function(a){this.setAttr("points",Kinetic.Type._getPoints(a))}},Kinetic.Global.extend(Kinetic.Polygon,Kinetic.Shape),Kinetic.Node.addGetters(Kinetic.Polygon,["points"])}(),function(){function a(a){a.fillText(this.partialText,0,0)}function b(a){a.strokeText(this.partialText,0,0)}var c="auto",d="Calibri",e="canvas",f="center",g="Change.kinetic",h="2d",i="\n",j="",k="left",l="\n",m="text",o="Text",p="top",q="middle",r="normal",s="px ",t=" ",u="right",v=["fontFamily","fontSize","fontStyle","padding","align","lineHeight","text","width","height"],w=v.length;Kinetic.Text=function(a){this._initText(a)},Kinetic.Text.prototype={_initText:function(f){var h=this;this.setDefaultAttrs({fontFamily:d,text:j,fontSize:12,align:k,verticalAlign:p,fontStyle:r,padding:0,width:c,height:c,lineHeight:1}),this.dummyCanvas=document.createElement(e),Kinetic.Shape.call(this,f),this._fillFunc=a,this._strokeFunc=b,this.shapeType=o,this._setDrawFuncs();for(var i=0;w>i;i++)this.on(v[i]+g,h._setTextData);this._setTextData()},drawFunc:function(a){var b=a.getContext(),c=this.getPadding(),d=this.getFontStyle(),e=this.getFontSize(),g=this.getFontFamily(),h=this.getTextHeight(),i=this.getLineHeight()*h,j=this.textArr,l=j.length,m=this.getWidth();b.font=d+t+e+s+g,b.textBaseline=q,b.textAlign=k,b.save(),b.translate(c,0),b.translate(0,c+h/2);for(var n=0;l>n;n++){var o=j[n],p=o.text,r=o.width;b.save(),this.getAlign()===u?b.translate(m-r-2*c,0):this.getAlign()===f&&b.translate((m-r-2*c)/2,0),this.partialText=p,a.fillStroke(this),b.restore(),b.translate(0,i)}b.restore()},drawHitFunc:function(a){var b=a.getContext(),c=this.getWidth(),d=this.getHeight();b.beginPath(),b.rect(0,0,c,d),b.closePath(),a.fillStroke(this)},setText:function(a){var b=Kinetic.Type._isString(a)?a:a.toString();this.setAttr(m,b)},getWidth:function(){return this.attrs.width===c?this.getTextWidth()+2*this.getPadding():this.attrs.width},getHeight:function(){return this.attrs.height===c?this.getTextHeight()*this.textArr.length*this.attrs.lineHeight+2*this.attrs.padding:this.attrs.height},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},_getTextSize:function(a){var b,c=this.dummyCanvas,d=c.getContext(h),e=this.getFontSize();return d.save(),d.font=this.getFontStyle()+t+e+s+this.getFontFamily(),b=d.measureText(a),d.restore(),{width:b.width,height:parseInt(e,10)}},_expandTextData:function(a){var b=a.length;for(n=0,text=j,newArr=[],n=0;n<b;n++)text=a[n],newArr.push({text:text,width:this._getTextSize(text).width});return newArr},_setTextData:function(){var a=this.getText().split(j),b=[],d=0;for(addLine=!0,lineHeightPx=0,padding=this.getPadding(),this.textWidth=0,this.textHeight=this._getTextSize(this.getText()).height,lineHeightPx=this.getLineHeight()*this.textHeight;a.length>0&&addLine&&(this.attrs.height===c||lineHeightPx*(d+1)<this.attrs.height-2*padding);){var e=0,f=void 0;for(addLine=!1;e<a.length;){if(a.indexOf(l)===e){a.splice(e,1),f=a.splice(0,e).join(j);break}var g=a.slice(0,e);if(this.attrs.width!==c&&this._getTextSize(g.join(j)).width>this.attrs.width-2*padding){if(0==e)break;var h=g.lastIndexOf(t),k=g.lastIndexOf(i),m=Math.max(h,k);if(m>=0){f=a.splice(0,1+m).join(j);break}f=a.splice(0,e).join(j);break}e++,e===a.length&&(f=a.splice(0,e).join(j))}this.textWidth=Math.max(this.textWidth,this._getTextSize(f).width),void 0!==f&&(b.push(f),addLine=!0),d++}this.textArr=this._expandTextData(b)}},Kinetic.Global.extend(Kinetic.Text,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.Text,["fontFamily","fontSize","fontStyle","padding","align","lineHeight"]),Kinetic.Node.addGetters(Kinetic.Text,[m])}(),function(){Kinetic.Line=function(a){this._initLine(a)},Kinetic.Line.prototype={_initLine:function(a){this.setDefaultAttrs({points:[],lineCap:"butt"}),Kinetic.Shape.call(this,a),this.shapeType="Line",this._setDrawFuncs()},drawFunc:function(a){var b=this.getPoints(),c=b.length,d=a.getContext();d.beginPath(),d.moveTo(b[0].x,b[0].y);for(var e=1;c>e;e++){var f=b[e];d.lineTo(f.x,f.y)}a.stroke(this)},setPoints:function(a){this.setAttr("points",Kinetic.Type._getPoints(a))}},Kinetic.Global.extend(Kinetic.Line,Kinetic.Shape),Kinetic.Node.addGetters(Kinetic.Line,["points"])}(),function(){Kinetic.Spline=function(a){this._initSpline(a)},Kinetic.Spline._getControlPoints=function(a,b,c,d){var e=a.x,f=a.y,g=b.x,h=b.y,i=c.x,j=c.y,k=Math.sqrt(Math.pow(g-e,2)+Math.pow(h-f,2)),l=Math.sqrt(Math.pow(i-g,2)+Math.pow(j-h,2)),m=d*k/(k+l),n=d*l/(k+l),o=g-m*(i-e),p=h-m*(j-f),q=g+n*(i-e),r=h+n*(j-f);return[{x:o,y:p},{x:q,y:r}]},Kinetic.Spline.prototype={_initSpline:function(a){this.setDefaultAttrs({tension:1}),Kinetic.Line.call(this,a),this.shapeType="Spline"},drawFunc:function(a){var b=this.getPoints(),c=b.length,d=a.getContext(),e=this.getTension();if(d.beginPath(),d.moveTo(b[0].x,b[0].y),0!==e&&c>2){var f=this.allPoints,g=f.length;d.quadraticCurveTo(f[0].x,f[0].y,f[1].x,f[1].y);for(var h=2;g-1>h;)d.bezierCurveTo(f[h].x,f[h++].y,f[h].x,f[h++].y,f[h].x,f[h++].y);d.quadraticCurveTo(f[g-1].x,f[g-1].y,b[c-1].x,b[c-1].y)}else for(var h=1;c>h;h++){var i=b[h];d.lineTo(i.x,i.y)}a.stroke(this)},setPoints:function(a){Kinetic.Line.prototype.setPoints.call(this,a),this._setAllPoints()},setTension:function(a){this.setAttr("tension",a),this._setAllPoints()},_setAllPoints:function(){for(var a=this.getPoints(),b=a.length,c=this.getTension(),d=[],e=1;b-1>e;e++){var f=Kinetic.Spline._getControlPoints(a[e-1],a[e],a[e+1],c);d.push(f[0]),d.push(a[e]),d.push(f[1])}this.allPoints=d}},Kinetic.Global.extend(Kinetic.Spline,Kinetic.Line),Kinetic.Node.addGetters(Kinetic.Spline,["tension"])}(),function(){Kinetic.Blob=function(a){this._initBlob(a)},Kinetic.Blob.prototype={_initBlob:function(a){Kinetic.Spline.call(this,a),this.shapeType="Blob"},drawFunc:function(a){var b=this.getPoints(),c=b.length,d=a.getContext(),e=this.getTension();if(d.beginPath(),d.moveTo(b[0].x,b[0].y),0!==e&&c>2)for(var f=this.allPoints,g=f.length,h=0;g-1>h;)d.bezierCurveTo(f[h].x,f[h++].y,f[h].x,f[h++].y,f[h].x,f[h++].y);else for(var h=1;c>h;h++){var i=b[h];d.lineTo(i.x,i.y)}d.closePath(),a.fillStroke(this)},_setAllPoints:function(){var a=this.getPoints(),b=a.length,c=this.getTension(),d=Kinetic.Spline._getControlPoints(a[b-1],a[0],a[1],c),e=Kinetic.Spline._getControlPoints(a[b-2],a[b-1],a[0],c);Kinetic.Spline.prototype._setAllPoints.call(this),this.allPoints.unshift(d[1]),this.allPoints.push(e[0]),this.allPoints.push(a[b-1]),this.allPoints.push(e[1]),this.allPoints.push(d[0]),this.allPoints.push(a[0])}},Kinetic.Global.extend(Kinetic.Blob,Kinetic.Spline)}(),function(){Kinetic.Sprite=function(a){this._initSprite(a)},Kinetic.Sprite.prototype={_initSprite:function(a){this.setDefaultAttrs({index:0,frameRate:17}),Kinetic.Shape.call(this,a),this.shapeType="Sprite",this._setDrawFuncs(),this.anim=new Kinetic.Animation;var b=this;this.on("animationChange",function(){b.setIndex(0)})},drawFunc:function(a){var b=this.attrs.animation,c=this.attrs.index,d=this.attrs.animations[b][c],e=a.getContext(),f=this.attrs.image;f&&e.drawImage(f,d.x,d.y,d.width,d.height,0,0,d.width,d.height)},drawHitFunc:function(a){var b=this.attrs.animation,c=this.attrs.index,d=this.attrs.animations[b][c],e=a.getContext();e.beginPath(),e.rect(0,0,d.width,d.height),e.closePath(),a.fill(this)},start:function(){var a=this,b=this.getLayer();this.anim.node=b,this.interval=setInterval(function(){var b=a.attrs.index;a._updateIndex(),a.afterFrameFunc&&b===a.afterFrameIndex&&(a.afterFrameFunc(),delete a.afterFrameFunc,delete a.afterFrameIndex)},1e3/this.attrs.frameRate),this.anim.start()},stop:function(){this.anim.stop(),clearInterval(this.interval)},afterFrame:function(a,b){this.afterFrameIndex=a,this.afterFrameFunc=b},_updateIndex:function(){var a=this.attrs.index,b=this.attrs.animation;a<this.attrs.animations[b].length-1?this.attrs.index++:this.attrs.index=0}},Kinetic.Global.extend(Kinetic.Sprite,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.Sprite,["animation","animations","index"])}(),function(){Kinetic.Star=function(a){this._initStar(a)},Kinetic.Star.prototype={_initStar:function(a){this.setDefaultAttrs({numPoints:0,innerRadius:0,outerRadius:0}),Kinetic.Shape.call(this,a),this.shapeType="Star",this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext(),c=this.attrs.innerRadius,d=this.attrs.outerRadius,e=this.attrs.numPoints;b.beginPath(),b.moveTo(0,0-this.attrs.outerRadius);for(var f=1;2*e>f;f++){var g=f%2===0?d:c,h=g*Math.sin(f*Math.PI/e),i=-1*g*Math.cos(f*Math.PI/e);b.lineTo(h,i)}b.closePath(),a.fillStroke(this)}},Kinetic.Global.extend(Kinetic.Star,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.Star,["numPoints","innerRadius","outerRadius"])}(),function(){Kinetic.RegularPolygon=function(a){this._initRegularPolygon(a)},Kinetic.RegularPolygon.prototype={_initRegularPolygon:function(a){this.setDefaultAttrs({radius:0,sides:0}),Kinetic.Shape.call(this,a),this.shapeType="RegularPolygon",this._setDrawFuncs()},drawFunc:function(a){var b=a.getContext(),c=this.attrs.sides,d=this.attrs.radius;b.beginPath(),b.moveTo(0,0-d);for(var e=1;c>e;e++){var f=d*Math.sin(2*e*Math.PI/c),g=-1*d*Math.cos(2*e*Math.PI/c);b.lineTo(f,g)}b.closePath(),a.fillStroke(this)}},Kinetic.Global.extend(Kinetic.RegularPolygon,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.RegularPolygon,["radius","sides"])}(),function(){Kinetic.Path=function(a){this._initPath(a)},Kinetic.Path.prototype={_initPath:function(a){this.dataArray=[];var b=this;Kinetic.Shape.call(this,a),this.shapeType="Path",this._setDrawFuncs(),this.dataArray=Kinetic.Path.parsePathData(this.attrs.data),this.on("dataChange",function(){b.dataArray=Kinetic.Path.parsePathData(b.attrs.data)})},drawFunc:function(a){var b=this.dataArray,c=a.getContext();c.beginPath();for(var d=0;d<b.length;d++){var e=b[d].command,f=b[d].points;switch(e){case"L":c.lineTo(f[0],f[1]);break;case"M":c.moveTo(f[0],f[1]);break;case"C":c.bezierCurveTo(f[0],f[1],f[2],f[3],f[4],f[5]);break;case"Q":c.quadraticCurveTo(f[0],f[1],f[2],f[3]);break;case"A":var g=f[0],h=f[1],i=f[2],j=f[3],k=f[4],l=f[5],m=f[6],n=f[7],o=i>j?i:j,p=i>j?1:i/j,q=i>j?j/i:1;c.translate(g,h),c.rotate(m),c.scale(p,q),c.arc(0,0,o,k,k+l,1-n),c.scale(1/p,1/q),c.rotate(-m),c.translate(-g,-h);break;case"z":c.closePath()}}a.fillStroke(this)}},Kinetic.Global.extend(Kinetic.Path,Kinetic.Shape),Kinetic.Path.getLineLength=function(a,b,c,d){return Math.sqrt((c-a)*(c-a)+(d-b)*(d-b))},Kinetic.Path.getPointOnLine=function(a,b,c,d,e,f,g){void 0===f&&(f=b),void 0===g&&(g=c);var h=(e-c)/(d-b+1e-8),i=Math.sqrt(a*a/(1+h*h));
b>d&&(i*=-1);var j,k=h*i;if((g-c)/(f-b+1e-8)===h)j={x:f+i,y:g+k};else{var l,m,n=this.getLineLength(b,c,d,e);if(1e-8>n)return void 0;var o=(f-b)*(d-b)+(g-c)*(e-c);o/=n*n,l=b+o*(d-b),m=c+o*(e-c);var p=this.getLineLength(f,g,l,m),q=Math.sqrt(a*a-p*p);i=Math.sqrt(q*q/(1+h*h)),b>d&&(i*=-1),k=h*i,j={x:l+i,y:m+k}}return j},Kinetic.Path.getPointOnCubicBezier=function(a,b,c,d,e,f,g,h,i){function j(a){return a*a*a}function k(a){return 3*a*a*(1-a)}function l(a){return 3*a*(1-a)*(1-a)}function m(a){return(1-a)*(1-a)*(1-a)}var n=h*j(a)+f*k(a)+d*l(a)+b*m(a),o=i*j(a)+g*k(a)+e*l(a)+c*m(a);return{x:n,y:o}},Kinetic.Path.getPointOnQuadraticBezier=function(a,b,c,d,e,f,g){function h(a){return a*a}function i(a){return 2*a*(1-a)}function j(a){return(1-a)*(1-a)}var k=f*h(a)+d*i(a)+b*j(a),l=g*h(a)+e*i(a)+c*j(a);return{x:k,y:l}},Kinetic.Path.getPointOnEllipticalArc=function(a,b,c,d,e,f){var g=Math.cos(f),h=Math.sin(f),i={x:c*Math.cos(e),y:d*Math.sin(e)};return{x:a+(i.x*g-i.y*h),y:b+(i.x*h+i.y*g)}},Kinetic.Path.parsePathData=function(a){if(!a)return[];var b=a,c=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];b=b.replace(new RegExp(" ","g"),",");for(var d=0;d<c.length;d++)b=b.replace(new RegExp(c[d],"g"),"|"+c[d]);for(var e=b.split("|"),f=[],g=0,h=0,d=1;d<e.length;d++){var i=e[d],j=i.charAt(0);i=i.slice(1),i=i.replace(new RegExp(",-","g"),"-"),i=i.replace(new RegExp("-","g"),",-"),i=i.replace(new RegExp("e,-","g"),"e-");var k=i.split(",");k.length>0&&""===k[0]&&k.shift();for(var l=0;l<k.length;l++)k[l]=parseFloat(k[l]);for(;k.length>0&&!isNaN(k[0]);){var m=null,n=[],o=g,p=h;switch(j){case"l":g+=k.shift(),h+=k.shift(),m="L",n.push(g,h);break;case"L":g=k.shift(),h=k.shift(),n.push(g,h);break;case"m":g+=k.shift(),h+=k.shift(),m="M",n.push(g,h),j="l";break;case"M":g=k.shift(),h=k.shift(),m="M",n.push(g,h),j="L";break;case"h":g+=k.shift(),m="L",n.push(g,h);break;case"H":g=k.shift(),m="L",n.push(g,h);break;case"v":h+=k.shift(),m="L",n.push(g,h);break;case"V":h=k.shift(),m="L",n.push(g,h);break;case"C":n.push(k.shift(),k.shift(),k.shift(),k.shift()),g=k.shift(),h=k.shift(),n.push(g,h);break;case"c":n.push(g+k.shift(),h+k.shift(),g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),m="C",n.push(g,h);break;case"S":var q=g,r=h,s=f[f.length-1];"C"===s.command&&(q=g+(g-s.points[2]),r=h+(h-s.points[3])),n.push(q,r,k.shift(),k.shift()),g=k.shift(),h=k.shift(),m="C",n.push(g,h);break;case"s":var q=g,r=h,s=f[f.length-1];"C"===s.command&&(q=g+(g-s.points[2]),r=h+(h-s.points[3])),n.push(q,r,g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),m="C",n.push(g,h);break;case"Q":n.push(k.shift(),k.shift()),g=k.shift(),h=k.shift(),n.push(g,h);break;case"q":n.push(g+k.shift(),h+k.shift()),g+=k.shift(),h+=k.shift(),m="Q",n.push(g,h);break;case"T":var q=g,r=h,s=f[f.length-1];"Q"===s.command&&(q=g+(g-s.points[0]),r=h+(h-s.points[1])),g=k.shift(),h=k.shift(),m="Q",n.push(q,r,g,h);break;case"t":var q=g,r=h,s=f[f.length-1];"Q"===s.command&&(q=g+(g-s.points[0]),r=h+(h-s.points[1])),g+=k.shift(),h+=k.shift(),m="Q",n.push(q,r,g,h);break;case"A":var t=k.shift(),u=k.shift(),v=k.shift(),w=k.shift(),x=k.shift(),y=g,z=h;g=k.shift(),h=k.shift(),m="A",n=this.convertEndpointToCenterParameterization(y,z,g,h,w,x,t,u,v);break;case"a":var t=k.shift(),u=k.shift(),v=k.shift(),w=k.shift(),x=k.shift(),y=g,z=h;g+=k.shift(),h+=k.shift(),m="A",n=this.convertEndpointToCenterParameterization(y,z,g,h,w,x,t,u,v)}f.push({command:m||j,points:n,start:{x:o,y:p},pathLength:this.calcLength(o,p,m||j,n)})}("z"===j||"Z"===j)&&f.push({command:"z",points:[],start:void 0,pathLength:0})}return f},Kinetic.Path.calcLength=function(a,b,c,d){var e,f,g,h=Kinetic.Path;switch(c){case"L":return h.getLineLength(a,b,d[0],d[1]);case"C":for(e=0,f=h.getPointOnCubicBezier(0,a,b,d[0],d[1],d[2],d[3],d[4],d[5]),t=.01;t<=1;t+=.01)g=h.getPointOnCubicBezier(t,a,b,d[0],d[1],d[2],d[3],d[4],d[5]),e+=h.getLineLength(f.x,f.y,g.x,g.y),f=g;return e;case"Q":for(e=0,f=h.getPointOnQuadraticBezier(0,a,b,d[0],d[1],d[2],d[3]),t=.01;t<=1;t+=.01)g=h.getPointOnQuadraticBezier(t,a,b,d[0],d[1],d[2],d[3]),e+=h.getLineLength(f.x,f.y,g.x,g.y),f=g;return e;case"A":e=0;var i=d[4],j=d[5],k=d[4]+j,l=Math.PI/180;if(Math.abs(i-k)<l&&(l=Math.abs(i-k)),f=h.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],i,0),0>j)for(t=i-l;t>k;t-=l)g=h.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],t,0),e+=h.getLineLength(f.x,f.y,g.x,g.y),f=g;else for(t=i+l;t<k;t+=l)g=h.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],t,0),e+=h.getLineLength(f.x,f.y,g.x,g.y),f=g;return g=h.getPointOnEllipticalArc(d[0],d[1],d[2],d[3],k,0),e+=h.getLineLength(f.x,f.y,g.x,g.y)}return 0},Kinetic.Path.convertEndpointToCenterParameterization=function(a,b,c,d,e,f,g,h,i){var j=i*(Math.PI/180),k=Math.cos(j)*(a-c)/2+Math.sin(j)*(b-d)/2,l=-1*Math.sin(j)*(a-c)/2+Math.cos(j)*(b-d)/2,m=k*k/(g*g)+l*l/(h*h);m>1&&(g*=Math.sqrt(m),h*=Math.sqrt(m));var n=Math.sqrt((g*g*h*h-g*g*l*l-h*h*k*k)/(g*g*l*l+h*h*k*k));e==f&&(n*=-1),isNaN(n)&&(n=0);var o=n*g*l/h,p=n*-h*k/g,q=(a+c)/2+Math.cos(j)*o-Math.sin(j)*p,r=(b+d)/2+Math.sin(j)*o+Math.cos(j)*p,s=function(a){return Math.sqrt(a[0]*a[0]+a[1]*a[1])},t=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(s(a)*s(b))},u=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(t(a,b))},v=u([1,0],[(k-o)/g,(l-p)/h]),w=[(k-o)/g,(l-p)/h],x=[(-1*k-o)/g,(-1*l-p)/h],y=u(w,x);return t(w,x)<=-1&&(y=Math.PI),t(w,x)>=1&&(y=0),0===f&&y>0&&(y-=2*Math.PI),1==f&&0>y&&(y+=2*Math.PI),[q,r,g,h,v,y,j,f]},Kinetic.Node.addGettersSetters(Kinetic.Path,["data"])}(),function(){function a(a){a.fillText(this.partialText,0,0)}function b(a){a.strokeText(this.partialText,0,0)}Kinetic.TextPath=function(a){this._initTextPath(a)},Kinetic.TextPath.prototype={_initTextPath:function(c){this.setDefaultAttrs({fontFamily:"Calibri",fontSize:12,fontStyle:"normal",text:""}),this.dummyCanvas=document.createElement("canvas"),this.dataArray=[];var d=this;Kinetic.Shape.call(this,c),this._fillFunc=a,this._strokeFunc=b,this.shapeType="TextPath",this._setDrawFuncs(),this.dataArray=Kinetic.Path.parsePathData(this.attrs.data),this.on("dataChange",function(){d.dataArray=Kinetic.Path.parsePathData(this.attrs.data)});for(var e=["text","textStroke","textStrokeWidth"],f=0;f<e.length;f++){var g=e[f];this.on(g+"Change",d._setTextData)}d._setTextData()},drawFunc:function(a){var b=(this.charArr,a.getContext());b.font=this.attrs.fontStyle+" "+this.attrs.fontSize+"pt "+this.attrs.fontFamily,b.textBaseline="middle",b.textAlign="left",b.save();for(var c=this.glyphInfo,d=0;d<c.length;d++){b.save();var e=c[d].p0;c[d].p1,parseFloat(this.attrs.fontSize);b.translate(e.x,e.y),b.rotate(c[d].rotation),this.partialText=c[d].text,a.fillStroke(this),b.restore()}b.restore()},getTextWidth:function(){return this.textWidth},getTextHeight:function(){return this.textHeight},setText:function(a){Kinetic.Text.prototype.setText.call(this,a)},_getTextSize:function(a){var b=this.dummyCanvas,c=b.getContext("2d");c.save(),c.font=this.attrs.fontStyle+" "+this.attrs.fontSize+"pt "+this.attrs.fontFamily;var d=c.measureText(a);return c.restore(),{width:d.width,height:parseInt(this.attrs.fontSize,10)}},_setTextData:function(){var a=this,b=this._getTextSize(this.attrs.text);this.textWidth=b.width,this.textHeight=b.height,this.glyphInfo=[];for(var c,d,e,f=this.attrs.text.split(""),g=-1,h=0,i=function(){h=0;for(var b=a.dataArray,d=g+1;d<b.length;d++){if(b[d].pathLength>0)return g=d,b[d];"M"==b[d].command&&(c={x:b[d].points[0],y:b[d].points[1]})}return{}},j=function(b,f){var g=a._getTextSize(b).width,j=0,k=0;for(d=void 0;Math.abs(g-j)/g>.01&&25>k;){k++;for(var l=j;void 0===e;)e=i(),e&&l+e.pathLength<g&&(l+=e.pathLength,e=void 0);if(e==={}||void 0===c)return void 0;var m=!1;switch(e.command){case"L":Kinetic.Path.getLineLength(c.x,c.y,e.points[0],e.points[1])>g?d=Kinetic.Path.getPointOnLine(g,c.x,c.y,e.points[0],e.points[1],c.x,c.y):e=void 0;break;case"A":var n=e.points[4],o=e.points[5],p=e.points[4]+o;0===h?h=n+1e-8:g>j?h+=Math.PI/180*o/Math.abs(o):h-=Math.PI/360*o/Math.abs(o),Math.abs(h)>Math.abs(p)&&(h=p,m=!0),d=Kinetic.Path.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],h,e.points[6]);break;case"C":0===h?h=g>e.pathLength?1e-8:g/e.pathLength:g>j?h+=(g-j)/e.pathLength:h-=(j-g)/e.pathLength,h>1&&(h=1,m=!0),d=Kinetic.Path.getPointOnCubicBezier(h,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);break;case"Q":0===h?h=g/e.pathLength:g>j?h+=(g-j)/e.pathLength:h-=(j-g)/e.pathLength,h>1&&(h=1,m=!0),d=Kinetic.Path.getPointOnQuadraticBezier(h,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3])}void 0!==d&&(j=Kinetic.Path.getLineLength(c.x,c.y,d.x,d.y)),m&&(m=!1,e=void 0)}},k=0;k<f.length&&(j(f[k]),void 0!==c&&void 0!==d);k++){var l=Kinetic.Path.getLineLength(c.x,c.y,d.x,d.y),m=0,n=Kinetic.Path.getPointOnLine(m+l/2,c.x,c.y,d.x,d.y),o=Math.atan2(d.y-c.y,d.x-c.x);this.glyphInfo.push({transposeX:n.x,transposeY:n.y,text:f[k],rotation:o,p0:c,p1:d}),c=d}}},Kinetic.Global.extend(Kinetic.TextPath,Kinetic.Shape),Kinetic.Node.addGettersSetters(Kinetic.TextPath,["fontFamily","fontSize","fontStyle"]),Kinetic.Node.addGetters(Kinetic.TextPath,["text"])}();var svw=svw||{},svw=svw||{};svw.canvasWidth=720,svw.canvasHeight=480,svw.svImageHeight=6656,svw.svImageWidth=13312,svw.alpha_x=4.6,svw.alpha_y=-4.65,svw._labelCounter=0,svw.getLabelCounter=function(){return svw._labelCounter++};var svw=svw||{};svw.formatRecordsToGoldenLabels=function(a){var b,c,d,e,f,g={},h=a.length;for(b=0;h>b;b++)if(d="LabelGSVPanoramaId"in a[b]?a[b].LabelGSVPanoramaId:"GSVPanoramaId"in a[b]?a[b].GSVPanoramaId:void 0,e="Lat"in a[b]?a[b].Lat:"labelLat"in a[b]?a[b].labelLat:void 0,f="Lng"in a[b]?a[b].Lng:"labelLng"in a[b]?a[b].labelLng:void 0,"1"!=a[b].Deleted){c=a[b].LabelId,c in g||(g[c]=[]);var i={AmazonTurkerId:a[b].AmazonTurkerId,LabelId:a[b].LabelId,LabelGSVPanoramaId:d,LabelType:a[b].LabelType,LabelPointId:a[b].LabelPointId,svImageX:a[b].svImageX,svImageY:a[b].svImageY,originalCanvasCoordinate:{x:a[b].originalCanvasX,y:a[b].originalCanvasY},originalHeading:a[b].originalHeading,originalPitch:a[b].originalPitch,originalZoom:a[b].originalZoom,heading:a[b].heading,pitch:a[b].pitch,zoom:a[b].zoom,Lat:e,Lng:f};"PhotographerHeading"in a[b]&&"PhotographerPitch"in a[b]&&(i.PhotographerHeading=parseFloat(a[b].PhotographerHeading),i.PhotographerPitch=parseFloat(a[b].PhotographerPitch)),g[c].push(i)}var j=[];for(c in g)j.push(g[c]);return j},svw.formatRecordsToLabels=svw.formatRecordsToGoldenLabels;var svw=svw||{},svw=svw||{},svw=svw||{},svw=svw||{},panorama;svw.panorama=panorama,svw.getPanoId=getPanoId,svw.getPosition=getPosition,svw.getPOV=getPOV,svw.getLinks=getLinks;var fogMode=!0,fogSet=!1,current,first,previousPoints=[],radius=.1,isNotfirst=0,paths;svw.fog=void 0;var au=[],pty=[],polys=[],svw=svw||{},svw=svw||{};svw.gsvImageCoordinate2CanvasCoordinate=function(a,b,c){var d,e,f=c.zoom,g=svw.svImageWidth*svw.zoomFactor[f],h=svw.svImageHeight*svw.zoomFactor[f];a*=svw.zoomFactor[f],b*=svw.zoomFactor[f],d=a-g*c.heading/360,d=d/svw.alpha_x+svw.canvasWidth/2;var i=360*svw.alpha_x*(svw.canvasWidth/2)/g+10;return c.heading<i?g-svw.alpha_x*(svw.canvasWidth/2)<a&&(d=a-g-g*c.heading/360,d=d/svw.alpha_x+svw.canvasWidth/2):c.heading>360-i&&svw.alpha_x*(svw.canvasWidth/2)>a&&(d=a+g-g*c.heading/360,d=d/svw.alpha_x+svw.canvasWidth/2),e=b-h/2*(c.pitch/90),e=e/svw.alpha_y+svw.canvasHeight/2,{x:d,y:e}},svw.zoomFactor={1:1,2:2.1,3:4,4:8,5:16};var svw=svw||{},svw=svw||{},svw=svw||{},svw=svw||{},svw=svw||{},svw=svw||{};